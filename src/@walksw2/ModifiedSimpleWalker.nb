(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    423901,      14158]
NotebookOptionsPosition[    400012,      13376]
NotebookOutlinePosition[    400446,      13393]
CellTagsIndexPosition[    400403,      13390]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", "\"\<C:/Projects/SimpWalker/\>\"", "]"}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<DynamicsWorkbench`\>\"", "]"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell["Art's Simple Walker with Hip Spring", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NewModel", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"a", ",", "ground", ",", "Hinge", ",", 
    RowBox[{"BodyToJnt", "->", 
     RowBox[{"-", 
      RowBox[{"a", "[", "1", "]"}]}]}], ",", 
    RowBox[{"QOffset", "->", 
     RowBox[{
      RowBox[{"-", "Pi"}], "/", "2"}]}], ",", 
    RowBox[{"InbToJnt", "->", "0"}], ",", 
    RowBox[{"Inertia", "->", "0"}], ",", 
    RowBox[{"Mass", "->", "M"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"b", ",", " ", "a", ",", " ", "Hinge", ",", 
    RowBox[{"Axis", "->", 
     RowBox[{"-", 
      RowBox[{"ground", "[", "3", "]"}]}]}], ",", 
    RowBox[{"QOffset", "->", " ", 
     RowBox[{"-", "Pi"}]}], ",", 
    RowBox[{"BodyToJnt", "->", 
     RowBox[{"b", "[", "1", "]"}]}], ",", 
    RowBox[{"InbToJnt", "->", "0"}], ",", 
    RowBox[{"Inertia", "->", "0"}], ",", 
    RowBox[{"Mass", "->", "m"}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"a", ",", 
    RowBox[{"M", " ", "grav"}], ",", "0"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"b", ",", 
    RowBox[{"m", " ", "grav"}], ",", "0"}], "]"}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"a", ",", 
    RowBox[{
     RowBox[{"-", "K"}], " ", 
     RowBox[{"q", "[", "2", "]"}], " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"b", ",", 
    RowBox[{"K", " ", 
     RowBox[{"q", "[", "2", "]"}], " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"grav", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
     RowBox[{"ground", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Gamma]", "]"}], 
     RowBox[{"ground", "[", "1", "]"}]}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eom", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"EOM", "[", "]"}], " ", "/.", 
    RowBox[{"m", "->", 
     RowBox[{"\[Beta]", " ", "M"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "==", 
    RowBox[{"M", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Gamma]", "-", 
         SubscriptBox["q", "1"]}], "]"}], "+", 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          SubscriptBox["q", "1"]}], "]"}]}], "-", 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}]}], "+", 
       RowBox[{"2", " ", "\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubscriptBox["u", "1"], " ", 
        SubscriptBox["u", "2"]}], "-", 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubsuperscriptBox["u", "2", "2"]}], "+", 
       SubsuperscriptBox["u", "1", "\[Prime]",
        MultilineFunction->None], "+", 
       RowBox[{"2", " ", "\[Beta]", " ", 
        SubsuperscriptBox["u", "1", "\[Prime]",
         MultilineFunction->None]}], "-", 
       RowBox[{"2", " ", "\[Beta]", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubsuperscriptBox["u", "1", "\[Prime]",
         MultilineFunction->None]}], "-", 
       RowBox[{"\[Beta]", " ", 
        SubsuperscriptBox["u", "2", "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubsuperscriptBox["u", "2", "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}]}], ",", 
   RowBox[{"0", "==", 
    RowBox[{
     RowBox[{"K", " ", 
      SubscriptBox["q", "2"]}], "+", 
     RowBox[{"M", " ", "\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", 
          SubscriptBox["q", "2"], "]"}], " ", 
         SubsuperscriptBox["u", "1", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "2"], "]"}]}], ")"}], " ", 
         SubsuperscriptBox["u", "1", "\[Prime]",
          MultilineFunction->None]}], "+", 
        SubsuperscriptBox["u", "2", "\[Prime]",
         MultilineFunction->None]}], ")"}]}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eom2", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"#", "/", "M"}], ",", " ", "Equal"}], "]"}], "&"}], ",", 
    "eom"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "==", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "1"]}], "]"}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Gamma]", "-", 
        SubscriptBox["q", "1"]}], "]"}]}], "-", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Gamma]", "-", 
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}], "]"}]}], "+", 
     RowBox[{"2", " ", "\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "2"], "]"}], " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "2"]}], "-", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "2"], "]"}], " ", 
      SubsuperscriptBox["u", "2", "2"]}], "+", 
     SubsuperscriptBox["u", "1", "\[Prime]",
      MultilineFunction->None], "+", 
     RowBox[{"2", " ", "\[Beta]", " ", 
      SubsuperscriptBox["u", "1", "\[Prime]",
       MultilineFunction->None]}], "-", 
     RowBox[{"2", " ", "\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "2"], "]"}], " ", 
      SubsuperscriptBox["u", "1", "\[Prime]",
       MultilineFunction->None]}], "-", 
     RowBox[{"\[Beta]", " ", 
      SubsuperscriptBox["u", "2", "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "2"], "]"}], " ", 
      SubsuperscriptBox["u", "2", "\[Prime]",
       MultilineFunction->None]}]}]}], ",", 
   RowBox[{"0", "==", 
    FractionBox[
     RowBox[{
      RowBox[{"K", " ", 
       SubscriptBox["q", "2"]}], "+", 
      RowBox[{"M", " ", "\[Beta]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Gamma]", "-", 
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}], "]"}], "-", 
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["q", "2"], "]"}], " ", 
          SubsuperscriptBox["u", "1", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SubscriptBox["q", "2"], "]"}]}], ")"}], " ", 
          SubsuperscriptBox["u", "1", "\[Prime]",
           MultilineFunction->None]}], "+", 
         SubsuperscriptBox["u", "2", "\[Prime]",
          MultilineFunction->None]}], ")"}]}]}], "M"]}]}], "}"}]], "Output"]
}, Open  ]],

Cell["First line of Andy's equations of motion", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eom2", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"\[Beta]", "->", "0"}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Gamma]", "-", 
      SubscriptBox["q", "1"]}], "]"}]}], "-", 
   SubsuperscriptBox["u", "1", "\[Prime]",
    MultilineFunction->None]}], "==", "0"}]], "Output"]
}, Open  ]],

Cell["Second line", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"eom2", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/", "\[Beta]"}], ",", "Equal"}], "]"}],
   " ", "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Gamma]", "-", 
      SubscriptBox["q", "1"], "+", 
      SubscriptBox["q", "2"]}], "]"}]}], "-", 
   FractionBox[
    RowBox[{"K", " ", 
     SubscriptBox["q", "2"]}], 
    RowBox[{"M", " ", "\[Beta]"}]], "+", 
   RowBox[{
    RowBox[{"Sin", "[", 
     SubscriptBox["q", "2"], "]"}], " ", 
    SubsuperscriptBox["u", "1", "2"]}], "+", 
   SubsuperscriptBox["u", "1", "\[Prime]",
    MultilineFunction->None], "-", 
   RowBox[{
    RowBox[{"Cos", "[", 
     SubscriptBox["q", "2"], "]"}], " ", 
    SubsuperscriptBox["u", "1", "\[Prime]",
     MultilineFunction->None]}], "-", 
   SubsuperscriptBox["u", "2", "\[Prime]",
    MultilineFunction->None]}], "==", "0"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Gamma]", "-", 
       RowBox[{"q", "[", "1", "]"}], "+", 
       RowBox[{"q", "[", "2", "]"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"q", "[", "2", "]"}], "]"}], 
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], "'"}]}]}], "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "1", "]"}], "'"}], "->", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], "-", "\[Gamma]"}], "]"}]}]}], " ", 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Gamma]", "-", 
     SubscriptBox["q", "1"]}], "]"}]}], " ", 
  RowBox[{"Sin", "[", 
   SubscriptBox["q", "2"], "]"}]}]], "Output"]
}, Open  ]],

Cell["Now add an impulse", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linmom", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Mass", "[", "a", "]"}], 
     RowBox[{"VelCOM", "[", "a", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Mass", "[", "b", "]"}], 
     RowBox[{"VelCOM", "[", "b", "]"}]}]}], " ", "/.", 
   RowBox[{"{", 
    RowBox[{"m", "->", 
     RowBox[{"\[Beta]", " ", "M"}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"M", " ", 
       SubscriptBox["u", "1"]}], "+", 
      RowBox[{"M", " ", "\[Beta]", " ", 
       SubscriptBox["u", "1"]}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M", " ", "\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["u", "1"], "-", 
        SubscriptBox["u", "2"]}], ")"}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["b", "_"], "2"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linmomafter", " ", "=", " ", 
  RowBox[{"linmom", " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], "->", 
      RowBox[{"ua", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"u", "[", "2", "]"}], "->", 
      RowBox[{"ua", "[", "2", "]"}]}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"M", " ", 
       RowBox[{"ua", "[", "1", "]"}]}], "+", 
      RowBox[{"M", " ", "\[Beta]", " ", 
       RowBox[{"ua", "[", "1", "]"}]}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M", " ", "\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ua", "[", "1", "]"}], "-", 
        RowBox[{"ua", "[", "2", "]"}]}], ")"}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["b", "_"], "2"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"linmomafter", "-", "linmom"}], "==", 
  RowBox[{"imp", " ", 
   RowBox[{"a", "[", "1", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"M", " ", 
        RowBox[{"ua", "[", "1", "]"}]}], "+", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"ua", "[", "1", "]"}]}], "-", 
       RowBox[{"M", " ", 
        SubscriptBox["u", "1"]}], "-", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        SubscriptBox["u", "1"]}]}], ")"}], " ", 
     SubscriptBox[
      UnderscriptBox["a", "_"], "2"]}],
    HoldForm], "+", 
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ua", "[", "1", "]"}], "-", 
          RowBox[{"ua", "[", "2", "]"}]}], ")"}]}], "-", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["u", "1"], "-", 
          SubscriptBox["u", "2"]}], ")"}]}]}], ")"}], " ", 
     SubscriptBox[
      UnderscriptBox["b", "_"], "2"]}],
    HoldForm]}], "==", 
  TagBox[
   RowBox[{"imp", " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "1"]}],
   HoldForm]}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Art's Simple Walker with Hip Spring and Axial Spring", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NewModel", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"a", ",", "ground", ",", "Hinge", ",", 
    RowBox[{"QOffset", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "Pi"}], "/", "2"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"b", ",", "a", ",", "Slider", ",", 
    RowBox[{"TAxis", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"a", "[", "1", "]"}]}]}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], " ", 
      RowBox[{"a", "[", "1", "]"}]}]}], ",", 
    RowBox[{"InbToJnt", "->", "0"}], ",", 
    RowBox[{"Inertia", "->", "0"}], ",", 
    RowBox[{"Mass", "->", "M"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"c", ",", " ", "b", ",", " ", "Hinge", ",", 
    RowBox[{"Axis", "->", 
     RowBox[{"-", 
      RowBox[{"ground", "[", "3", "]"}]}]}], ",", 
    RowBox[{"QOffset", "->", " ", 
     RowBox[{"-", "Pi"}]}], ",", 
    RowBox[{"BodyToJnt", "->", 
     RowBox[{"c", "[", "1", "]"}]}], ",", 
    RowBox[{"InbToJnt", "->", "0"}], ",", 
    RowBox[{"Inertia", "->", "0"}], ",", 
    RowBox[{"Mass", "->", "m"}]}], "]"}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PosCOM", "[", "b", "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SubscriptBox["q", "2"]}], ")"}], " ", 
   SubscriptBox[
    UnderscriptBox["a", "_"], "1"]}],
  HoldForm]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VelCOM", "[", "b", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      SubscriptBox["u", "1"]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["u", "2"]}], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "1"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"b", ",", 
    RowBox[{"M", " ", "grav"}], ",", "0"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"c", ",", 
    RowBox[{"m", " ", "grav"}], ",", "0"}], "]"}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"b", ",", 
    RowBox[{"K", " ", 
     RowBox[{"q", "[", "2", "]"}], " ", 
     RowBox[{"a", "[", "1", "]"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q", "[", "2", "]"}], "-", "1"}], ")"}], " ", 
     RowBox[{"a", "[", "1", "]"}]}]}], "]"}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"b", ",", 
    RowBox[{
     RowBox[{"-", "\[Beta]"}], " ", "\[Kappa]", " ", 
     RowBox[{"q", "[", "3", "]"}], " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"c", ",", 
    RowBox[{"\[Beta]", " ", "\[Kappa]", " ", 
     RowBox[{"q", "[", "3", "]"}], " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"grav", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
     RowBox[{"ground", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Gamma]", "]"}], 
     RowBox[{"ground", "[", "1", "]"}]}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eom", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"EOM", "[", "]"}], " ", "/.", 
    RowBox[{"m", "->", 
     RowBox[{"\[Beta]", " ", "M"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"M", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Gamma]", "-", 
        SubscriptBox["q", "1"]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["q", "2"]}], ")"}]}], "+", 
     RowBox[{"M", " ", "\[Beta]", " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "1"], "]"}]}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], "]"}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "1"], "]"}], " ", 
         SubscriptBox["q", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["u", "1"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", "\[Beta]", "+", 
           RowBox[{"\[Beta]", " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["q", "3"], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
            SubscriptBox["q", "2"]}]}], ")"}], " ", 
         SubscriptBox["u", "2"]}], "+", 
        RowBox[{"2", " ", "M", " ", "\[Beta]", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["q", "3"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["q", "2"]}], ")"}], " ", 
         SubscriptBox["u", "3"]}]}], ")"}]}], "+", 
     RowBox[{"M", " ", "\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "3"], "]"}], " ", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["u", "3", "\[Prime]",
       MultilineFunction->None]}]}], "==", 
    RowBox[{"M", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "1"], "]"}]}], "+", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["q", "1"], "-", 
            SubscriptBox["q", "3"]}], "]"}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "1"], "]"}], " ", 
           SubscriptBox["q", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "\[Beta]"}], "-", 
          RowBox[{"2", " ", "\[Beta]", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "3"], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", "\[Beta]", "+", 
             RowBox[{"\[Beta]", " ", 
              RowBox[{"Cos", "[", 
               SubscriptBox["q", "3"], "]"}]}]}], ")"}], " ", 
           SubscriptBox["q", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
           SubsuperscriptBox["q", "2", "2"]}]}], ")"}], " ", 
        SubsuperscriptBox["u", "1", "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SubscriptBox["q", "2"]}], ")"}], " ", 
           SubsuperscriptBox["u", "3", "2"]}], "+", 
          SubsuperscriptBox["u", "2", "\[Prime]",
           MultilineFunction->None]}], ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"M", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Gamma]", "-", 
          SubscriptBox["q", "1"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", "\[Beta]", "+", 
          RowBox[{"\[Beta]", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "3"], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
           SubscriptBox["q", "2"]}]}], ")"}], " ", 
        SubsuperscriptBox["u", "1", "2"]}]}], ")"}]}], "==", 
    RowBox[{
     RowBox[{"K", " ", 
      SubscriptBox["q", "2"]}], "+", 
     RowBox[{"M", " ", "\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "3"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SubscriptBox["u", "1"]}], "-", 
        SubscriptBox["u", "3"]}], ")"}], " ", 
      SubscriptBox["u", "3"]}], "+", 
     RowBox[{"M", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
      SubsuperscriptBox["u", "2", "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{"M", " ", "\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "3"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SubsuperscriptBox["u", "1", "\[Prime]",
         MultilineFunction->None], "-", 
        SubsuperscriptBox["u", "3", "\[Prime]",
         MultilineFunction->None]}], ")"}]}]}]}], ",", 
   RowBox[{"0", "==", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Kappa]", " ", 
        SubscriptBox["q", "3"]}], "+", 
       RowBox[{"M", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Gamma]", "-", 
            SubscriptBox["q", "1"], "+", 
            SubscriptBox["q", "3"]}], "]"}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "3"], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SubscriptBox["q", "2"]}], ")"}], " ", 
           SubsuperscriptBox["u", "1", "2"]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "3"], "]"}], " ", 
           SubscriptBox["u", "1"], " ", 
           SubscriptBox["u", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", 
              SubscriptBox["q", "3"], "]"}], "-", 
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["q", "3"], "]"}], " ", 
              SubscriptBox["q", "2"]}]}], ")"}], " ", 
           SubsuperscriptBox["u", "1", "\[Prime]",
            MultilineFunction->None]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "3"], "]"}], " ", 
           SubsuperscriptBox["u", "2", "\[Prime]",
            MultilineFunction->None]}], "+", 
          SubsuperscriptBox["u", "3", "\[Prime]",
           MultilineFunction->None]}], ")"}]}]}], ")"}]}]}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eom2", "=", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"#", "/", "M"}], ",", " ", "Equal"}], "]"}], "&"}], ",", 
      "eom"}], "]"}], " ", "]"}], "//", "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", "M"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"M", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          SubscriptBox["q", "1"]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["q", "2"]}], ")"}]}], "+", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["q", "1"], "-", 
            SubscriptBox["q", "3"]}], "]"}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}], " ", 
           SubscriptBox["q", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["u", "1"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "M", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", "\[Beta]", "+", 
             RowBox[{"\[Beta]", " ", 
              RowBox[{"Cos", "[", 
               SubscriptBox["q", "3"], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
              SubscriptBox["q", "2"]}]}], ")"}], " ", 
           SubscriptBox["u", "2"]}], "+", 
          RowBox[{"2", " ", "M", " ", "\[Beta]", " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "3"], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SubscriptBox["q", "2"]}], ")"}], " ", 
           SubscriptBox["u", "3"]}]}], ")"}]}], "+", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Cos", "[", 
           SubscriptBox["q", "3"], "]"}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "3"], "]"}], " ", 
           SubscriptBox["q", "2"]}]}], ")"}], " ", 
        SubsuperscriptBox["u", "3", "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}], "==", 
    RowBox[{
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          SubscriptBox["q", "1"], "]"}]}], "+", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], "]"}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          SubscriptBox["q", "1"], "]"}], " ", 
         SubscriptBox["q", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[Beta]"}], "-", 
        RowBox[{"2", " ", "\[Beta]", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "3"], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", "\[Beta]", "+", 
           RowBox[{"\[Beta]", " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["q", "3"], "]"}]}]}], ")"}], " ", 
         SubscriptBox["q", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
         SubsuperscriptBox["q", "2", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["u", "1", "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "3"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["q", "2"]}], ")"}], " ", 
         SubsuperscriptBox["u", "3", "2"]}], "+", 
        SubsuperscriptBox["u", "2", "\[Prime]",
         MultilineFunction->None]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Gamma]", "-", 
        SubscriptBox["q", "1"]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "\[Beta]", "+", 
        RowBox[{"\[Beta]", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "3"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["u", "1", "2"]}]}], "==", 
    FractionBox[
     RowBox[{
      RowBox[{"K", " ", 
       SubscriptBox["q", "2"]}], "+", 
      RowBox[{"M", " ", "\[Beta]", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "3"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SubscriptBox["u", "1"]}], "-", 
         SubscriptBox["u", "3"]}], ")"}], " ", 
       SubscriptBox["u", "3"]}], "+", 
      RowBox[{"M", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
       SubsuperscriptBox["u", "2", "\[Prime]",
        MultilineFunction->None]}], "+", 
      RowBox[{"M", " ", "\[Beta]", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "3"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox["u", "1", "\[Prime]",
          MultilineFunction->None], "-", 
         SubsuperscriptBox["u", "3", "\[Prime]",
          MultilineFunction->None]}], ")"}]}]}], "M"]}], ",", 
   RowBox[{"0", "==", 
    RowBox[{
     FractionBox["1", "M"], 
     RowBox[{"(", 
      RowBox[{"\[Beta]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Kappa]", " ", 
          SubscriptBox["q", "3"]}], "+", 
         RowBox[{"M", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Gamma]", "-", 
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "3"]}], "]"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              SubscriptBox["q", "3"], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["q", "2"]}], ")"}], " ", 
             SubsuperscriptBox["u", "1", "2"]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              SubscriptBox["q", "3"], "]"}], " ", 
             SubscriptBox["u", "1"], " ", 
             SubscriptBox["u", "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"Cos", "[", 
                SubscriptBox["q", "3"], "]"}], "-", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 SubscriptBox["q", "3"], "]"}], " ", 
                SubscriptBox["q", "2"]}]}], ")"}], " ", 
             SubsuperscriptBox["u", "1", "\[Prime]",
              MultilineFunction->None]}], "-", 
            RowBox[{
             RowBox[{"Sin", "[", 
              SubscriptBox["q", "3"], "]"}], " ", 
             SubsuperscriptBox["u", "2", "\[Prime]",
              MultilineFunction->None]}], "+", 
            SubsuperscriptBox["u", "3", "\[Prime]",
             MultilineFunction->None]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell["First line of Andy's equations of motion", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eom2", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "0"}], ",", 
    RowBox[{
     RowBox[{"q", "[", "1", "]"}], "\[Rule]", "\[Theta]"}], ",", 
    RowBox[{
     RowBox[{"u", "[", "1", "]"}], "\[Rule]", 
     OverscriptBox["\[Theta]", "."]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], "'"}], "->", 
     OverscriptBox["\[Theta]", "\[DoubleDot]"]}], ",", 
    RowBox[{
     RowBox[{"q", "[", "3", "]"}], "\[Rule]", "\[Phi]"}], ",", 
    RowBox[{
     RowBox[{"u", "[", "3", "]"}], "->", 
     OverscriptBox["\[Phi]", "."]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "3", "]"}], "'"}], "->", 
     OverscriptBox["\[Phi]", "\[DoubleDot]"]}], ",", 
    RowBox[{
     RowBox[{"q", "[", "2", "]"}], "\[Rule]", "e"}], ",", 
    RowBox[{
     RowBox[{"u", "[", "2", "]"}], "->", 
     OverscriptBox["e", "."]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "e"}], ")"}], " ", 
    OverscriptBox["e", "."], " ", 
    OverscriptBox["\[Theta]", "."]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "e"}], "+", 
      SuperscriptBox["e", "2"]}], ")"}], " ", 
    OverscriptBox["\[Theta]", "\[DoubleDot]"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "e"}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Gamma]", "-", "\[Theta]"}], "]"}]}]}], "==", "0"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eom2", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "0"}], ",", 
    RowBox[{
     RowBox[{"q", "[", "1", "]"}], "\[Rule]", "\[Theta]"}], ",", 
    RowBox[{
     RowBox[{"u", "[", "1", "]"}], "\[Rule]", 
     OverscriptBox["\[Theta]", "."]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], "'"}], "->", 
     OverscriptBox["\[Theta]", "\[DoubleDot]"]}], ",", 
    RowBox[{
     RowBox[{"q", "[", "3", "]"}], "\[Rule]", "\[Phi]"}], ",", 
    RowBox[{
     RowBox[{"u", "[", "3", "]"}], "->", 
     OverscriptBox["\[Phi]", "."]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "3", "]"}], "'"}], "->", 
     OverscriptBox["\[Phi]", "\[DoubleDot]"]}], ",", 
    RowBox[{
     RowBox[{"q", "[", "2", "]"}], "\[Rule]", "e"}], ",", 
    RowBox[{
     RowBox[{"u", "[", "2", "]"}], "->", 
     OverscriptBox["e", "."]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "2", "]"}], "'"}], "->", 
     OverscriptBox["e", "\[DoubleDot]"]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"e", " ", "K"}], "M"], "==", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"\[Gamma]", "-", "\[Theta]"}], "]"}], "+", 
   OverscriptBox["e", "\[DoubleDot]"], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "e"}], ")"}], " ", 
    SuperscriptBox[
     OverscriptBox["\[Theta]", "."], "2"]}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eom2", "[", 
   RowBox[{"[", "3", "]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"q", "[", "1", "]"}], "\[Rule]", "\[Theta]"}], ",", 
    RowBox[{
     RowBox[{"u", "[", "1", "]"}], "\[Rule]", 
     OverscriptBox["\[Theta]", "."]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], "'"}], "->", 
     OverscriptBox["\[Theta]", "\[DoubleDot]"]}], ",", 
    RowBox[{
     RowBox[{"q", "[", "3", "]"}], "\[Rule]", "\[Phi]"}], ",", 
    RowBox[{
     RowBox[{"u", "[", "3", "]"}], "->", 
     OverscriptBox["\[Phi]", "."]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "3", "]"}], "'"}], "->", 
     OverscriptBox["\[Phi]", "\[DoubleDot]"]}], ",", 
    RowBox[{
     RowBox[{"q", "[", "2", "]"}], "\[Rule]", "e"}], ",", 
    RowBox[{
     RowBox[{"u", "[", "2", "]"}], "->", 
     OverscriptBox["e", "."]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "2", "]"}], "'"}], "->", 
     OverscriptBox["e", "\[DoubleDot]"]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"0", "==", 
  RowBox[{
   FractionBox["1", "M"], 
   RowBox[{"(", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Kappa]", " ", "\[Phi]"}], "+", 
       RowBox[{"M", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           OverscriptBox["e", "."], " ", 
           OverscriptBox["\[Theta]", "."]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}], "-", 
             RowBox[{"e", " ", 
              RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
           OverscriptBox["\[Theta]", "\[DoubleDot]"]}], "+", 
          OverscriptBox["\[Phi]", "\[DoubleDot]"], "+", 
          RowBox[{
           OverscriptBox["e", "\[DoubleDot]"], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "e"}], ")"}], " ", 
           SuperscriptBox[
            OverscriptBox["\[Theta]", "."], "2"], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Gamma]", "-", "\[Theta]", "+", "\[Phi]"}], "]"}]}], 
         ")"}]}]}], ")"}]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"%102", "/", "\[Beta]"}], ",", "Equal"}], "]"}], " ", "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"0", "==", 
  RowBox[{
   FractionBox["1", "M"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Kappa]", " ", "\[Phi]"}], "+", 
     RowBox[{"M", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
         OverscriptBox["e", "."], " ", 
         OverscriptBox["\[Theta]", "."]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}], "-", 
           RowBox[{"e", " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
         OverscriptBox["\[Theta]", "\[DoubleDot]"]}], "+", 
        OverscriptBox["\[Phi]", "\[DoubleDot]"], "+", 
        RowBox[{
         OverscriptBox["e", "\[DoubleDot]"], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "e"}], ")"}], " ", 
         SuperscriptBox[
          OverscriptBox["\[Theta]", "."], "2"], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", "\[Theta]", "+", "\[Phi]"}], "]"}]}], 
       ")"}]}]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CastV", "[", 
  RowBox[{
   RowBox[{"VelCOM", "[", "b", "]"}], ",", "a"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    SubscriptBox["u", "1"], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    SubscriptBox["u", "2"], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "1"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell["Second line", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"eom2", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/", "\[Beta]"}], ",", "Equal"}], "]"}],
   " ", "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Gamma]", "-", 
      SubscriptBox["q", "1"], "+", 
      SubscriptBox["q", "2"]}], "]"}]}], "-", 
   FractionBox[
    RowBox[{"K", " ", 
     SubscriptBox["q", "2"]}], 
    RowBox[{"M", " ", "\[Beta]"}]], "+", 
   RowBox[{
    RowBox[{"Sin", "[", 
     SubscriptBox["q", "2"], "]"}], " ", 
    SubsuperscriptBox["u", "1", "2"]}], "+", 
   SubsuperscriptBox["u", "1", "\[Prime]",
    MultilineFunction->None], "-", 
   RowBox[{
    RowBox[{"Cos", "[", 
     SubscriptBox["q", "2"], "]"}], " ", 
    SubsuperscriptBox["u", "1", "\[Prime]",
     MultilineFunction->None]}], "-", 
   SubsuperscriptBox["u", "2", "\[Prime]",
    MultilineFunction->None]}], "==", "0"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Gamma]", "-", 
       RowBox[{"q", "[", "1", "]"}], "+", 
       RowBox[{"q", "[", "2", "]"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"q", "[", "2", "]"}], "]"}], 
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], "'"}]}]}], "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "1", "]"}], "'"}], "->", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], "-", "\[Gamma]"}], "]"}]}]}], " ", 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Gamma]", "-", 
     SubscriptBox["q", "1"]}], "]"}]}], " ", 
  RowBox[{"Sin", "[", 
   SubscriptBox["q", "2"], "]"}]}]], "Output"]
}, Open  ]],

Cell["Now add an impulse", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linmom", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Mass", "[", "a", "]"}], 
     RowBox[{"VelCOM", "[", "a", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Mass", "[", "b", "]"}], 
     RowBox[{"VelCOM", "[", "b", "]"}]}]}], " ", "/.", 
   RowBox[{"{", 
    RowBox[{"m", "->", 
     RowBox[{"\[Beta]", " ", "M"}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"M", " ", 
       SubscriptBox["u", "1"]}], "+", 
      RowBox[{"M", " ", "\[Beta]", " ", 
       SubscriptBox["u", "1"]}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M", " ", "\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["u", "1"], "-", 
        SubscriptBox["u", "2"]}], ")"}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["b", "_"], "2"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linmomafter", " ", "=", " ", 
  RowBox[{"linmom", " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], "->", 
      RowBox[{"ua", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"u", "[", "2", "]"}], "->", 
      RowBox[{"ua", "[", "2", "]"}]}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"M", " ", 
       RowBox[{"ua", "[", "1", "]"}]}], "+", 
      RowBox[{"M", " ", "\[Beta]", " ", 
       RowBox[{"ua", "[", "1", "]"}]}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M", " ", "\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ua", "[", "1", "]"}], "-", 
        RowBox[{"ua", "[", "2", "]"}]}], ")"}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["b", "_"], "2"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"linmomafter", "-", "linmom"}], "==", 
  RowBox[{"imp", " ", 
   RowBox[{"a", "[", "1", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"M", " ", 
        RowBox[{"ua", "[", "1", "]"}]}], "+", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"ua", "[", "1", "]"}]}], "-", 
       RowBox[{"M", " ", 
        SubscriptBox["u", "1"]}], "-", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        SubscriptBox["u", "1"]}]}], ")"}], " ", 
     SubscriptBox[
      UnderscriptBox["a", "_"], "2"]}],
    HoldForm], "+", 
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ua", "[", "1", "]"}], "-", 
          RowBox[{"ua", "[", "2", "]"}]}], ")"}]}], "-", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["u", "1"], "-", 
          SubscriptBox["u", "2"]}], ")"}]}]}], ")"}], " ", 
     SubscriptBox[
      UnderscriptBox["b", "_"], "2"]}],
    HoldForm]}], "==", 
  TagBox[
   RowBox[{"imp", " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "1"]}],
   HoldForm]}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Art's Simple Walker with Hip Spring and Two Axial Springs for Double Support\
\>", "Section"],

Cell[BoxData[Cell[GraphicsData["Metafile", "\<\
CF5dJ6E]HGAYHf4PEfU^I6mgLb15CDHPAVmbKF5d0@0002Vh0@0009@0000000000@000;80003E0000
00000000001_4P00<QH00215CDH00040^2T00:41000900007P0005P00000000000@00003000>0@00
b`0004<0H@1^07H0H@1c0200=@0^0300001506h0J01Q06h0H`1U06@0801=06D0M01Q06H0J@1/06D0
00000140000<0000200000X0000@00000000000000090000400002l2002O0P003000010000000000
000000/0000@0000/`000=L0000V0000700000400006000010000000000000009@0000`000010000
9@0000`000050020E`0002@0001N0000300007h0002:00000P0002@19P2:0K019P0001`000020000
1P0000@000000000000002D0000<00000P0002P0000<00000@0002D0000<00000P0002D0000<0000
1@00P5L0000T0000NP0008/000210000Y`000080001m0K<1T`4:0RH0000L00000@0000H000040000
00000000000U000030000040000X000030000080000U000030000040000U0000300000D0081G0000
900008<000290000RP000:D000020000V06/0Jh10`8V000070000080000600001000000000000000
9@0000`000020000:00000`0000100009@0000`0000200009@0000`000050020E`0002@0001j0000
RP000880002<00000P0007d1]06G0Jh19P0001`0000100001P0000@000000000000002D0000<0000
0@0002P0000<00000P0002D0000<00000@0002D0000<00001@00P5L0000T0000P@0009D0002=0000
a0000080002C0M81^@5U0RH0000L00000P0000H00002000000000000000U000030000080000X0000
30000040000U000030000080000U0000300000D0081G0000900007X0000k0000Q@0006@000020000
O@6g09h1>04U000030000000080=00004000004000070000600000`000082`h09@0000`000080020
9`0001P000010000000000P;3P0000009@0000`000010000EP0006P000200000GP0008H0001Y0000
4`000:@19@6T0BD1Y04U0J<1B@6S0DT1XP580J01A@6N0D41V`4l0IL1=`6D0C81TP4]0I01:P6@0BX1
U@4]0I/1;06K0B`1X@4Z0J@19@4U0000300000D0080X000030000040000F0000300001P0000F0000
300001T0000B000030000040000U0000300000D0080=00004000004000070000600000`000000000
500000`0000900005P0000`0000H00006`000100002[0@00o@0002D0000<00001000P580001<0@00
0@000<koool000003Ogoo`gmoonl0P00000000000@1306l0M@1b06T0I@1b0200CP1U07L000000000
00000000003AE=5DCP[6d@00000000000000000000000000002JCTh:am4000000000000000000000
00000;J;]X]>2/SA0000000000000000000000000009UPVFCP[;d@00000000000000000000000000
d7K@MTh:c]4000000000000000000000000002E>9Di>2/oA000000000000000000000000002LV9bH
CP[Ed@000000000000000000000000003YH>UTh:e]40000000000000000000000000000000000000
00000000000000000@410@410@410HaC9@0000`000010000E00005@000260000B00008l0001I0000
0@0002lG1d63PPM1X`400>0000010000C0000000000000000000000000000000D00006<0000O0000
5P0000`0000I00003@000100000100001`0001H0000<0000600001/0000@0000X@4001L1000U0000
300000@0081B0000C04000<0003Koooo000000gmool=oOooT040000000000040@`1_07D0LP1Y06D0
LP0P04h0I@1g0000000000000000000000000000002QMJ5eCP[ad@00000000000000000000000000
<iHcUTh:m=4000000000000000000000000002M/9fa>2_GA000000000000000000000000001kDG]A
CP[hd@00000000000000000000000000=fPgJ4h:nM4000000000000000000000000003V9>HU>2T7B
000000000000000000000000000jRCZ9CPY2dP00000000000000000000000000?8TlRDh:A=800000
00000000000000000000000000000000000000410@410@410@4002D0000<00000`0005@0001D0000
Q0000580002:0000G`000040000_5`M1Ph87@I/100010@000@0004`0000000000000000000000000
00000500000a04:95P0001H0000<00006@000180000<00000P0002H0000L0000100000H000040000
00000000000U0000300000@0000X000030000080000D0000300000d0000U0000300000@0000U0000
300000D0081G00009000000000350000/P000<D000020000001V0R`2IP8V00007000008000060000
10000000000000009@0000`000020000:00000`0000400009@0000`0000200009@0000`000050020
E`0002@000030000a@0000T0003E00000P0001d0IP8:09X29P0001`0000400001P0000@000000000
000002D0000<0000100002P0000<00000P0002D0000<0000100002D0000<00001@00P5L0000T0000
30000<D0000B0000e@000080000h06H29@2J0RH0000L00000P0000H00004000000000000000U0000
30000080000X0000300000@0000U000030000080000U0000300000D0081G0000900001D000350000
6`000=D000020000D`1V0T40VP8V0000700000@00006000010000000000000009@0000`000040000
:00000`0000200009@0000`0000400009@0000`000050020E`0002@0000M0000a@0002<0003E0000
0P0006h0IP9L09X29P0001`0000200001P0000@000000000000002D0000<00000P0002P0000<0000
100002D0000<00000P0002D0000<00001@00P5L0000T00009P000<D0000/0000e@000080002906H2
M`2J0RH0000L0000100000H00004000000000000000U0000300000@0000X000030000080000U0000
300000@0000U0000300000D0081G0000900002l000350000=@000=D000020000Y@1V0Y80VP8V0000
700000800006000010000000000000009@0000`000020000:00000`0000400009@0000`000020000
9@0000`000050020E`0002@0000g0000a@0003d0003E00000P000<00IP:]09X29P0001`000040000
1P0000@000000000000002D0000<0000100002P0000<00000P0002D0000<0000100002D0000<0000
1@00P5L0000T0000@0000<D000160000e@000080003K06H2b02J0RH0000L00000P0000H000040000
00000000000U000030000080000X0000300000@0000U000030000080000U0000300000D0081G0000
900004T000350000C`000=D000020000mP1V0^<0VP8V0000700000@0000600001000000000000000
9@0000`000040000:00000`0000200009@0000`0000400009@0000`000050020E`0002@0001A0000
a@0005L0003E00000P000141IP;n09X29P0001`0000200001P0000@000000000000002D0000<0000
0P0002P0000<0000100002D0000<00000P0002D0000<00001@00P5L0000T0000FP000<D0001P0000
e@000080000/0FH26@6J0RH0000L0000100000H00004000000000000000U0000300000@0000X0000
30000080000U0000300000@0000U0000300000D0081G0000900006<000350000J@000=D000020000
A`5V0S@1VP8V0000700000800006000010000000000000009@0000`000020000:00000`000040000
9@0000`0000200009@0000`000050020E`0002@0001[0000a@000740003E00000P000681IP9?0IX2
9P0001`0000400001P0000@000000000000002D0000<0000100002P0000<00000P0002D0000<0000
100002D0000<00001@00P5L0000T0000M0000<D0001j0000e@000080001m0FH2JP6J0RH0000L0000
0P0000H00004000000000000000U000030000080000X0000300000@0000U000030000080000U0000
300000D0081G0000900007d000350000P`000=D000020000V05V0XH1VP8V0000700000@000060000
10000000000000009@0000`000040000:00000`0000200009@0000`0000400009@0000`000050020
E`0002@000260000a@0008/0003E00000P000;<1IP:Q0IX29P0001`0000200001P0000@000000000
000002D0000<00000P0002P0000<0000100002D0000<00000P0002D0000<00001@00P5L0000T0000
SP000<D0002D0000e@000080003>0FH2_06J0RH0000L0000100000H00004000000000000000U0000
300000@0000X000030000080000U0000300000@0000U0000300000D0081G0000900009L000350000
W@000=D000020000jP5V0]L1VP8V0000700000800006000010000000000000009@0000`000020000
:00000`0000400009@0000`0000200009@0000`000050020E`0002@0002O0000a@000:H0003E0000
0P0000D2IP;b0IX29P0001`0000400001P0000@000000000000002D0000<0000100002P0000<0000
0P0002D0000<0000100002D0000<00001@00P5L0000T0000Z0000<D0002^0000e@000080000P0VH2
3@:J0RH0000L00000P0000H00004000000000000000U000030000080000X0000300000@0000U0000
30000080000U0000300000D0081G0000900003<0000=0000GP0008P000020000904Z0:00ZP4V0000
700000@00006000010000000000000009@0000`000040000:00000`0000200009@0000`000040000
9@0000`000050020E`0002@0000V0000Q`0002l0002R00000P0009<0YP5f0?/19P0001`000020000
1P0000@000000000000002D0000<00000P0002P0000<0000100002D0000<00000P0002D0000<0000
1@00P5L0000T0000;P0008X0000g0000Y@000080002]0:l1T0040RH0000L0000100000H000040000
00000000000U0000300000@0000X000030000080000U0000300000@0000U0000300000D0081G0000
900002l000280000=`0008X000020000TP2W0J`0/04V000070000080000600001000000000000000
9@0000`000020000:00000`0000400009@0000`0000200009@0000`000050020E`0002@0000N0000
T`0002l0003400000P0009@0c05O06D29P0001`0000400001P00008000000000000002D0000<0000
100002P0000<00000P0002D0000<0000100002D0000<00001@00P5L0000T0000<00003l0000n0000
I`000080002G0481``3402D0000<00001000P0d0000@00000@0000L0000H0000300000P;3P0U0000
300000P0080W0000600000800000000020/>0000000U000030000080001F0000J00003T0000i0000
@00004D0000C0000/`3A0;<0d@2c0=40b02c0<P0/`380;D0b02h0<P0_@380<<0b0390<P0c`380=@0
a`3H0<L0f0340=<0_`3?0;l0c`2i0<l0/`3A02D0000<00001@00P2P0000<00000P0001H0000<0000
600001H0000<00006@000180000<00000@0002D0000<00001000P0d0000@00000@0000L0000H0000
30000000000D0000300000T0000F0000300001P0000K0000400009P0003_00009@0000`000040020
DP0004`100020000c_ooo`0000350P00a@800;`200000000000104<0K`1e0780J@1U0780801>06D0
M`000?@3000o0000m0<004l0003d0`00P0000?@3003@0000m0<000D000000000m0<00600003d0`00
T0000?@300300000m0<000@0000?0000m0<008l0003d0`00W`000?@3003_0000m0<000@00030oooo
lP<00000000000003`000<3oooob0`0000000000000?0000`?oooo83000000003`000000ooob0`00
000000l00030oooolP<00000000?0000`?oooo83000000003`000<3oooob0`00000000l000000000
00000000000000000000000000010@410@410@41oolU000030000080001D0000E00002d0001F0000
=P0006L000010000;aL7@H>21d6>00002`400040001<0000000000000000000000000000001@0000
HP0001l0000F0000300001T0000=000040000040000700005P0000`0000H00006`000100002^0000
g`0002D0000<00001000P580001<0@001@000=_oool00000a@800<D2002@0@00000000000@1306l0
M@1b06T0I@1b0200CP1U07L0003Y0`00P0000>T300030000D0000>T3001P0000j@<00700003Y0`00
00000>T3002@0000j@<00:00003Y0`00/0000>T300300000j@<00=00003Y0`002@000<3oooo`0`00
000000l0002@0000l0<00040001P0000j0<00700003X0`00P0000>P300030000D0000>P3001P0000
j0<0070000000000P0000>P3002@0000j0<00:00003X0`00/0000>P300300000j0<00=00003X0`00
2@000000000P0000000000000000000000000000000000000@410@410@410@009@0000`000050000
E00005@0000e0000CP0003/0001K00000@0002lG1d63PPM1Y`000?@000010000C000000000000000
0000000000000000D0000340000F00005P0000`0000I00004P0000`0000200003@00010000010000
1`0001P0000<0000oooo01@0000<00003@0002D0000<00002000P2D0000<00000000P5H0002/0000
C`000040001Z0000700002@0001:0C/0A`520481B@0l0Dl0=@5C02d1EP0U0EL0705G01@1E@0D0ED0
305A00D1C0000DH0o00o0?T0>03g0300m`0W0?T07`3i01l0o@0G008140080@/03`4601L10`0O0@80
9`420301100`0@@0>04803h13@140A<0B04J04/18P1<0BX0C04b04X1>`0V0000700000H000060000
10000000000000009@0000`000060000:00000`0000400009@0000`0000600009@0000`000050020
E`000:`0001?00000@0006X0000L0000900004X1>`170D80@P5903`1C`0e0E<0;@5F02D1E`0L0EL0
505E01@1E@0<0E401@5<0001AP3l03l0n@0h0?L0<03g02L0n@0O0?T07`3m01L00P4@00P12`0?0@H0
5`4301l10P0W0@80<0440301100h0@P0?P4=04@14`180AX0B`4R04`1:P1<0C80BP4k02D0000<0000
0000P0d0000@00000@0000L0000H000030000000000U0000300000P0080U0000300000@0081F0000
D00004l000090000G@0001/0000=0000505C00`1D0060D/000540?`0?@3i03H0n00]0?T09@3k01d0
n`0M02<1:`0S0B/0505C00d0000@00000@0000L0000U0000300000P0080U0000300000@0081F0000
D00005d000010000J`0001<0000=0000<@4403T11`100@`0A@4C04T16P1<0B40C@4Z04d1<P1;0CX0
B`4j02<1;00S0B`0<@4401H0000<0000600001H0000<00006@000180000<00000@0001H0000<0000
600000d0000@00000@0000L0000D0000300000T0000K000040000;81003B0@009@0000`000040020
DP0004`100040000c_ooo`00000000000000090100000000000104<0K`1e0780J@1U0780801>06D0
M`000100000<0`00800000`3000`000030<00400000<0`00D00000`30000000030<00700000<0`00
P00000`3002@000030<00:00000<0`00/00000`30030000030<00=00000<0`003P00000000000000
@0000<T2000000003`0009l000380P00k`000<P2000200008000024000010000W`000000003_0000
1@000080002O000010000>l0000400000P0009l000030000k`0000<000020000W`00008000000000
00000000000000000000000000010@410@410@41000U0000300000@0001D0000E00008/0002E0000
U0000:H000010000;aL7@H>21d6b0@00dP400040001<0000000000000000000000000000001@0000
L@0001l0000F0000300001T0000F0000300001P0000=000040000040000700006`000100003@0@00
gP4002D0000<00001000P580001<0@001`000=_oool0000000000000002@0@00000000000@1306l0
M@1b06T0I@1b0200CP1U07L0001O0000g0800040003L0P00H0000040000?0000P0000=/200010000
00000=T200010000<0000=T200100000f@800080001P0000f@800700003I0P000P000800003I0P00
T0000=T200020000X0000=T2002`0000f@80008000300000f@800040000P0000f@800800003I0P00
0P00010000000000@0000=T200020000T0000=T2003@0000f@800>00003I0P000`000100003I0P00
T0000=T200020000000000000000000000000000000000000@410@410@410@009@0000`000070000
E00005@0002E0000V@0009/0002W00000@0002lG1d63PPM1d0400=h100010000C000000000000000
0000000000000000D00003@0000F00005P0000`0000I00004P0000`0000200005P0000`0000H0000
5P0000`0000I00004P0000`0000100005P0000`0000H00003@000100000100001`0001/0000@0000
A0000<`1000U0000300000@0080U0000300000@0001D0000E00001H0002C00007`000:@000010000
;aL7@H>21d540000c0400040001<0000000000000000000000000000001@0000L@0001l0000F0000
300001T0000F0000300001P0000=000040000040000700006`000100001R0000f04002D0000<0000
1000P2D0000<00001`0005@0001D00007`0009L0000U0000Y@000040000_5`M1Ph87@F80003H0@00
0@0004`000000000000000000000000000000500000b00005P0001H0000<00006@000180000<0000
0P0002H0000L0000200000H00001000000000000000U0000300000P0000X0000300000H0000D0000
300000d0000U0000300000P0000U0000300000D0081G0000900001h0002X00007P000<8000020000
G@1L0Ud03@8V0000700000H0000600000@000000000000009@0000`000060000:00000`000080000
9@0000`0000600009@0000`000050020E`0002P0000/0000[`000380002c00000`0008T08@:=02<2
V`0`0RD0000<00001000P0d0000@00000@0000L0000U0000300000P0080U0000300000@0081F0000
L00002P0002/0000;P000;00000E0000T00M0Y0070:@01`2O@0J0Wd06P9m01/2OP0L0X007@:301l2
R00S0X`09P:<02H2R`0U0XX08`:90242R@0O0XT07`::01h2S00M0Xh07@:@01d29P0001`000080000
1P00004000000000000002D0000<0000200002P0000<00001P0002D0000<0000200002D0000<0000
1@00P5L0000/00004@000:/0000I0000[P0000@0001?01L2B@0H0Sl06`8f02029@0000`000040020
3@000100000100001`0002D0000<00002000P2D0000<00001000P5H0001`000060000:T0000N0000
[@0001D0001:0102BP0@0TX0409M01D2G@0E0U`05@9J01H2F00G0UD0609?01X2BP0K0TX06`9<01X2
C@0H0Tl05`9?01H2C`0F0Tl0509=01<2B`0A0TX0408F0000300001P0000F0000300001T0000B0000
30000040000F0000300001P0000U0000300000@0080=00004000004000070000500000`000090000
6`00010000060000>`8002D0000<00001000P2D0000<0000100005@0001D00000P000;L0000;0000
b0000040000_5`M1Ph87@@H0000k0P000@0004`000000000000000000000000000000500001a0000
7`0001H0000<00006@0001H0000<0000600000d0000@00000@0000L0000K0000400002@000170P00
9@0000`0000400209@0000`000070000E00005@0000<0000^`000180003900000@0002lG1d63PPM1
900004L200010000C0000000000000000000000000000000D0000340000F00005P0000`0000I0000
4P0000`0000200009P0001`0000600001P00004000000000000002D0000<00001P0002P0000<0000
200001@0000<00003@0002D0000<00001P0002D0000<00001@00P5L000100000CP0004h0001Y0000
D00000T000170O<0AP7d03P1n00[0OX07@7k00l1nP010OL0m03c0?<0lP0U0000300000@0080=0000
40000040000700009@0000`0000800209@0000`000040020EP000700001W0000C00006d0001@0000
5@0004D1n`150O/0A@7k05@1kP1D0Nh0D`7^0541kP1?0Nh0C07_04D1l0110O40@@7a04<1lP150O80
A`7c04P1m0180O@0B07e04L1m`160OT0A@7k02D0000<00001000P0d0000@00000@0000L0000U0000
300000P0080U0000300000@0081F0000L00004X0001<0000D0000500000E0000m@3j0?D0nP3e0?X0
iP3]0>H0k@3W0>d0j@3]0>/0kP3^0>h0m@3`0?T0l@3i0?40m`3a0?D0l@3c0?80lP3c0?80l`3b0?@0
l`3f0?@0n03e0?X05P0000`0000H00005P0000`0000I00004P0000`0000100005P0000`0000H0000
9@0000`0000400203@000100000100001`0001@0000<00002@0001/0000@0000104002D1000U0000
300000@0080U0000300000@0001D0000E00005<0001N0000G00006l000010000;aL7@H>21d440@00
9@400040001<0000000000000000000000000000001@0000L@0001l0000F0000300001T0000F0000
300001P0000=000040000040000700006`000100000R0@00<@4002D0000<00001000P2D0000<0000
1`0005@0001D0000G@000680001S0000L0000040000_5`M1Ph87@B81000a0@000@0004`000000000
000000000000000000000500000c00005P0001H0000<00006@000180000<00000P0002D0000<0000
1`00P2P0000<00001P0000h0000D000000000100000D0000
\>"], "Graphics",
  GeneratedCell->False,
  CellAutoOverwrite->False,
  ImageSize->{178, 212},
  ImageMargins->{{0, 0}, {0, 0}},
  ImageRegion->{{0, 1}, {0, 1}}]], "Input",
 Evaluatable->False],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NewModel", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"a", ",", "ground", ",", "Hinge", ",", 
    RowBox[{"QOffset", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "Pi"}], "/", "2"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"b", ",", "a", ",", "Slider", ",", 
    RowBox[{"TAxis", "\[Rule]", 
     RowBox[{"a", "[", "1", "]"}]}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", 
     RowBox[{"-", " ", 
      RowBox[{"b", "[", "1", "]"}]}]}], ",", 
    RowBox[{"InbToJnt", "->", "0"}], ",", 
    RowBox[{"Inertia", "->", "0"}], ",", 
    RowBox[{"Mass", "->", "M"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"c", ",", " ", "b", ",", " ", "Hinge", ",", 
    RowBox[{"Axis", "->", 
     RowBox[{"-", 
      RowBox[{"ground", "[", "3", "]"}]}]}], ",", 
    RowBox[{"QOffset", "->", " ", 
     RowBox[{"-", "Pi"}]}], ",", 
    RowBox[{"BodyToJnt", "->", 
     RowBox[{"-", 
      RowBox[{"c", "[", "1", "]"}]}]}], ",", 
    RowBox[{"InbToJnt", "->", "0"}], ",", 
    RowBox[{"Inertia", "->", "0"}], ",", 
    RowBox[{"Mass", "\[Rule]", "0"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"d", ",", " ", "c", ",", " ", "Slider", ",", " ", 
    RowBox[{"TAxis", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"c", "[", "1", "]"}]}]}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", "0"}], ",", 
    RowBox[{"InbToJnt", "\[Rule]", "0"}], ",", 
    RowBox[{"Mass", "\[Rule]", "0"}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"b", ",", 
    RowBox[{"M", " ", "grav"}], ",", "0"}], "]"}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"b", ",", 
    RowBox[{"K", " ", 
     RowBox[{"q", "[", "2", "]"}], " ", 
     RowBox[{"a", "[", "1", "]"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q", "[", "2", "]"}], "-", "1"}], ")"}], " ", 
     RowBox[{"b", "[", "1", "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"b", ",", 
    RowBox[{
     RowBox[{"-", "K"}], " ", 
     RowBox[{"q", "[", "4", "]"}], " ", 
     RowBox[{"c", "[", "1", "]"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"q", "[", "4", "]"}]}], ")"}], 
     RowBox[{"c", "[", "1", "]"}]}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"b", ",", 
    RowBox[{
     RowBox[{"-", "\[Beta]"}], " ", "\[Kappa]", " ", 
     RowBox[{"q", "[", "3", "]"}], " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"c", ",", 
    RowBox[{"\[Beta]", " ", "\[Kappa]", " ", 
     RowBox[{"q", "[", "3", "]"}], " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell["Constraint", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"constraint", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"q", "[", "2", "]"}]}], ")"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"q", "[", "1", "]"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"q", "[", "4", "]"}]}], ")"}], 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q", "[", "1", "]"}], "-", 
         RowBox[{"q", "[", "3", "]"}]}], "]"}]}]}], "\[Equal]", "s"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"q", "[", "2", "]"}]}], ")"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"q", "[", "1", "]"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"q", "[", "4", "]"}]}], ")"}], 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q", "[", "1", "]"}], "-", 
         RowBox[{"q", "[", "3", "]"}]}], "]"}]}]}], "\[Equal]", "0"}]}], 
   "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["q", "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["q", "4"]}], ")"}]}]}], "==", "s"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["q", "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["q", "4"]}], ")"}]}]}], "==", "0"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{"constraint", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "[", "2", "]"}], ",", 
       RowBox[{"q", "[", "4", "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "  ", "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["q", "2"], "\[Rule]", 
    RowBox[{"1", "-", 
     RowBox[{"s", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      RowBox[{"Cot", "[", 
       SubscriptBox["q", "3"], "]"}]}], "-", 
     RowBox[{"s", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}]}]}], ",", 
   RowBox[{
    SubscriptBox["q", "4"], "\[Rule]", 
    RowBox[{"1", "-", 
     RowBox[{"s", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      RowBox[{"Csc", "[", 
       SubscriptBox["q", "3"], "]"}]}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"GActFrc", "["}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"grav", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
     RowBox[{"ground", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Gamma]", "]"}], 
     RowBox[{"ground", "[", "1", "]"}]}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"eom", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"EOM", "[", "]"}], " ", "/.", 
    RowBox[{"m", "->", 
     RowBox[{"\[Beta]", " ", "M"}]}]}], "]"}]}]], "Input"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["McGeer's Runner with Hip Spring and Axial Spring", "Section"],

Cell[CellGroupData[{

Cell["Stance Phase Equations of motion", "Subsection"],

Cell[BoxData[Cell[GraphicsData["Metafile", "\<\
CF5dJ6E]HGAYHf4PEfU^I6mgLb15CDHPAVmbKF5d0@0002Vh0@0009@0000000000@000;80003E0000
00000000001_4P00<QH00215CDH00040^2T00:41000900007P0005P00000000000@00003000>0@00
b`0004<0H@1^07H0H@1c0200=@0^0300001506h0J01Q06h0H`1U06@0801=06D0M01Q06H0J@1/06D0
00000140000<0000200000X0000@00000000000000090000400002l2002O0P003000010000000000
000000/0000@0000/`000=L0000V0000700000400006000010000000000000009@0000`000010000
9@0000`000050020E`0002@0001N0000300007h0002:00000P0002@19P2:0K019P0001`000020000
1P0000@000000000000002D0000<00000P0002P0000<00000@0002D0000<00000P0002D0000<0000
1@00P5L0000T0000NP0008/000210000Y`000080001m0K<1T`4:0RH0000L00000@0000H000040000
00000000000U000030000040000X000030000080000U000030000040000U0000300000D0081G0000
900008<000290000RP000:D000020000V06/0Jh10`8V000070000080000600001000000000000000
9@0000`000020000:00000`0000100009@0000`0000200009@0000`000050020E`0002@0001j0000
RP000880002<00000P0007d1]06G0Jh19P0001`0000100001P0000@000000000000002D0000<0000
0@0002P0000<00000P0002D0000<00000@0002D0000<00001@00P5L0000T0000P@0009D0002=0000
a0000080002C0M81^@5U0RH0000L00000P0000H00002000000000000000U000030000080000X0000
30000040000U000030000080000U0000300000D0081G0000900007X0000k0000Q@0006@000020000
O@6g09h1>04U000030000000080=00004000004000070000600000`000082`h09@0000`000080020
9`0001P000010000000000P;3P0000009@0000`000010000EP0006P000200000GP0008H0001Y0000
4`000:@19@6T0BD1Y04U0J<1B@6S0DT1XP580J01A@6N0D41V`4l0IL1=`6D0C81TP4]0I01:P6@0BX1
U@4]0I/1;06K0B`1X@4Z0J@19@4U0000300000D0080X000030000040000F0000300001P0000F0000
300001T0000B000030000040000U0000300000D0080=00004000004000070000600000`000000000
500000`0000900005P0000`0000H00006`000100002[0@00o@0002D0000<00001000P580001<0@00
0@000<koool000003Ogoo`gmoonl0P00000000000@1306l0M@1b06T0I@1b0200CP1U07L000000000
00000000003AE=5DCP[6d@00000000000000000000000000002JCTh:am4000000000000000000000
00000;J;]X]>2/SA0000000000000000000000000009UPVFCP[;d@00000000000000000000000000
d7K@MTh:c]4000000000000000000000000002E>9Di>2/oA000000000000000000000000002LV9bH
CP[Ed@000000000000000000000000003YH>UTh:e]40000000000000000000000000000000000000
00000000000000000@410@410@410HaC9@0000`000010000E00005@000260000B00008l0001I0000
0@0002lG1d63PPM1X`400>0000010000C0000000000000000000000000000000D00006<0000O0000
5P0000`0000I00003@000100000100001`0001H0000<0000600001/0000@0000X@4001L1000U0000
300000@0081B0000C04000<0003Koooo000000gmool=oOooT040000000000040@`1_07D0LP1Y06D0
LP0P04h0I@1g0000000000000000000000000000002QMJ5eCP[ad@00000000000000000000000000
<iHcUTh:m=4000000000000000000000000002M/9fa>2_GA000000000000000000000000001kDG]A
CP[hd@00000000000000000000000000=fPgJ4h:nM4000000000000000000000000003V9>HU>2T7B
000000000000000000000000000jRCZ9CPY2dP00000000000000000000000000?8TlRDh:A=800000
00000000000000000000000000000000000000410@410@410@4002D0000<00000`0005@0001D0000
Q0000580002:0000G`000040000_5`M1Ph87@I/100010@000@0004`0000000000000000000000000
00000500000a04:95P0001H0000<00006@000180000<00000P0002H0000L0000100000H000040000
00000000000U0000300000@0000X000030000080000D0000300000d0000U0000300000@0000U0000
300000D0081G00009000000000350000/P000<D000020000001V0R`2IP8V00007000008000060000
10000000000000009@0000`000020000:00000`0000400009@0000`0000200009@0000`000050020
E`0002@000030000a@0000T0003E00000P0001d0IP8:09X29P0001`0000400001P0000@000000000
000002D0000<0000100002P0000<00000P0002D0000<0000100002D0000<00001@00P5L0000T0000
30000<D0000B0000e@000080000h06H29@2J0RH0000L00000P0000H00004000000000000000U0000
30000080000X0000300000@0000U000030000080000U0000300000D0081G0000900001D000350000
6`000=D000020000D`1V0T40VP8V0000700000@00006000010000000000000009@0000`000040000
:00000`0000200009@0000`0000400009@0000`000050020E`0002@0000M0000a@0002<0003E0000
0P0006h0IP9L09X29P0001`0000200001P0000@000000000000002D0000<00000P0002P0000<0000
100002D0000<00000P0002D0000<00001@00P5L0000T00009P000<D0000/0000e@000080002906H2
M`2J0RH0000L0000100000H00004000000000000000U0000300000@0000X000030000080000U0000
300000@0000U0000300000D0081G0000900002l000350000=@000=D000020000Y@1V0Y80VP8V0000
700000800006000010000000000000009@0000`000020000:00000`0000400009@0000`000020000
9@0000`000050020E`0002@0000g0000a@0003d0003E00000P000<00IP:]09X29P0001`000040000
1P0000@000000000000002D0000<0000100002P0000<00000P0002D0000<0000100002D0000<0000
1@00P5L0000T0000@0000<D000160000e@000080003K06H2b02J0RH0000L00000P0000H000040000
00000000000U000030000080000X0000300000@0000U000030000080000U0000300000D0081G0000
900004T000350000C`000=D000020000mP1V0^<0VP8V0000700000@0000600001000000000000000
9@0000`000040000:00000`0000200009@0000`0000400009@0000`000050020E`0002@0001A0000
a@0005L0003E00000P000141IP;n09X29P0001`0000200001P0000@000000000000002D0000<0000
0P0002P0000<0000100002D0000<00000P0002D0000<00001@00P5L0000T0000FP000<D0001P0000
e@000080000/0FH26@6J0RH0000L0000100000H00004000000000000000U0000300000@0000X0000
30000080000U0000300000@0000U0000300000D0081G0000900006<000350000J@000=D000020000
A`5V0S@1VP8V0000700000800006000010000000000000009@0000`000020000:00000`000040000
9@0000`0000200009@0000`000050020E`0002@0001[0000a@000740003E00000P000681IP9?0IX2
9P0001`0000400001P0000@000000000000002D0000<0000100002P0000<00000P0002D0000<0000
100002D0000<00001@00P5L0000T0000M0000<D0001j0000e@000080001m0FH2JP6J0RH0000L0000
0P0000H00004000000000000000U000030000080000X0000300000@0000U000030000080000U0000
300000D0081G0000900007d000350000P`000=D000020000V05V0XH1VP8V0000700000@000060000
10000000000000009@0000`000040000:00000`0000200009@0000`0000400009@0000`000050020
E`0002@000260000a@0008/0003E00000P000;<1IP:Q0IX29P0001`0000200001P0000@000000000
000002D0000<00000P0002P0000<0000100002D0000<00000P0002D0000<00001@00P5L0000T0000
SP000<D0002D0000e@000080003>0FH2_06J0RH0000L0000100000H00004000000000000000U0000
300000@0000X000030000080000U0000300000@0000U0000300000D0081G0000900009L000350000
W@000=D000020000jP5V0]L1VP8V0000700000800006000010000000000000009@0000`000020000
:00000`0000400009@0000`0000200009@0000`000050020E`0002@0002O0000a@000:H0003E0000
0P0000D2IP;b0IX29P0001`0000400001P0000@000000000000002D0000<0000100002P0000<0000
0P0002D0000<0000100002D0000<00001@00P5L0000T0000Z0000<D0002^0000e@000080000P0VH2
3@:J0RH0000L00000P0000H00004000000000000000U000030000080000X0000300000@0000U0000
30000080000U0000300000D0081G0000900003<0000=0000GP0008P000020000904Z0:00ZP4V0000
700000@00006000010000000000000009@0000`000040000:00000`0000200009@0000`000040000
9@0000`000050020E`0002@0000V0000Q`0002l0002R00000P0009<0YP5f0?/19P0001`000020000
1P0000@000000000000002D0000<00000P0002P0000<0000100002D0000<00000P0002D0000<0000
1@00P5L0000T0000;P0008X0000g0000Y@000080002]0:l1T0040RH0000L0000100000H000040000
00000000000U0000300000@0000X000030000080000U0000300000@0000U0000300000D0081G0000
900002l000280000=`0008X000020000TP2W0J`0/04V000070000080000600001000000000000000
9@0000`000020000:00000`0000400009@0000`0000200009@0000`000050020E`0002@0000N0000
T`0002l0003400000P0009@0c05O06D29P0001`0000400001P00008000000000000002D0000<0000
100002P0000<00000P0002D0000<0000100002D0000<00001@00P5L0000T0000<00003l0000n0000
I`000080002G0481``3402D0000<00001000P0d0000@00000@0000L0000H0000300000P;3P0U0000
300000P0080W0000600000800000000020/>0000000U000030000080001F0000J00003T0000i0000
@00004D0000C0000/`3A0;<0d@2c0=40b02c0<P0/`380;D0b02h0<P0_@380<<0b0390<P0c`380=@0
a`3H0<L0f0340=<0_`3?0;l0c`2i0<l0/`3A02D0000<00001@00P2P0000<00000P0001H0000<0000
600001H0000<00006@000180000<00000@0002D0000<00001000P0d0000@00000@0000L0000H0000
30000000000D0000300000T0000F0000300001P0000K0000400009P0003_00009@0000`000040020
DP0004`100020000c_ooo`0000350P00a@800;`200000000000104<0K`1e0780J@1U0780801>06D0
M`000?@3000o0000m0<004l0003d0`00P0000?@3003@0000m0<000D000000000m0<00600003d0`00
T0000?@300300000m0<000@0000?0000m0<008l0003d0`00W`000?@3003_0000m0<000@00030oooo
lP<00000000000003`000<3oooob0`0000000000000?0000`?oooo83000000003`000000ooob0`00
000000l00030oooolP<00000000?0000`?oooo83000000003`000<3oooob0`00000000l000000000
00000000000000000000000000010@410@410@41oolU000030000080001D0000E00002d0001F0000
=P0006L000010000;aL7@H>21d6>00002`400040001<0000000000000000000000000000001@0000
HP0001l0000F0000300001T0000=000040000040000700005P0000`0000H00006`000100002^0000
g`0002D0000<00001000P580001<0@001@000=_oool00000a@800<D2002@0@00000000000@1306l0
M@1b06T0I@1b0200CP1U07L0003Y0`00P0000>T300030000D0000>T3001P0000j@<00700003Y0`00
00000>T3002@0000j@<00:00003Y0`00/0000>T300300000j@<00=00003Y0`002@000<3oooo`0`00
000000l0002@0000l0<00040001P0000j0<00700003X0`00P0000>P300030000D0000>P3001P0000
j0<0070000000000P0000>P3002@0000j0<00:00003X0`00/0000>P300300000j0<00=00003X0`00
2@000000000P0000000000000000000000000000000000000@410@410@410@009@0000`000050000
E00005@0000e0000CP0003/0001K00000@0002lG1d63PPM1Y`000?@000010000C000000000000000
0000000000000000D0000340000F00005P0000`0000I00004P0000`0000200003@00010000010000
1`0001P0000<0000oooo01@0000<00003@0002D0000<00002000P2D0000<00000000P5H0002/0000
C`000040001Z0000700002@0001:0C/0A`520481B@0l0Dl0=@5C02d1EP0U0EL0705G01@1E@0D0ED0
305A00D1C0000DH0o00o0?T0>03g0300m`0W0?T07`3i01l0o@0G008140080@/03`4601L10`0O0@80
9`420301100`0@@0>04803h13@140A<0B04J04/18P1<0BX0C04b04X1>`0V0000700000H000060000
10000000000000009@0000`000060000:00000`0000400009@0000`0000600009@0000`000050020
E`000:`0001?00000@0006X0000L0000900004X1>`170D80@P5903`1C`0e0E<0;@5F02D1E`0L0EL0
505E01@1E@0<0E401@5<0001AP3l03l0n@0h0?L0<03g02L0n@0O0?T07`3m01L00P4@00P12`0?0@H0
5`4301l10P0W0@80<0440301100h0@P0?P4=04@14`180AX0B`4R04`1:P1<0C80BP4k02D0000<0000
0000P0d0000@00000@0000L0000H000030000000000U0000300000P0080U0000300000@0081F0000
D00004l000090000G@0001/0000=0000505C00`1D0060D/000540?`0?@3i03H0n00]0?T09@3k01d0
n`0M02<1:`0S0B/0505C00d0000@00000@0000L0000U0000300000P0080U0000300000@0081F0000
D00005d000010000J`0001<0000=0000<@4403T11`100@`0A@4C04T16P1<0B40C@4Z04d1<P1;0CX0
B`4j02<1;00S0B`0<@4401H0000<0000600001H0000<00006@000180000<00000@0001H0000<0000
600000d0000@00000@0000L0000D0000300000T0000K000040000;81003B0@009@0000`000040020
DP0004`100040000c_ooo`00000000000000090100000000000104<0K`1e0780J@1U0780801>06D0
M`000100000<0`00800000`3000`000030<00400000<0`00D00000`30000000030<00700000<0`00
P00000`3002@000030<00:00000<0`00/00000`30030000030<00=00000<0`003P00000000000000
@0000<T2000000003`0009l000380P00k`000<P2000200008000024000010000W`000000003_0000
1@000080002O000010000>l0000400000P0009l000030000k`0000<000020000W`00008000000000
00000000000000000000000000010@410@410@41000U0000300000@0001D0000E00008/0002E0000
U0000:H000010000;aL7@H>21d6b0@00dP400040001<0000000000000000000000000000001@0000
L@0001l0000F0000300001T0000F0000300001P0000=000040000040000700006`000100003@0@00
gP4002D0000<00001000P580001<0@001`000=_oool0000000000000002@0@00000000000@1306l0
M@1b06T0I@1b0200CP1U07L0001O0000g0800040003L0P00H0000040000?0000P0000=/200010000
00000=T200010000<0000=T200100000f@800080001P0000f@800700003I0P000P000800003I0P00
T0000=T200020000X0000=T2002`0000f@80008000300000f@800040000P0000f@800800003I0P00
0P00010000000000@0000=T200020000T0000=T2003@0000f@800>00003I0P000`000100003I0P00
T0000=T200020000000000000000000000000000000000000@410@410@410@009@0000`000070000
E00005@0002E0000V@0009/0002W00000@0002lG1d63PPM1d0400=h100010000C000000000000000
0000000000000000D00003@0000F00005P0000`0000I00004P0000`0000200005P0000`0000H0000
5P0000`0000I00004P0000`0000100005P0000`0000H00003@000100000100001`0001/0000@0000
A0000<`1000U0000300000@0080U0000300000@0001D0000E00001H0002C00007`000:@000010000
;aL7@H>21d540000c0400040001<0000000000000000000000000000001@0000L@0001l0000F0000
300001T0000F0000300001P0000=000040000040000700006`000100001R0000f04002D0000<0000
1000P2D0000<00001`0005@0001D00007`0009L0000U0000Y@000040000_5`M1Ph87@F80003H0@00
0@0004`000000000000000000000000000000500000b00005P0001H0000<00006@000180000<0000
0P0002H0000L0000200000H00001000000000000000U0000300000P0000X0000300000H0000D0000
300000d0000U0000300000P0000U0000300000D0081G0000900001h0002X00007P000<8000020000
G@1L0Ud03@8V0000700000H0000600000@000000000000009@0000`000060000:00000`000080000
9@0000`0000600009@0000`000050020E`0002P0000/0000[`000380002c00000`0008T08@:=02<2
V`0`0RD0000<00001000P0d0000@00000@0000L0000U0000300000P0080U0000300000@0081F0000
L00002P0002/0000;P000;00000E0000T00M0Y0070:@01`2O@0J0Wd06P9m01/2OP0L0X007@:301l2
R00S0X`09P:<02H2R`0U0XX08`:90242R@0O0XT07`::01h2S00M0Xh07@:@01d29P0001`000080000
1P00004000000000000002D0000<0000200002P0000<00001P0002D0000<0000200002D0000<0000
1@00P5L0000/00004@000:/0000I0000[P0000@0001?01L2B@0H0Sl06`8f02029@0000`000040020
3@000100000100001`0002D0000<00002000P2D0000<00001000P5H0001`000060000:T0000N0000
[@0001D0001:0102BP0@0TX0409M01D2G@0E0U`05@9J01H2F00G0UD0609?01X2BP0K0TX06`9<01X2
C@0H0Tl05`9?01H2C`0F0Tl0509=01<2B`0A0TX0408F0000300001P0000F0000300001T0000B0000
30000040000F0000300001P0000U0000300000@0080=00004000004000070000500000`000090000
6`00010000060000>`8002D0000<00001000P2D0000<0000100005@0001D00000P000;L0000;0000
b0000040000_5`M1Ph87@@H0000k0P000@0004`000000000000000000000000000000500001a0000
7`0001H0000<00006@0001H0000<0000600000d0000@00000@0000L0000K0000400002@000170P00
9@0000`0000400209@0000`000070000E00005@0000<0000^`000180003900000@0002lG1d63PPM1
900004L200010000C0000000000000000000000000000000D0000340000F00005P0000`0000I0000
4P0000`0000200009P0001`0000600001P00004000000000000002D0000<00001P0002P0000<0000
200001@0000<00003@0002D0000<00001P0002D0000<00001@00P5L000100000CP0004h0001Y0000
D00000T000170O<0AP7d03P1n00[0OX07@7k00l1nP010OL0m03c0?<0lP0U0000300000@0080=0000
40000040000700009@0000`0000800209@0000`000040020EP000700001W0000C00006d0001@0000
5@0004D1n`150O/0A@7k05@1kP1D0Nh0D`7^0541kP1?0Nh0C07_04D1l0110O40@@7a04<1lP150O80
A`7c04P1m0180O@0B07e04L1m`160OT0A@7k02D0000<00001000P0d0000@00000@0000L0000U0000
300000P0080U0000300000@0081F0000L00004X0001<0000D0000500000E0000m@3j0?D0nP3e0?X0
iP3]0>H0k@3W0>d0j@3]0>/0kP3^0>h0m@3`0?T0l@3i0?40m`3a0?D0l@3c0?80lP3c0?80l`3b0?@0
l`3f0?@0n03e0?X05P0000`0000H00005P0000`0000I00004P0000`0000100005P0000`0000H0000
9@0000`0000400203@000100000100001`0001@0000<00002@0001/0000@0000104002D1000U0000
300000@0080U0000300000@0001D0000E00005<0001N0000G00006l000010000;aL7@H>21d440@00
9@400040001<0000000000000000000000000000001@0000L@0001l0000F0000300001T0000F0000
300001P0000=000040000040000700006`000100000R0@00<@4002D0000<00001000P2D0000<0000
1`0005@0001D0000G@000680001S0000L0000040000_5`M1Ph87@B81000a0@000@0004`000000000
000000000000000000000500000c00005P0001H0000<00006@000180000<00000P0002D0000<0000
1`00P2P0000<00001P0000h0000D000000000100000D0000
\>"], "Graphics",
  GeneratedCell->False,
  CellAutoOverwrite->False,
  ImageSize->{178, 212},
  ImageMargins->{{0, 0}, {0, 0}},
  ImageRegion->{{0, 1}, {0, 1}}]], "Input",
 Evaluatable->False],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NewModel", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"a", ",", "ground", ",", "Hinge", ",", 
    RowBox[{"QOffset", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "Pi"}], "/", "2"}]}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "R"}], " ", 
      RowBox[{"ground", "[", "2", "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AccCOM", "[", "a", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "R"}], " ", 
    RowBox[{
     RowBox[{"u", "[", "1", "]"}], "'"}], " ", 
    RowBox[{"ground", "[", "1", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"b", ",", "a", ",", "Slider", ",", 
    RowBox[{"TAxis", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"a", "[", "1", "]"}]}]}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"C", "-", "R"}], ")"}]}], " ", 
      RowBox[{"a", "[", "1", "]"}]}]}], ",", 
    RowBox[{"InbToJnt", "\[Rule]", 
     RowBox[{"0", " ", 
      RowBox[{"a", "[", "1", "]"}]}]}], ",", 
    RowBox[{"Inertia", "->", "0"}], ",", 
    RowBox[{"Mass", "\[Rule]", "m"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"p", ",", "b", ",", "Fixed", ",", 
    RowBox[{"Mass", "\[Rule]", "M"}], ",", 
    RowBox[{"InbToJnt", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"L", "-", "C"}], ")"}], " ", 
      RowBox[{"b", "[", "1", "]"}]}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"c", ",", " ", "p", ",", " ", "Hinge", ",", 
    RowBox[{"RelativeTo", "\[Rule]", "ground"}], ",", 
    RowBox[{"QOffset", "\[Rule]", 
     RowBox[{"Pi", "/", "2"}]}], ",", 
    RowBox[{"Axis", "->", 
     RowBox[{"ground", "[", "3", "]"}]}], ",", 
    RowBox[{"BodyToJnt", "->", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"L", "-", "C"}], ")"}]}], 
      RowBox[{"c", "[", "1", "]"}]}]}], ",", 
    RowBox[{"InbToJnt", "->", "0"}], ",", 
    RowBox[{"Inertia", "->", "0"}], ",", 
    RowBox[{"Mass", "->", "m"}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"b", ",", 
    RowBox[{"m", " ", "grav"}], ",", "0"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"p", ",", 
    RowBox[{"M", " ", "grav"}], ",", "0"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"c", ",", 
    RowBox[{"m", " ", "grav"}], ",", "0"}], "]"}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"b", ",", 
    RowBox[{"K", "  ", "M", " ", 
     RowBox[{"g", "/", "L"}], " ", 
     RowBox[{"q", "[", "2", "]"}], " ", 
     RowBox[{"a", "[", "1", "]"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "C"}], "+", 
       RowBox[{"0", " ", 
        RowBox[{"q", "[", "2", "]"}]}]}], ")"}], " ", 
     RowBox[{"a", "[", "1", "]"}]}]}], "]"}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"b", ",", 
    RowBox[{
     RowBox[{"-", "\[Kappa]"}], " ", "m", " ", "g", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], "-", " ", 
       RowBox[{"q", "[", "3", "]"}]}], ")"}], " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"c", ",", 
    RowBox[{"\[Kappa]", " ", "m", " ", "g", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], "-", 
       RowBox[{"q", "[", "3", "]"}]}], ")"}], " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"grav", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
       RowBox[{"ground", "[", "2", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Gamma]", "]"}], 
       RowBox[{"ground", "[", "1", "]"}]}]}], ")"}], "g"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mass", ",", "other"}], "}"}], "=", 
   RowBox[{"MassMatrix", "[", 
    RowBox[{"EOM", "[", "]"}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eom", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"EOM", "[", "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"g", " ", "m", " ", 
      RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R", "-", 
        SubscriptBox["q", "2"]}], ")"}]}], "+", 
     RowBox[{"g", " ", "M", " ", 
      RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R", "-", 
        SubscriptBox["q", "2"]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "m", " ", 
         RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"C", "-", "R", "-", 
           SubscriptBox["q", "2"]}], ")"}]}], "+", 
        FractionBox[
         RowBox[{"g", " ", "K", " ", "M", " ", "R", " ", 
          SubscriptBox["q", "2"]}], "L"]}], ")"}]}], "+", 
     RowBox[{"g", " ", "m", " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "R"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "C"}], "+", "R"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "1"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "1"], "]"}], " ", 
         SubscriptBox["q", "2"]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "m"}], "+", 
        RowBox[{"L", " ", "m"}], "+", 
        RowBox[{"L", " ", "M"}], "-", 
        RowBox[{"2", " ", "m", " ", "R"}], "-", 
        RowBox[{"M", " ", "R"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "1"], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "3"]}], "]"}]}], "+", 
        RowBox[{"R", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["q", "3"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "3"]}], "]"}], " ", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["u", "3", "2"]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"R", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"C", " ", "m"}], "+", 
           RowBox[{"L", " ", "m"}], "+", 
           RowBox[{"L", " ", "M"}], "-", 
           RowBox[{"2", " ", "m", " ", "R"}], "-", 
           RowBox[{"M", " ", "R"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
            SubscriptBox["q", "2"]}]}], ")"}], " ", 
         SubsuperscriptBox["u", "1", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R", " ", 
         SubsuperscriptBox["u", "2", "\[Prime]",
          MultilineFunction->None]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "C"}], "+", "L"}], ")"}], " ", "m", " ", "R", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "3"], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "3"]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"L", "-", "R", "-", 
           SubscriptBox["q", "2"]}], ")"}]}]}], ")"}], " ", 
      SubsuperscriptBox["u", "3", "\[Prime]",
       MultilineFunction->None]}]}], "==", 
    RowBox[{
     RowBox[{"g", " ", "m", " ", "R", " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{"g", " ", "M", " ", "R", " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{"g", " ", "m", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R", "-", 
        SubscriptBox["q", "2"]}], ")"}]}], "+", 
     RowBox[{"g", " ", "M", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R", "-", 
        SubscriptBox["q", "2"]}], ")"}]}], "+", 
     RowBox[{"g", " ", "m", " ", "\[Kappa]", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["C", "2"], " ", "m"}], "+", 
        RowBox[{
         SuperscriptBox["L", "2"], " ", "m"}], "+", 
        RowBox[{
         SuperscriptBox["L", "2"], " ", "M"}], "-", 
        RowBox[{"2", " ", "C", " ", "m", " ", "R"}], "-", 
        RowBox[{"2", " ", "L", " ", "m", " ", "R"}], "-", 
        RowBox[{"2", " ", "L", " ", "M", " ", "R"}], "+", 
        RowBox[{"4", " ", "m", " ", 
         SuperscriptBox["R", "2"]}], "+", 
        RowBox[{"2", " ", "M", " ", 
         SuperscriptBox["R", "2"]}], "+", 
        RowBox[{"2", " ", "R", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"C", " ", "m"}], "+", 
           RowBox[{"L", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R"}]}], ")"}],
          " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "1"], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"C", " ", "m"}], "+", 
           RowBox[{"L", " ", "m"}], "+", 
           RowBox[{"L", " ", "M"}], "-", 
           RowBox[{"2", " ", "m", " ", "R"}], "-", 
           RowBox[{"M", " ", "R"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R", " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
         SubscriptBox["q", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
         SubsuperscriptBox["q", "2", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["u", "1", "\[Prime]",
       MultilineFunction->None]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "g", " ", "m", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Gamma]", "-", 
        SubscriptBox["q", "1"]}], "]"}]}], "+", 
     RowBox[{"g", " ", "M", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Gamma]", "-", 
        SubscriptBox["q", "1"]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "C"}], "+", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      SubsuperscriptBox["u", "3", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      SubsuperscriptBox["u", "1", "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      SubsuperscriptBox["u", "3", "\[Prime]",
       MultilineFunction->None]}]}], "==", 
    RowBox[{
     FractionBox[
      RowBox[{"g", " ", "K", " ", "M", " ", 
       SubscriptBox["q", "2"]}], "L"], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "m"}], "+", 
        RowBox[{"L", " ", "m"}], "+", 
        RowBox[{"L", " ", "M"}], "-", 
        RowBox[{"2", " ", "m", " ", "R"}], "-", 
        RowBox[{"M", " ", "R"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["u", "1", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
      SubsuperscriptBox["u", "2", "\[Prime]",
       MultilineFunction->None]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"g", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "C"}], "+", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Gamma]", "-", 
        SubscriptBox["q", "3"]}], "]"}]}], "+", 
     RowBox[{"g", " ", "m", " ", "\[Kappa]", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "C"}], "+", "L"}], ")"}], " ", "m", " ", "R", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "3"], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "3"]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"L", "-", "R", "-", 
           SubscriptBox["q", "2"]}], ")"}]}]}], ")"}], " ", 
      SubsuperscriptBox["u", "1", "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"L", "-", "R", "-", 
           SubscriptBox["q", "2"]}], ")"}], " ", 
         SubsuperscriptBox["u", "1", "2"]}], "+", 
        SubsuperscriptBox["u", "2", "\[Prime]",
         MultilineFunction->None]}], ")"}]}]}], "==", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], "2"], " ", "m", " ", 
     SubsuperscriptBox["u", "3", "\[Prime]",
      MultilineFunction->None]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Clean up the equations of motion", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eom2", "=", 
   RowBox[{
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"eom", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"L", "\[Rule]", "1"}], ",", 
          RowBox[{"C", "\[Rule]", "0"}], ",", 
          RowBox[{"R", "\[Rule]", "0"}], ",", 
          RowBox[{"m", "->", 
           RowBox[{"\[Beta]", " ", "M"}]}], ",", 
          RowBox[{"g", "\[Rule]", "1"}]}], "}"}]}], ")"}], "/", "M"}], "]"}], 
    " ", "//", "Simplify"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eom2", "=", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Expand", "[", "#", "]"}], ",", "Equal"}], "]"}], "&"}], ",", 
     "eom2"}], "]"}], "//", "FullSimplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "\[Beta]", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SubscriptBox["u", "1"], " ", 
        SubscriptBox["u", "2"]}]}], ")"}]}], "==", 
    RowBox[{
     FractionBox["1", "M"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"M", " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["q", "2"]}], ")"}]}], "+", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["q", "2"]}], ")"}]}], "+", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubscriptBox["q", "2"]}], "+", 
       RowBox[{"M", " ", "\[Beta]", " ", "\[Kappa]", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], ")"}]}], "+", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["q", "2"]}], ")"}], " ", 
        SubsuperscriptBox["u", "3", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "+", 
          RowBox[{"M", " ", "\[Beta]"}], "-", 
          RowBox[{"2", " ", "M", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
           SubscriptBox["q", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"M", "+", 
             RowBox[{"2", " ", "M", " ", "\[Beta]"}]}], ")"}], " ", 
           SubsuperscriptBox["q", "2", "2"]}]}], ")"}], " ", 
        SubsuperscriptBox["u", "1", "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["q", "2"]}], ")"}], " ", 
        SubsuperscriptBox["u", "3", "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Gamma]", "-", 
        SubscriptBox["q", "1"]}], "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      SubsuperscriptBox["u", "3", "2"]}]}], "==", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
      SubsuperscriptBox["u", "1", "2"]}], "+", 
     RowBox[{
      SubscriptBox["q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"K", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
         SubsuperscriptBox["u", "1", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
      SubsuperscriptBox["u", "2", "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      SubsuperscriptBox["u", "3", "\[Prime]",
       MultilineFunction->None]}]}]}], ",", 
   RowBox[{
    RowBox[{"\[Beta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Gamma]", "-", 
         SubscriptBox["q", "3"]}], "]"}], "+", 
       RowBox[{"\[Kappa]", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], "]"}], " ", 
        SubscriptBox["u", "1"], " ", 
        SubscriptBox["u", "2"]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["q", "2"]}], ")"}], " ", 
        SubsuperscriptBox["u", "1", "\[Prime]",
         MultilineFunction->None]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["q", "2"]}], ")"}]}], " ", 
           SubsuperscriptBox["u", "1", "2"]}], "+", 
          SubsuperscriptBox["u", "2", "\[Prime]",
           MultilineFunction->None]}], ")"}]}]}], ")"}]}], "==", 
    RowBox[{"\[Beta]", " ", 
     SubsuperscriptBox["u", "3", "\[Prime]",
      MultilineFunction->None]}]}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Clean up the mass matrix", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mass2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"mass", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"L", "\[Rule]", "1"}], ",", 
        RowBox[{"C", "\[Rule]", "0"}], ",", 
        RowBox[{"R", "\[Rule]", "0"}], ",", 
        RowBox[{"m", "->", 
         RowBox[{"\[Beta]", " ", "M"}]}], ",", 
        RowBox[{"g", "\[Rule]", "1"}]}], "}"}]}], ")"}], "/", "M"}], " ", "//",
    "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", "\[Beta]", "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
       SubscriptBox["q", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
       SubsuperscriptBox["q", "2", "2"]}]}], ",", "0", ",", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["q", "2"]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "\[Beta]"}]}], ",", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["q", "2"]}], ")"}]}], ",", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}], ",", "\[Beta]"}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"other2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"other", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"L", "\[Rule]", "1"}], ",", 
        RowBox[{"C", "\[Rule]", "0"}], ",", 
        RowBox[{"R", "\[Rule]", "0"}], ",", 
        RowBox[{"m", "->", 
         RowBox[{"\[Beta]", " ", "M"}]}], ",", 
        RowBox[{"g", "\[Rule]", "1"}]}], "}"}]}], ")"}], "/", "M"}], " ", "//",
    "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "1"]}], "]"}]}], "-", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "1"]}], "]"}]}], "-", 
    RowBox[{"\[Beta]", " ", "\[Kappa]", " ", 
     SubscriptBox["q", "1"]}], "+", 
    RowBox[{"\[Beta]", " ", "\[Kappa]", " ", 
     SubscriptBox["q", "3"]}], "+", 
    RowBox[{"2", " ", 
     SubscriptBox["u", "1"], " ", 
     SubscriptBox["u", "2"]}], "+", 
    RowBox[{"2", " ", "\[Beta]", " ", 
     SubscriptBox["u", "1"], " ", 
     SubscriptBox["u", "2"]}], "+", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["q", "1"], "-", 
       SubscriptBox["q", "3"]}], "]"}], " ", 
     SubsuperscriptBox["u", "3", "2"]}], "+", 
    RowBox[{
     SubscriptBox["q", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          SubscriptBox["q", "1"]}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
        SubscriptBox["u", "1"], " ", 
        SubscriptBox["u", "2"]}], "-", 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], "]"}], " ", 
        SubsuperscriptBox["u", "3", "2"]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Gamma]", "-", 
      SubscriptBox["q", "1"]}], "]"}], "+", 
    RowBox[{"2", " ", "\[Beta]", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "1"]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
     SubsuperscriptBox["u", "1", "2"]}], "+", 
    RowBox[{
     SubscriptBox["q", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "K"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
        SubsuperscriptBox["u", "1", "2"]}]}], ")"}]}], "+", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["q", "1"], "-", 
       SubscriptBox["q", "3"]}], "]"}], " ", 
     SubsuperscriptBox["u", "3", "2"]}]}], ",", 
   RowBox[{"\[Beta]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Gamma]", "-", 
        SubscriptBox["q", "3"]}], "]"}], "+", 
      RowBox[{"\[Kappa]", " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       SubsuperscriptBox["u", "1", "2"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], "]"}], " ", 
       SubscriptBox["u", "1"], " ", 
       SubscriptBox["u", "2"]}]}], ")"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mass2", "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "+", "\[Beta]", "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
        SubscriptBox["q", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
        SubsuperscriptBox["q", "2", "2"]}]}], "0", 
      RowBox[{"\[Beta]", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["q", "2"]}], ")"}]}]},
     {"0", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "\[Beta]"}]}], 
      RowBox[{"\[Beta]", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], "]"}]}]},
     {
      RowBox[{"\[Beta]", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["q", "2"]}], ")"}]}], 
      RowBox[{"\[Beta]", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], "]"}]}], "\[Beta]"}
    }], "\[NoBreak]", ")"}],
  MatrixForm[#]& ]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"other2", "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          SubscriptBox["q", "1"]}], "]"}]}], "-", 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          SubscriptBox["q", "1"]}], "]"}]}], "-", 
       RowBox[{"\[Beta]", " ", "\[Kappa]", " ", 
        SubscriptBox["q", "1"]}], "+", 
       RowBox[{"\[Beta]", " ", "\[Kappa]", " ", 
        SubscriptBox["q", "3"]}], "+", 
       RowBox[{"2", " ", 
        SubscriptBox["u", "1"], " ", 
        SubscriptBox["u", "2"]}], "+", 
       RowBox[{"2", " ", "\[Beta]", " ", 
        SubscriptBox["u", "1"], " ", 
        SubscriptBox["u", "2"]}], "+", 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], "]"}], " ", 
        SubsuperscriptBox["u", "3", "2"]}], "+", 
       RowBox[{
        SubscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Gamma]", "-", 
             SubscriptBox["q", "1"]}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
           SubscriptBox["u", "1"], " ", 
           SubscriptBox["u", "2"]}], "-", 
          RowBox[{"\[Beta]", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "3"]}], "]"}], " ", 
           SubsuperscriptBox["u", "3", "2"]}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Gamma]", "-", 
         SubscriptBox["q", "1"]}], "]"}], "+", 
       RowBox[{"2", " ", "\[Beta]", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Gamma]", "-", 
          SubscriptBox["q", "1"]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
        SubsuperscriptBox["u", "1", "2"]}], "+", 
       RowBox[{
        SubscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "K"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
           SubsuperscriptBox["u", "1", "2"]}]}], ")"}]}], "+", 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], "]"}], " ", 
        SubsuperscriptBox["u", "3", "2"]}]}]},
     {
      RowBox[{"\[Beta]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Gamma]", "-", 
           SubscriptBox["q", "3"]}], "]"}], "+", 
         RowBox[{"\[Kappa]", " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["q", "1"], "-", 
            SubscriptBox["q", "3"]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["q", "1"], "-", 
            SubscriptBox["q", "3"]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["q", "2"]}], ")"}], " ", 
          SubsuperscriptBox["u", "1", "2"]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["q", "1"], "-", 
            SubscriptBox["q", "3"]}], "]"}], " ", 
          SubscriptBox["u", "1"], " ", 
          SubscriptBox["u", "2"]}]}], ")"}]}]}
    }], "\[NoBreak]", ")"}],
  MatrixForm[{-Sin[\[Gamma] - qt[1][t]] - \[Beta] 
    Sin[\[Gamma] - qt[1][t]] - \[Beta] \[Kappa] 
    qt[1][t] + \[Beta] \[Kappa] qt[3][t] + 2 ut[1][t] ut[2][t] + 
    2 \[Beta] ut[1][t] ut[2][t] + \[Beta] Sin[qt[1][t] - qt[3][t]] ut[3][t]^2 + 
    qt[2][t] ((1 + 2 \[Beta]) Sin[\[Gamma] - qt[1][t]] - 2 (1 + 2 \[Beta]) 
      ut[1][t] ut[2][t] - \[Beta] Sin[qt[1][t] - qt[3][t]] ut[3][t]^2), 
    Cos[\[Gamma] - qt[1][t]] + 
    2 \[Beta] Cos[\[Gamma] - qt[1][t]] - (1 + \[Beta]) ut[1][t]^2 + 
    qt[2][t] (-K + (1 + 2 \[Beta]) ut[1][t]^2) + \[Beta] 
     Cos[qt[1][t] - qt[3][t]] ut[3][t]^2, \[Beta] (
     Sin[\[Gamma] - qt[3][t]] + \[Kappa] (qt[1][t] - qt[3][t]) + 
     Sin[qt[1][t] - qt[3][t]] (-1 + qt[2][t]) ut[1][t]^2 - 2 
     Cos[qt[1][t] - qt[3][t]] ut[1][t] ut[2][t])}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mass2", "/.", 
   RowBox[{"\[Beta]", "\[Rule]", "0"}]}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       RowBox[{"2", " ", 
        SubscriptBox["q", "2"]}], "+", 
       SubsuperscriptBox["q", "2", "2"]}], "0", "0"},
     {"0", "1", "0"},
     {"0", "0", "0"}
    }], "\[NoBreak]", ")"}],
  MatrixForm[#]& ]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"other2", "/.", 
  RowBox[{"\[Beta]", "\[Rule]", "0"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "1"]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SubscriptBox["u", "1"], " ", 
     SubscriptBox["u", "2"]}], "+", 
    RowBox[{
     SubscriptBox["q", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Gamma]", "-", 
         SubscriptBox["q", "1"]}], "]"}], "-", 
       RowBox[{"2", " ", 
        SubscriptBox["u", "1"], " ", 
        SubscriptBox["u", "2"]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Gamma]", "-", 
      SubscriptBox["q", "1"]}], "]"}], "-", 
    SubsuperscriptBox["u", "1", "2"], "+", 
    RowBox[{
     SubscriptBox["q", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "K"}], "+", 
       SubsuperscriptBox["u", "1", "2"]}], ")"}]}]}], ",", "0"}], 
  "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Momentum Equations After Heel strike", "Subsubsection"],

Cell["Locate center of mass relative to contact point", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PosCOM", "[", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "p"}], "}"}], "]"}], " ", "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "C"}], "+", "L"}], ")"}], " ", "m"}], ")"}], " ", 
     SubscriptBox[
      UnderscriptBox["c", "_"], "1"]}], 
    RowBox[{
     RowBox[{"2", " ", "m"}], "+", "M"}]],
   HoldForm], "+", 
  TagBox[
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"C", "-", "L"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M"}], ")"}]}], ")"}], " ", 
      SubscriptBox[
       UnderscriptBox["b", "_"], "1"]}], 
     RowBox[{
      RowBox[{"2", " ", "m"}], "+", "M"}]]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{"R", " ", 
    SubscriptBox[
     UnderscriptBox["ground", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"C", "-", "R", "-", 
      SubscriptBox["q", "2"]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "1"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell["Locate pelvis with respect to center of mass", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PosCOM", "[", "p", "]"}], "-", 
   RowBox[{"PosCOM", "[", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "p"}], "}"}], "]"}]}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"C", "-", "L"}], ")"}], " ", "m"}], ")"}], " ", 
     SubscriptBox[
      UnderscriptBox["c", "_"], "1"]}], 
    RowBox[{
     RowBox[{"2", " ", "m"}], "+", "M"}]],
   HoldForm], "+", 
  TagBox[
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "C"}], "+", "L"}], ")"}], " ", "m"}], ")"}], " ", 
     SubscriptBox[
      UnderscriptBox["b", "_"], "1"]}], 
    RowBox[{
     RowBox[{"2", " ", "m"}], "+", "M"}]],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell["\<\
Find center of mass velocity, useful for launching aerial phase\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vp", "=", 
  RowBox[{"CastV", "[", 
   RowBox[{
    RowBox[{"VelCOM", "[", "p", "]"}], ",", "ground"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{"L", "-", "R", "-", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       SubscriptBox["u", "1"]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "1"], "]"}], " ", 
       SubscriptBox["u", "2"]}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["ground", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "R"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["q", "1"], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["q", "1"], "]"}], " ", 
          SubscriptBox["q", "2"]}]}], ")"}], " ", 
       SubscriptBox["u", "1"]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "1"], "]"}], " ", 
       SubscriptBox["u", "2"]}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["ground", "_"], "1"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"vp", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"L", "\[Rule]", "1"}], ",", 
     RowBox[{"R", "\[Rule]", "0"}]}], "}"}]}], "/.", "subs"}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"1", "-", "q2"}], ")"}]}], " ", "s1", " ", "u1"}], "-", 
      RowBox[{"c1", " ", "u2"}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["ground", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "c1"}], "+", 
         RowBox[{"c1", " ", "q2"}]}], ")"}], " ", "u1"}], "+", 
      RowBox[{"s1", " ", "u2"}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["ground", "_"], "1"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pp", " ", "=", " ", 
  RowBox[{"CastV", "[", 
   RowBox[{
    RowBox[{"PosCOM", "[", "p", "]"}], ",", "ground"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "R", "+", 
        SubscriptBox["q", "2"]}], ")"}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["ground", "_"], "1"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"R", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"L", "-", "R"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "1"], "]"}]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "1"], "]"}], " ", 
       SubscriptBox["q", "2"]}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["ground", "_"], "2"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"pp", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"L", "\[Rule]", "1"}], ",", 
     RowBox[{"R", "\[Rule]", "0"}]}], "}"}]}], "/.", "subs"}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      RowBox[{"c1", " ", "q2"}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["ground", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q2"}], ")"}], " ", "s1"}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["ground", "_"], "1"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell["\<\
Angular momentum of whole machine about the current contact point\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ama1", " ", "=", " ", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Expand", "[", 
      RowBox[{
       RowBox[{"AngMom", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "p"}], "}"}], ",", "0"}], 
        "]"}], ".", 
       RowBox[{"ground", "[", "3", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}], ",", 
       RowBox[{"u", "[", "3", "]"}]}], "}"}]}], "]"}], " ", "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["C", "2"], " ", "m"}], "+", 
     RowBox[{
      SuperscriptBox["L", "2"], " ", "m"}], "+", 
     RowBox[{
      SuperscriptBox["L", "2"], " ", "M"}], "-", 
     RowBox[{"2", " ", "C", " ", "m", " ", "R"}], "-", 
     RowBox[{"2", " ", "L", " ", "m", " ", "R"}], "-", 
     RowBox[{"2", " ", "L", " ", "M", " ", "R"}], "+", 
     RowBox[{"4", " ", "m", " ", 
      SuperscriptBox["R", "2"]}], "+", 
     RowBox[{"2", " ", "M", " ", 
      SuperscriptBox["R", "2"]}], "+", 
     RowBox[{"2", " ", "R", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "m"}], "+", 
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R"}]}], ")"}], 
      " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"C", " ", "L", " ", "m", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["L", "2"], " ", "m", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}], "-", 
     RowBox[{"C", " ", "m", " ", "R", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}], "+", 
     RowBox[{"L", " ", "m", " ", "R", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}], "+", 
     RowBox[{"C", " ", "m", " ", "R", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "3"], "]"}]}], "-", 
     RowBox[{"L", " ", "m", " ", "R", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "3"], "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"C", " ", "m"}], "+", 
           RowBox[{"L", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R"}]}], 
          ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "1"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "3"]}], "]"}]}]}], ")"}], " ", 
      SubscriptBox["q", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
      SubsuperscriptBox["q", "2", "2"]}]}], ")"}], " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
   RowBox[{"(", 
    RowBox[{"C", "-", "L", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}], "+", 
     RowBox[{"R", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "3"], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      SubscriptBox["q", "2"]}]}], ")"}], " ", 
   SubscriptBox["u", "3"]}]}]], "Output"]
}, Open  ]],

Cell["Angular momentum of trailing leg about the hip", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ama2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"AngMom", "[", 
     RowBox[{"c", ",", 
      RowBox[{"PosCOM", "[", "p", "]"}]}], "]"}], ".", 
    RowBox[{"ground", "[", "3", "]"}]}], " ", "//", "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], "]"}]}], "+", 
       RowBox[{"R", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], "]"}], " ", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     SubscriptBox["u", "1"]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["q", "1"], "-", 
       SubscriptBox["q", "3"]}], "]"}], " ", 
     SubscriptBox["u", "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"C", "-", "L"}], ")"}], " ", 
     SubscriptBox["u", "3"]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell["\<\
Linear momentum of whole machine except forward foot, along leading leg axis\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ama3", " ", "=", " ", 
  RowBox[{
   RowBox[{"LinMom", "[", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "p"}], "}"}], "]"}], ".", 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"a", "[", "1", "]"}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "m"}], "+", "M"}], ")"}]}], " ", "R", " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "1"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
   SubscriptBox["u", "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "C"}], "+", "L"}], ")"}], " ", "m", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "3"]}], "]"}], " ", 
   SubscriptBox["u", "3"]}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KEs", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Mass", "[", "b", "]"}], " ", 
       RowBox[{
        RowBox[{"VelCOM", "[", "b", "]"}], ".", 
        RowBox[{"VelCOM", "[", "b", "]"}]}]}], "+", 
      RowBox[{
       RowBox[{"Mass", "[", "p", "]"}], " ", 
       RowBox[{
        RowBox[{"VelCOM", "[", "p", "]"}], ".", 
        RowBox[{"VelCOM", "[", "p", "]"}]}]}], "+", 
      RowBox[{
       RowBox[{"Mass", "[", "c", "]"}], 
       RowBox[{
        RowBox[{"VelCOM", "[", "c", "]"}], ".", 
        RowBox[{"VelCOM", "[", "c", "]"}]}]}]}], ")"}]}], " ", "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["C", "2"], " ", "m"}], "+", 
       RowBox[{
        SuperscriptBox["L", "2"], " ", "m"}], "+", 
       RowBox[{
        SuperscriptBox["L", "2"], " ", "M"}], "-", 
       RowBox[{"2", " ", "C", " ", "m", " ", "R"}], "-", 
       RowBox[{"2", " ", "L", " ", "m", " ", "R"}], "-", 
       RowBox[{"2", " ", "L", " ", "M", " ", "R"}], "+", 
       RowBox[{"4", " ", "m", " ", 
        SuperscriptBox["R", "2"]}], "+", 
       RowBox[{"2", " ", "M", " ", 
        SuperscriptBox["R", "2"]}], "+", 
       RowBox[{"2", " ", "R", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"C", " ", "m"}], "+", 
          RowBox[{"L", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R"}]}], ")"}], 
        " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"C", " ", "m"}], "+", 
          RowBox[{"L", " ", "m"}], "+", 
          RowBox[{"L", " ", "M"}], "-", 
          RowBox[{"2", " ", "m", " ", "R"}], "-", 
          RowBox[{"M", " ", "R"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
        SubscriptBox["q", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
        SubsuperscriptBox["q", "2", "2"]}]}], ")"}], " ", 
     SubsuperscriptBox["u", "1", "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
     SubsuperscriptBox["u", "2", "2"]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["q", "1"], "-", 
       SubscriptBox["q", "3"]}], "]"}], " ", 
     SubscriptBox["u", "2"], " ", 
     SubscriptBox["u", "3"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], "2"], " ", "m", " ", 
     SubsuperscriptBox["u", "3", "2"]}], "-", 
    RowBox[{"2", " ", 
     SubscriptBox["u", "1"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubscriptBox["u", "2"]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "R"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "3"]}], "]"}]}], "+", 
          RowBox[{"R", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "3"], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "3"]}], "]"}], " ", 
           SubscriptBox["q", "2"]}]}], ")"}], " ", 
        SubscriptBox["u", "3"]}]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PEs", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Mass", "[", "b", "]"}]}], " ", 
     RowBox[{
      RowBox[{"PosCOM", "[", "b", "]"}], ".", "grav"}]}], "-", 
    RowBox[{
     RowBox[{"Mass", "[", "c", "]"}], " ", 
     RowBox[{
      RowBox[{"PosCOM", "[", "c", "]"}], ".", "grav"}]}], "-", 
    RowBox[{
     RowBox[{"Mass", "[", "p", "]"}], " ", 
     RowBox[{
      RowBox[{"PosCOM", "[", "p", "]"}], ".", "grav"}]}]}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"g", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R", " ", 
     RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "+", 
    RowBox[{"C", " ", "m", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "1"]}], "]"}]}], "+", 
    RowBox[{"L", " ", "m", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "1"]}], "]"}]}], "+", 
    RowBox[{"L", " ", "M", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "1"]}], "]"}]}], "-", 
    RowBox[{"2", " ", "m", " ", "R", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "1"]}], "]"}]}], "-", 
    RowBox[{"M", " ", "R", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "1"]}], "]"}]}], "+", 
    RowBox[{"C", " ", "m", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "3"]}], "]"}]}], "-", 
    RowBox[{"L", " ", "m", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "3"]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "1"]}], "]"}], " ", 
     SubscriptBox["q", "2"]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"GInerFrc", "[", "p", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"m", "\[Rule]", 
     RowBox[{"\[Beta]", " ", "M"}]}], ",", 
    RowBox[{"M", "\[Rule]", "1"}], ",", 
    RowBox[{"R", "\[Rule]", "0"}], ",", 
    RowBox[{"C", "\[Rule]", "0"}], ",", 
    RowBox[{"L", "\[Rule]", "1"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "-", 
       RowBox[{"2", " ", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     SubscriptBox["u", "1"], " ", 
     SubscriptBox["u", "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", 
        SubscriptBox["q", "2"]}], "-", 
       SubsuperscriptBox["q", "2", "2"]}], ")"}], " ", 
     SubsuperscriptBox["u", "1", "\[Prime]",
      MultilineFunction->None]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     SubsuperscriptBox["u", "1", "2"]}], "-", 
    SubsuperscriptBox["u", "2", "\[Prime]",
     MultilineFunction->None]}], ",", "0"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AccCOM", "[", "p", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"m", "\[Rule]", 
     RowBox[{"\[Beta]", " ", "M"}]}], ",", 
    RowBox[{"M", "\[Rule]", "1"}], ",", 
    RowBox[{"R", "\[Rule]", "0"}], ",", 
    RowBox[{"C", "\[Rule]", "0"}], ",", 
    RowBox[{"L", "\[Rule]", "1"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    RowBox[{"-", 
     SubsuperscriptBox["u", "1", "2"]}], " ", 
    SubscriptBox[
     UnderscriptBox["b", "_"], "1"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    SubsuperscriptBox["u", "1", "\[Prime]",
     MultilineFunction->None], " ", 
    SubscriptBox[
     UnderscriptBox["b", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["u", "1"], " ", 
       SubscriptBox["u", "2"]}], "-", 
      RowBox[{
       SubscriptBox["q", "2"], " ", 
       SubsuperscriptBox["u", "1", "\[Prime]",
        MultilineFunction->None]}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "2"], " ", 
       SubsuperscriptBox["u", "1", "2"]}], "-", 
      SubsuperscriptBox["u", "2", "\[Prime]",
       MultilineFunction->None]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "1"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"VelCOM", "[", "p", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"m", "\[Rule]", 
     RowBox[{"\[Beta]", " ", "M"}]}], ",", 
    RowBox[{"M", "\[Rule]", "1"}], ",", 
    RowBox[{"R", "\[Rule]", "0"}], ",", 
    RowBox[{"C", "\[Rule]", "0"}], ",", 
    RowBox[{"L", "\[Rule]", "1"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    SubscriptBox["u", "1"], " ", 
    SubscriptBox[
     UnderscriptBox["b", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["q", "2"]}], " ", 
      SubscriptBox["u", "1"]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["u", "2"]}], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "1"]}],
   HoldForm]}]], "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Aerial Phase Equations of motion", "Subsection"],

Cell[BoxData[Cell[GraphicsData["Metafile", "\<\
CF5dJ6E]HGAYHf4PEfU^I6mgLb15CDHPAVmbKF5d0@0002Vh0@0009@0000000000@000;80003E0000
00000000001_4P00<QH00215CDH00040^2T00:41000900007P0005P00000000000@00003000>0@00
b`0004<0H@1^07H0H@1c0200=@0^0300001506h0J01Q06h0H`1U06@0801=06D0M01Q06H0J@1/06D0
00000140000<0000200000X0000@00000000000000090000400002l2002O0P003000010000000000
000000/0000@0000/`000=L0000V0000700000400006000010000000000000009@0000`000010000
9@0000`000050020E`0002@0001N0000300007h0002:00000P0002@19P2:0K019P0001`000020000
1P0000@000000000000002D0000<00000P0002P0000<00000@0002D0000<00000P0002D0000<0000
1@00P5L0000T0000NP0008/000210000Y`000080001m0K<1T`4:0RH0000L00000@0000H000040000
00000000000U000030000040000X000030000080000U000030000040000U0000300000D0081G0000
900008<000290000RP000:D000020000V06/0Jh10`8V000070000080000600001000000000000000
9@0000`000020000:00000`0000100009@0000`0000200009@0000`000050020E`0002@0001j0000
RP000880002<00000P0007d1]06G0Jh19P0001`0000100001P0000@000000000000002D0000<0000
0@0002P0000<00000P0002D0000<00000@0002D0000<00001@00P5L0000T0000P@0009D0002=0000
a0000080002C0M81^@5U0RH0000L00000P0000H00002000000000000000U000030000080000X0000
30000040000U000030000080000U0000300000D0081G0000900007X0000k0000Q@0006@000020000
O@6g09h1>04U000030000000080=00004000004000070000600000`000082`h09@0000`000080020
9`0001P000010000000000P;3P0000009@0000`000010000EP0006P000200000GP0008H0001Y0000
4`000:@19@6T0BD1Y04U0J<1B@6S0DT1XP580J01A@6N0D41V`4l0IL1=`6D0C81TP4]0I01:P6@0BX1
U@4]0I/1;06K0B`1X@4Z0J@19@4U0000300000D0080X000030000040000F0000300001P0000F0000
300001T0000B000030000040000U0000300000D0080=00004000004000070000600000`000000000
500000`0000900005P0000`0000H00006`000100002[0@00o@0002D0000<00001000P580001<0@00
0@000<koool000003Ogoo`gmoonl0P00000000000@1306l0M@1b06T0I@1b0200CP1U07L000000000
00000000003AE=5DCP[6d@00000000000000000000000000002JCTh:am4000000000000000000000
00000;J;]X]>2/SA0000000000000000000000000009UPVFCP[;d@00000000000000000000000000
d7K@MTh:c]4000000000000000000000000002E>9Di>2/oA000000000000000000000000002LV9bH
CP[Ed@000000000000000000000000003YH>UTh:e]40000000000000000000000000000000000000
00000000000000000@410@410@410HaC9@0000`000010000E00005@000260000B00008l0001I0000
0@0002lG1d63PPM1X`400>0000010000C0000000000000000000000000000000D00006<0000O0000
5P0000`0000I00003@000100000100001`0001H0000<0000600001/0000@0000X@4001L1000U0000
300000@0081B0000C04000<0003Koooo000000gmool=oOooT040000000000040@`1_07D0LP1Y06D0
LP0P04h0I@1g0000000000000000000000000000002QMJ5eCP[ad@00000000000000000000000000
<iHcUTh:m=4000000000000000000000000002M/9fa>2_GA000000000000000000000000001kDG]A
CP[hd@00000000000000000000000000=fPgJ4h:nM4000000000000000000000000003V9>HU>2T7B
000000000000000000000000000jRCZ9CPY2dP00000000000000000000000000?8TlRDh:A=800000
00000000000000000000000000000000000000410@410@410@4002D0000<00000`0005@0001D0000
Q0000580002:0000G`000040000_5`M1Ph87@I/100010@000@0004`0000000000000000000000000
00000500000a04:95P0001H0000<00006@000180000<00000P0002H0000L0000100000H000040000
00000000000U0000300000@0000X000030000080000D0000300000d0000U0000300000@0000U0000
300000D0081G00009000000000350000/P000<D000020000001V0R`2IP8V00007000008000060000
10000000000000009@0000`000020000:00000`0000400009@0000`0000200009@0000`000050020
E`0002@000030000a@0000T0003E00000P0001d0IP8:09X29P0001`0000400001P0000@000000000
000002D0000<0000100002P0000<00000P0002D0000<0000100002D0000<00001@00P5L0000T0000
30000<D0000B0000e@000080000h06H29@2J0RH0000L00000P0000H00004000000000000000U0000
30000080000X0000300000@0000U000030000080000U0000300000D0081G0000900001D000350000
6`000=D000020000D`1V0T40VP8V0000700000@00006000010000000000000009@0000`000040000
:00000`0000200009@0000`0000400009@0000`000050020E`0002@0000M0000a@0002<0003E0000
0P0006h0IP9L09X29P0001`0000200001P0000@000000000000002D0000<00000P0002P0000<0000
100002D0000<00000P0002D0000<00001@00P5L0000T00009P000<D0000/0000e@000080002906H2
M`2J0RH0000L0000100000H00004000000000000000U0000300000@0000X000030000080000U0000
300000@0000U0000300000D0081G0000900002l000350000=@000=D000020000Y@1V0Y80VP8V0000
700000800006000010000000000000009@0000`000020000:00000`0000400009@0000`000020000
9@0000`000050020E`0002@0000g0000a@0003d0003E00000P000<00IP:]09X29P0001`000040000
1P0000@000000000000002D0000<0000100002P0000<00000P0002D0000<0000100002D0000<0000
1@00P5L0000T0000@0000<D000160000e@000080003K06H2b02J0RH0000L00000P0000H000040000
00000000000U000030000080000X0000300000@0000U000030000080000U0000300000D0081G0000
900004T000350000C`000=D000020000mP1V0^<0VP8V0000700000@0000600001000000000000000
9@0000`000040000:00000`0000200009@0000`0000400009@0000`000050020E`0002@0001A0000
a@0005L0003E00000P000141IP;n09X29P0001`0000200001P0000@000000000000002D0000<0000
0P0002P0000<0000100002D0000<00000P0002D0000<00001@00P5L0000T0000FP000<D0001P0000
e@000080000/0FH26@6J0RH0000L0000100000H00004000000000000000U0000300000@0000X0000
30000080000U0000300000@0000U0000300000D0081G0000900006<000350000J@000=D000020000
A`5V0S@1VP8V0000700000800006000010000000000000009@0000`000020000:00000`000040000
9@0000`0000200009@0000`000050020E`0002@0001[0000a@000740003E00000P000681IP9?0IX2
9P0001`0000400001P0000@000000000000002D0000<0000100002P0000<00000P0002D0000<0000
100002D0000<00001@00P5L0000T0000M0000<D0001j0000e@000080001m0FH2JP6J0RH0000L0000
0P0000H00004000000000000000U000030000080000X0000300000@0000U000030000080000U0000
300000D0081G0000900007d000350000P`000=D000020000V05V0XH1VP8V0000700000@000060000
10000000000000009@0000`000040000:00000`0000200009@0000`0000400009@0000`000050020
E`0002@000260000a@0008/0003E00000P000;<1IP:Q0IX29P0001`0000200001P0000@000000000
000002D0000<00000P0002P0000<0000100002D0000<00000P0002D0000<00001@00P5L0000T0000
SP000<D0002D0000e@000080003>0FH2_06J0RH0000L0000100000H00004000000000000000U0000
300000@0000X000030000080000U0000300000@0000U0000300000D0081G0000900009L000350000
W@000=D000020000jP5V0]L1VP8V0000700000800006000010000000000000009@0000`000020000
:00000`0000400009@0000`0000200009@0000`000050020E`0002@0002O0000a@000:H0003E0000
0P0000D2IP;b0IX29P0001`0000400001P0000@000000000000002D0000<0000100002P0000<0000
0P0002D0000<0000100002D0000<00001@00P5L0000T0000Z0000<D0002^0000e@000080000P0VH2
3@:J0RH0000L00000P0000H00004000000000000000U000030000080000X0000300000@0000U0000
30000080000U0000300000D0081G0000900003<0000=0000GP0008P000020000904Z0:00ZP4V0000
700000@00006000010000000000000009@0000`000040000:00000`0000200009@0000`000040000
9@0000`000050020E`0002@0000V0000Q`0002l0002R00000P0009<0YP5f0?/19P0001`000020000
1P0000@000000000000002D0000<00000P0002P0000<0000100002D0000<00000P0002D0000<0000
1@00P5L0000T0000;P0008X0000g0000Y@000080002]0:l1T0040RH0000L0000100000H000040000
00000000000U0000300000@0000X000030000080000U0000300000@0000U0000300000D0081G0000
900002l000280000=`0008X000020000TP2W0J`0/04V000070000080000600001000000000000000
9@0000`000020000:00000`0000400009@0000`0000200009@0000`000050020E`0002@0000N0000
T`0002l0003400000P0009@0c05O06D29P0001`0000400001P00008000000000000002D0000<0000
100002P0000<00000P0002D0000<0000100002D0000<00001@00P5L0000T0000<00003l0000n0000
I`000080002G0481``3402D0000<00001000P0d0000@00000@0000L0000H0000300000P;3P0U0000
300000P0080W0000600000800000000020/>0000000U000030000080001F0000J00003T0000i0000
@00004D0000C0000/`3A0;<0d@2c0=40b02c0<P0/`380;D0b02h0<P0_@380<<0b0390<P0c`380=@0
a`3H0<L0f0340=<0_`3?0;l0c`2i0<l0/`3A02D0000<00001@00P2P0000<00000P0001H0000<0000
600001H0000<00006@000180000<00000@0002D0000<00001000P0d0000@00000@0000L0000H0000
30000000000D0000300000T0000F0000300001P0000K0000400009P0003_00009@0000`000040020
DP0004`100020000c_ooo`0000350P00a@800;`200000000000104<0K`1e0780J@1U0780801>06D0
M`000?@3000o0000m0<004l0003d0`00P0000?@3003@0000m0<000D000000000m0<00600003d0`00
T0000?@300300000m0<000@0000?0000m0<008l0003d0`00W`000?@3003_0000m0<000@00030oooo
lP<00000000000003`000<3oooob0`0000000000000?0000`?oooo83000000003`000000ooob0`00
000000l00030oooolP<00000000?0000`?oooo83000000003`000<3oooob0`00000000l000000000
00000000000000000000000000010@410@410@41oolU000030000080001D0000E00002d0001F0000
=P0006L000010000;aL7@H>21d6>00002`400040001<0000000000000000000000000000001@0000
HP0001l0000F0000300001T0000=000040000040000700005P0000`0000H00006`000100002^0000
g`0002D0000<00001000P580001<0@001@000=_oool00000a@800<D2002@0@00000000000@1306l0
M@1b06T0I@1b0200CP1U07L0003Y0`00P0000>T300030000D0000>T3001P0000j@<00700003Y0`00
00000>T3002@0000j@<00:00003Y0`00/0000>T300300000j@<00=00003Y0`002@000<3oooo`0`00
000000l0002@0000l0<00040001P0000j0<00700003X0`00P0000>P300030000D0000>P3001P0000
j0<0070000000000P0000>P3002@0000j0<00:00003X0`00/0000>P300300000j0<00=00003X0`00
2@000000000P0000000000000000000000000000000000000@410@410@410@009@0000`000050000
E00005@0000e0000CP0003/0001K00000@0002lG1d63PPM1Y`000?@000010000C000000000000000
0000000000000000D0000340000F00005P0000`0000I00004P0000`0000200003@00010000010000
1`0001P0000<0000oooo01@0000<00003@0002D0000<00002000P2D0000<00000000P5H0002/0000
C`000040001Z0000700002@0001:0C/0A`520481B@0l0Dl0=@5C02d1EP0U0EL0705G01@1E@0D0ED0
305A00D1C0000DH0o00o0?T0>03g0300m`0W0?T07`3i01l0o@0G008140080@/03`4601L10`0O0@80
9`420301100`0@@0>04803h13@140A<0B04J04/18P1<0BX0C04b04X1>`0V0000700000H000060000
10000000000000009@0000`000060000:00000`0000400009@0000`0000600009@0000`000050020
E`000:`0001?00000@0006X0000L0000900004X1>`170D80@P5903`1C`0e0E<0;@5F02D1E`0L0EL0
505E01@1E@0<0E401@5<0001AP3l03l0n@0h0?L0<03g02L0n@0O0?T07`3m01L00P4@00P12`0?0@H0
5`4301l10P0W0@80<0440301100h0@P0?P4=04@14`180AX0B`4R04`1:P1<0C80BP4k02D0000<0000
0000P0d0000@00000@0000L0000H000030000000000U0000300000P0080U0000300000@0081F0000
D00004l000090000G@0001/0000=0000505C00`1D0060D/000540?`0?@3i03H0n00]0?T09@3k01d0
n`0M02<1:`0S0B/0505C00d0000@00000@0000L0000U0000300000P0080U0000300000@0081F0000
D00005d000010000J`0001<0000=0000<@4403T11`100@`0A@4C04T16P1<0B40C@4Z04d1<P1;0CX0
B`4j02<1;00S0B`0<@4401H0000<0000600001H0000<00006@000180000<00000@0001H0000<0000
600000d0000@00000@0000L0000D0000300000T0000K000040000;81003B0@009@0000`000040020
DP0004`100040000c_ooo`00000000000000090100000000000104<0K`1e0780J@1U0780801>06D0
M`000100000<0`00800000`3000`000030<00400000<0`00D00000`30000000030<00700000<0`00
P00000`3002@000030<00:00000<0`00/00000`30030000030<00=00000<0`003P00000000000000
@0000<T2000000003`0009l000380P00k`000<P2000200008000024000010000W`000000003_0000
1@000080002O000010000>l0000400000P0009l000030000k`0000<000020000W`00008000000000
00000000000000000000000000010@410@410@41000U0000300000@0001D0000E00008/0002E0000
U0000:H000010000;aL7@H>21d6b0@00dP400040001<0000000000000000000000000000001@0000
L@0001l0000F0000300001T0000F0000300001P0000=000040000040000700006`000100003@0@00
gP4002D0000<00001000P580001<0@001`000=_oool0000000000000002@0@00000000000@1306l0
M@1b06T0I@1b0200CP1U07L0001O0000g0800040003L0P00H0000040000?0000P0000=/200010000
00000=T200010000<0000=T200100000f@800080001P0000f@800700003I0P000P000800003I0P00
T0000=T200020000X0000=T2002`0000f@80008000300000f@800040000P0000f@800800003I0P00
0P00010000000000@0000=T200020000T0000=T2003@0000f@800>00003I0P000`000100003I0P00
T0000=T200020000000000000000000000000000000000000@410@410@410@009@0000`000070000
E00005@0002E0000V@0009/0002W00000@0002lG1d63PPM1d0400=h100010000C000000000000000
0000000000000000D00003@0000F00005P0000`0000I00004P0000`0000200005P0000`0000H0000
5P0000`0000I00004P0000`0000100005P0000`0000H00003@000100000100001`0001/0000@0000
A0000<`1000U0000300000@0080U0000300000@0001D0000E00001H0002C00007`000:@000010000
;aL7@H>21d540000c0400040001<0000000000000000000000000000001@0000L@0001l0000F0000
300001T0000F0000300001P0000=000040000040000700006`000100001R0000f04002D0000<0000
1000P2D0000<00001`0005@0001D00007`0009L0000U0000Y@000040000_5`M1Ph87@F80003H0@00
0@0004`000000000000000000000000000000500000b00005P0001H0000<00006@000180000<0000
0P0002H0000L0000200000H00001000000000000000U0000300000P0000X0000300000H0000D0000
300000d0000U0000300000P0000U0000300000D0081G0000900001h0002X00007P000<8000020000
G@1L0Ud03@8V0000700000H0000600000@000000000000009@0000`000060000:00000`000080000
9@0000`0000600009@0000`000050020E`0002P0000/0000[`000380002c00000`0008T08@:=02<2
V`0`0RD0000<00001000P0d0000@00000@0000L0000U0000300000P0080U0000300000@0081F0000
L00002P0002/0000;P000;00000E0000T00M0Y0070:@01`2O@0J0Wd06P9m01/2OP0L0X007@:301l2
R00S0X`09P:<02H2R`0U0XX08`:90242R@0O0XT07`::01h2S00M0Xh07@:@01d29P0001`000080000
1P00004000000000000002D0000<0000200002P0000<00001P0002D0000<0000200002D0000<0000
1@00P5L0000/00004@000:/0000I0000[P0000@0001?01L2B@0H0Sl06`8f02029@0000`000040020
3@000100000100001`0002D0000<00002000P2D0000<00001000P5H0001`000060000:T0000N0000
[@0001D0001:0102BP0@0TX0409M01D2G@0E0U`05@9J01H2F00G0UD0609?01X2BP0K0TX06`9<01X2
C@0H0Tl05`9?01H2C`0F0Tl0509=01<2B`0A0TX0408F0000300001P0000F0000300001T0000B0000
30000040000F0000300001P0000U0000300000@0080=00004000004000070000500000`000090000
6`00010000060000>`8002D0000<00001000P2D0000<0000100005@0001D00000P000;L0000;0000
b0000040000_5`M1Ph87@@H0000k0P000@0004`000000000000000000000000000000500001a0000
7`0001H0000<00006@0001H0000<0000600000d0000@00000@0000L0000K0000400002@000170P00
9@0000`0000400209@0000`000070000E00005@0000<0000^`000180003900000@0002lG1d63PPM1
900004L200010000C0000000000000000000000000000000D0000340000F00005P0000`0000I0000
4P0000`0000200009P0001`0000600001P00004000000000000002D0000<00001P0002P0000<0000
200001@0000<00003@0002D0000<00001P0002D0000<00001@00P5L000100000CP0004h0001Y0000
D00000T000170O<0AP7d03P1n00[0OX07@7k00l1nP010OL0m03c0?<0lP0U0000300000@0080=0000
40000040000700009@0000`0000800209@0000`000040020EP000700001W0000C00006d0001@0000
5@0004D1n`150O/0A@7k05@1kP1D0Nh0D`7^0541kP1?0Nh0C07_04D1l0110O40@@7a04<1lP150O80
A`7c04P1m0180O@0B07e04L1m`160OT0A@7k02D0000<00001000P0d0000@00000@0000L0000U0000
300000P0080U0000300000@0081F0000L00004X0001<0000D0000500000E0000m@3j0?D0nP3e0?X0
iP3]0>H0k@3W0>d0j@3]0>/0kP3^0>h0m@3`0?T0l@3i0?40m`3a0?D0l@3c0?80lP3c0?80l`3b0?@0
l`3f0?@0n03e0?X05P0000`0000H00005P0000`0000I00004P0000`0000100005P0000`0000H0000
9@0000`0000400203@000100000100001`0001@0000<00002@0001/0000@0000104002D1000U0000
300000@0080U0000300000@0001D0000E00005<0001N0000G00006l000010000;aL7@H>21d440@00
9@400040001<0000000000000000000000000000001@0000L@0001l0000F0000300001T0000F0000
300001P0000=000040000040000700006`000100000R0@00<@4002D0000<00001000P2D0000<0000
1`0005@0001D0000G@000680001S0000L0000040000_5`M1Ph87@B81000a0@000@0004`000000000
000000000000000000000500000c00005P0001H0000<00006@000180000<00000P0002D0000<0000
1`00P2P0000<00001P0000h0000D000000000100000D0000
\>"], "Graphics",
  GeneratedCell->False,
  CellAutoOverwrite->False,
  ImageSize->{178, 212},
  ImageMargins->{{0, 0}, {0, 0}},
  ImageRegion->{{0, 1}, {0, 1}}]], "Input",
 Evaluatable->False],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NewModel", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"p1", ",", "ground", ",", "Slider", ",", 
    RowBox[{"TAxis", "\[Rule]", 
     RowBox[{"ground", "[", "1", "]"}]}], ",", 
    RowBox[{"Qdof", "\[Rule]", "4"}], ",", 
    RowBox[{"Udof", "\[Rule]", "4"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"p", ",", "p1", ",", "Slider", ",", 
    RowBox[{"TAxis", "\[Rule]", 
     RowBox[{"ground", "[", "2", "]"}]}], ",", 
    RowBox[{"Qdof", "\[Rule]", "5"}], ",", 
    RowBox[{"Udof", "\[Rule]", "5"}], ",", 
    RowBox[{"Mass", "\[Rule]", "M"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"b", ",", "p", ",", "Hinge", ",", 
    RowBox[{"QOffset", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "Pi"}], "/", "2"}]}], ",", 
    RowBox[{"InbToJnt", "\[Rule]", "0"}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"L", "-", "C"}], ")"}], " ", 
      RowBox[{"b", "[", "1", "]"}]}]}], ",", 
    RowBox[{"Mass", "\[Rule]", "m"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"c", ",", "p", ",", "Hinge", ",", 
    RowBox[{"QOffset", "\[Rule]", 
     RowBox[{"Pi", "/", "2"}]}], ",", 
    RowBox[{"InbToJnt", "\[Rule]", "0"}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"L", "-", "C"}], ")"}]}], " ", 
      RowBox[{"c", "[", "1", "]"}]}]}], ",", 
    RowBox[{"Mass", "\[Rule]", "m"}], ",", 
    RowBox[{"Qdof", "\[Rule]", "3"}], ",", 
    RowBox[{"Udof", "\[Rule]", "3"}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"b", ",", 
    RowBox[{"m", " ", "grav"}], ",", "0"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"p", ",", 
    RowBox[{"M", " ", "grav"}], ",", "0"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"c", ",", 
    RowBox[{"m", " ", "grav"}], ",", "0"}], "]"}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"b", ",", 
    RowBox[{
     RowBox[{"-", "\[Kappa]"}], " ", "m", " ", "g", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], "-", " ", 
       RowBox[{"q", "[", "3", "]"}]}], ")"}], " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"c", ",", 
    RowBox[{"\[Kappa]", " ", "m", " ", "g", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], "-", 
       RowBox[{"q", "[", "3", "]"}]}], ")"}], " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"grav", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
       RowBox[{"ground", "[", "2", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Gamma]", "]"}], 
       RowBox[{"ground", "[", "1", "]"}]}]}], ")"}], "g"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eoma", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"EOM", "[", "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "g"}], " ", "\[Kappa]", " ", 
        SubscriptBox["q", "1"]}], "+", 
       RowBox[{"g", " ", "\[Kappa]", " ", 
        SubscriptBox["q", "3"]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"C", "-", "L"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Gamma]", "-", 
             SubscriptBox["q", "1"]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"C", "-", "L"}], ")"}], " ", 
           SubsuperscriptBox["u", "1", "\[Prime]",
            MultilineFunction->None]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}], " ", 
           SubsuperscriptBox["u", "4", "\[Prime]",
            MultilineFunction->None]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "1"], "]"}], " ", 
           SubsuperscriptBox["u", "5", "\[Prime]",
            MultilineFunction->None]}]}], ")"}]}]}], ")"}]}], "==", "0"}], 
   ",", 
   RowBox[{
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", "\[Kappa]", " ", 
        SubscriptBox["q", "1"]}], "-", 
       RowBox[{"g", " ", "\[Kappa]", " ", 
        SubscriptBox["q", "3"]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"C", "-", "L"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Gamma]", "-", 
             SubscriptBox["q", "3"]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"C", "-", "L"}], ")"}], " ", 
           SubsuperscriptBox["u", "3", "\[Prime]",
            MultilineFunction->None]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "3"], "]"}], " ", 
           SubsuperscriptBox["u", "4", "\[Prime]",
            MultilineFunction->None]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "3"], "]"}], " ", 
           SubsuperscriptBox["u", "5", "\[Prime]",
            MultilineFunction->None]}]}], ")"}]}]}], ")"}]}], "==", "0"}], 
   ",", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "g", " ", "m", " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{"g", " ", "M", " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "C"}], "+", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      SubsuperscriptBox["u", "1", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "C"}], "+", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "3"], "]"}], " ", 
      SubsuperscriptBox["u", "3", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      SubsuperscriptBox["u", "1", "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "3"], "]"}], " ", 
      SubsuperscriptBox["u", "3", "\[Prime]",
       MultilineFunction->None]}]}], "==", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
     SubsuperscriptBox["u", "4", "\[Prime]",
      MultilineFunction->None]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubsuperscriptBox["u", "1", "2"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        SubsuperscriptBox["u", "3", "2"]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubsuperscriptBox["u", "1", "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        SubsuperscriptBox["u", "3", "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}], "==", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "+", 
       SubsuperscriptBox["u", "5", "\[Prime]",
        MultilineFunction->None]}], ")"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"massa", ",", "othera"}], "}"}], "=", 
   RowBox[{"MassMatrix", "[", "eoma", "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"massa", "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["C", "2"], " ", "m"}], "-", 
       RowBox[{"2", " ", "C", " ", "L", " ", "m"}], "+", 
       RowBox[{
        SuperscriptBox["L", "2"], " ", "m"}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "C"}], " ", "m", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}], "+", 
       RowBox[{"L", " ", "m", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "C"}], " ", "m", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}], "+", 
       RowBox[{"L", " ", "m", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}]}]},
     {"0", 
      RowBox[{
       RowBox[{
        SuperscriptBox["C", "2"], " ", "m"}], "-", 
       RowBox[{"2", " ", "C", " ", "L", " ", "m"}], "+", 
       RowBox[{
        SuperscriptBox["L", "2"], " ", "m"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "C"}], " ", "m", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}]}], "+", 
       RowBox[{"L", " ", "m", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "C"}], " ", "m", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}]}], "+", 
       RowBox[{"L", " ", "m", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "C"}], " ", "m", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}], "+", 
       RowBox[{"L", " ", "m", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "C"}], " ", "m", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}]}], "+", 
       RowBox[{"L", " ", "m", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}]}]}], 
      RowBox[{
       RowBox[{"2", " ", "m"}], "+", "M"}], "0"},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "C"}], " ", "m", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}], "+", 
       RowBox[{"L", " ", "m", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "C"}], " ", "m", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}]}], "+", 
       RowBox[{"L", " ", "m", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}]}]}], "0", 
      RowBox[{
       RowBox[{"2", " ", "m"}], "+", "M"}]}
    }], "\[NoBreak]", ")"}],
  MatrixForm[#]& ]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"othera", "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", 
          RowBox[{"(", 
           RowBox[{"C", "-", "L"}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Gamma]", "-", 
            SubscriptBox["q", "1"]}], "]"}]}], "-", 
         RowBox[{"g", " ", "\[Kappa]", " ", 
          SubscriptBox["q", "1"]}], "+", 
         RowBox[{"g", " ", "\[Kappa]", " ", 
          SubscriptBox["q", "3"]}]}], ")"}]}]},
     {
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", 
          RowBox[{"(", 
           RowBox[{"C", "-", "L"}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Gamma]", "-", 
            SubscriptBox["q", "3"]}], "]"}]}], "+", 
         RowBox[{"g", " ", "\[Kappa]", " ", 
          SubscriptBox["q", "1"]}], "-", 
         RowBox[{"g", " ", "\[Kappa]", " ", 
          SubscriptBox["q", "3"]}]}], ")"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "g", " ", "m", " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
       RowBox[{"g", " ", "M", " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "C"}], "+", "L"}], ")"}], " ", "m", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubsuperscriptBox["u", "1", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "C"}], "+", "L"}], ")"}], " ", "m", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        SubsuperscriptBox["u", "3", "2"]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "g"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}], " ", 
           SubsuperscriptBox["u", "1", "2"]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "3"], "]"}], " ", 
           SubsuperscriptBox["u", "3", "2"]}]}], ")"}]}]}]}
    }], "\[NoBreak]", ")"}],
  MatrixForm[{
   m (-g (C - L) Sin[\[Gamma] - qt[1][t]] - g \[Kappa] qt[1][t] + 
     g \[Kappa] qt[3][t]), 
    m (-g (C - L) Sin[\[Gamma] - qt[3][t]] + g \[Kappa] qt[1][t] - g \[Kappa] 
     qt[3][t]), 2 g m Sin[\[Gamma]] + g M Sin[\[Gamma]] + (-C + L) m Sin[
       qt[1][t]] ut[1][t]^2 + (-C + L) m Sin[
       qt[3][t]] ut[3][t]^2, -g (2 m + M) Cos[\[Gamma]] + (C - L) m (Cos[
         qt[1][t]] ut[1][t]^2 + Cos[
         qt[3][t]] ut[3][t]^2)}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Clean up the equations of motion", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eoma2", "=", 
   RowBox[{
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"eoma", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"L", "\[Rule]", "1"}], ",", 
          RowBox[{"C", "\[Rule]", "0"}], ",", 
          RowBox[{"R", "\[Rule]", "0"}], ",", 
          RowBox[{"m", "->", 
           RowBox[{"\[Beta]", " ", "M"}]}], ",", 
          RowBox[{"g", "\[Rule]", "1"}]}], "}"}]}], ")"}], "/", "M"}], "]"}], 
    " ", "//", "Simplify"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eoma2", "=", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Expand", "[", "#", "]"}], ",", "Equal"}], "]"}], "&"}], ",", 
     "eoma2"}], "]"}], "//", "FullSimplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "==", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          SubscriptBox["q", "1"]}], "]"}]}], "+", 
       RowBox[{"\[Kappa]", " ", 
        SubscriptBox["q", "1"]}], "-", 
       RowBox[{"\[Kappa]", " ", 
        SubscriptBox["q", "3"]}], "+", 
       SubsuperscriptBox["u", "1", "\[Prime]",
        MultilineFunction->None], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubsuperscriptBox["u", "4", "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubsuperscriptBox["u", "5", "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}]}], ",", 
   RowBox[{"0", "==", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          SubscriptBox["q", "3"]}], "]"}]}], "-", 
       RowBox[{"\[Kappa]", " ", 
        SubscriptBox["q", "1"]}], "+", 
       RowBox[{"\[Kappa]", " ", 
        SubscriptBox["q", "3"]}], "+", 
       SubsuperscriptBox["u", "3", "\[Prime]",
        MultilineFunction->None], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        SubsuperscriptBox["u", "4", "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        SubsuperscriptBox["u", "5", "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "\[Gamma]", "]"}], "+", 
     RowBox[{"2", " ", "\[Beta]", " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      SubsuperscriptBox["u", "1", "2"]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "3"], "]"}], " ", 
      SubsuperscriptBox["u", "3", "2"]}]}], "==", 
    RowBox[{
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      SubsuperscriptBox["u", "1", "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "3"], "]"}], " ", 
      SubsuperscriptBox["u", "3", "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
      SubsuperscriptBox["u", "4", "\[Prime]",
       MultilineFunction->None]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[Beta]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubsuperscriptBox["u", "1", "2"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        SubsuperscriptBox["u", "3", "2"]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubsuperscriptBox["u", "1", "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        SubsuperscriptBox["u", "3", "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}], "==", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Gamma]", "]"}], "+", 
       SubsuperscriptBox["u", "5", "\[Prime]",
        MultilineFunction->None]}], ")"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["eoma2"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "==", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          SubscriptBox["q", "1"]}], "]"}]}], "+", 
       RowBox[{"\[Kappa]", " ", 
        SubscriptBox["q", "1"]}], "-", 
       RowBox[{"\[Kappa]", " ", 
        SubscriptBox["q", "3"]}], "+", 
       SubsuperscriptBox["u", "1", "\[Prime]",
        MultilineFunction->None], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubsuperscriptBox["u", "4", "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubsuperscriptBox["u", "5", "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}]}], ",", 
   RowBox[{"0", "==", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          SubscriptBox["q", "3"]}], "]"}]}], "-", 
       RowBox[{"\[Kappa]", " ", 
        SubscriptBox["q", "1"]}], "+", 
       RowBox[{"\[Kappa]", " ", 
        SubscriptBox["q", "3"]}], "+", 
       SubsuperscriptBox["u", "3", "\[Prime]",
        MultilineFunction->None], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        SubsuperscriptBox["u", "4", "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        SubsuperscriptBox["u", "5", "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "\[Gamma]", "]"}], "+", 
     RowBox[{"2", " ", "\[Beta]", " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      SubsuperscriptBox["u", "1", "2"]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "3"], "]"}], " ", 
      SubsuperscriptBox["u", "3", "2"]}]}], "==", 
    RowBox[{
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      SubsuperscriptBox["u", "1", "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "3"], "]"}], " ", 
      SubsuperscriptBox["u", "3", "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
      SubsuperscriptBox["u", "4", "\[Prime]",
       MultilineFunction->None]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[Beta]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubsuperscriptBox["u", "1", "2"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        SubsuperscriptBox["u", "3", "2"]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubsuperscriptBox["u", "1", "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        SubsuperscriptBox["u", "3", "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}], "==", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Gamma]", "]"}], "+", 
       SubsuperscriptBox["u", "5", "\[Prime]",
        MultilineFunction->None]}], ")"}]}]}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Clean up the mass matrix", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"massa2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"massa", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"L", "\[Rule]", "1"}], ",", 
        RowBox[{"C", "\[Rule]", "0"}], ",", 
        RowBox[{"R", "\[Rule]", "0"}], ",", 
        RowBox[{"m", "->", 
         RowBox[{"\[Beta]", " ", "M"}]}], ",", 
        RowBox[{"g", "\[Rule]", "1"}]}], "}"}]}], ")"}], "/", "M"}], " ", "//",
    "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Beta]", ",", "0", ",", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}], ",", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[Beta]", ",", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "3"], "]"}]}], ",", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "3"], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}], ",", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "3"], "]"}]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}], ",", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "3"], "]"}]}], ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"othera2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"othera", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"L", "\[Rule]", "1"}], ",", 
        RowBox[{"C", "\[Rule]", "0"}], ",", 
        RowBox[{"R", "\[Rule]", "0"}], ",", 
        RowBox[{"m", "->", 
         RowBox[{"\[Beta]", " ", "M"}]}], ",", 
        RowBox[{"g", "\[Rule]", "1"}]}], "}"}]}], ")"}], "/", "M"}], " ", "//",
    "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Beta]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Gamma]", "-", 
        SubscriptBox["q", "1"]}], "]"}], "-", 
      RowBox[{"\[Kappa]", " ", 
       SubscriptBox["q", "1"]}], "+", 
      RowBox[{"\[Kappa]", " ", 
       SubscriptBox["q", "3"]}]}], ")"}]}], ",", 
   RowBox[{"\[Beta]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Gamma]", "-", 
        SubscriptBox["q", "3"]}], "]"}], "+", 
      RowBox[{"\[Kappa]", " ", 
       SubscriptBox["q", "1"]}], "-", 
      RowBox[{"\[Kappa]", " ", 
       SubscriptBox["q", "3"]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"Sin", "[", "\[Gamma]", "]"}], "+", 
    RowBox[{"2", " ", "\[Beta]", " ", 
     RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["q", "1"], "]"}], " ", 
     SubsuperscriptBox["u", "1", "2"]}], "+", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["q", "3"], "]"}], " ", 
     SubsuperscriptBox["u", "3", "2"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[Beta]"}]}], ")"}]}], " ", 
     RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["q", "1"], "]"}], " ", 
     SubsuperscriptBox["u", "1", "2"]}], "-", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["q", "3"], "]"}], " ", 
     SubsuperscriptBox["u", "3", "2"]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixForm", "[", "massa2", "]"}], "\[Equal]", 
  RowBox[{"MatrixForm", "[", "othera2", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"\[Beta]", "0", 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}], 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}]},
      {"0", "\[Beta]", 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}]}], 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}]}]},
      {
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}], 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}]}], "0", "0"},
      {
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}], 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}]}], "0", "0"}
     }], "\[NoBreak]", ")"}],
   MatrixForm[#]& ], "==", 
  InterpretationBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Gamma]", "-", 
            SubscriptBox["q", "1"]}], "]"}], "-", 
          RowBox[{"\[Kappa]", " ", 
           SubscriptBox["q", "1"]}], "+", 
          RowBox[{"\[Kappa]", " ", 
           SubscriptBox["q", "3"]}]}], ")"}]}]},
      {
       RowBox[{"\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Gamma]", "-", 
            SubscriptBox["q", "3"]}], "]"}], "+", 
          RowBox[{"\[Kappa]", " ", 
           SubscriptBox["q", "1"]}], "-", 
          RowBox[{"\[Kappa]", " ", 
           SubscriptBox["q", "3"]}]}], ")"}]}]},
      {
       RowBox[{
        RowBox[{"Sin", "[", "\[Gamma]", "]"}], "+", 
        RowBox[{"2", " ", "\[Beta]", " ", 
         RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
        RowBox[{"\[Beta]", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["q", "1"], "]"}], " ", 
         SubsuperscriptBox["u", "1", "2"]}], "+", 
        RowBox[{"\[Beta]", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["q", "3"], "]"}], " ", 
         SubsuperscriptBox["u", "3", "2"]}]}]},
      {
       RowBox[{
        RowBox[{"-", "\[Beta]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}], " ", 
           SubsuperscriptBox["u", "1", "2"]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "3"], "]"}], " ", 
           SubsuperscriptBox["u", "3", "2"]}]}], ")"}]}]}
     }], "\[NoBreak]", ")"}],
   MatrixForm[{\[Beta] (Sin[\[Gamma] - qt[1][t]] - \[Kappa] 
      qt[1][t] + \[Kappa] qt[3][t]), \[Beta] (
      Sin[\[Gamma] - qt[3][t]] + \[Kappa] qt[1][t] - \[Kappa] qt[3][t]), 
     Sin[\[Gamma]] + 2 \[Beta] Sin[\[Gamma]] + \[Beta] Sin[
        qt[1][t]] ut[1][t]^2 + \[Beta] Sin[
        qt[3][t]] ut[3][t]^2, -\[Beta] (Cos[
         qt[1][t]] ut[1][t]^2 + Cos[
         qt[3][t]] ut[3][t]^2)}]]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Momentum equations before heel strike", "Subsubsection"],

Cell["\<\
Angular momentum of whole machine about impending contact point\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amb1", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AngMom", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"b", ",", "c", ",", "p"}], "}"}], ",", 
        RowBox[{"PosPnt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"C", "-", "R"}], ")"}], " ", 
            RowBox[{"c", "[", "1", "]"}]}], "-", 
           RowBox[{"R", " ", 
            RowBox[{"ground", "[", "2", "]"}]}]}], ",", "c"}], "]"}]}], "]"}],
       ".", 
      RowBox[{"ground", "[", "3", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "3", "]"}], ",", 
       RowBox[{"u", "[", "4", "]"}], ",", 
       RowBox[{"u", "[", "5", "]"}]}], "}"}]}], "]"}], " ", "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
   RowBox[{"(", 
    RowBox[{"C", "-", "L", "+", 
     RowBox[{"R", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "1"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
   RowBox[{"(", 
    RowBox[{"C", "-", "R", "+", 
     RowBox[{"R", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "3"], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "3"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "m"}], "+", "M"}], ")"}]}], " ", "R"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "m"}], "+", 
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R"}]}], ")"}], 
      " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "3"], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "4"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"C", "-", "L"}], ")"}]}], " ", "m", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "m"}], "+", 
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R"}]}], ")"}], 
      " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "3"], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "5"]}]}]], "Output"]
}, Open  ]],

Cell["Angular momentum of trailing leg about hip", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amb2", "=", 
  RowBox[{
   RowBox[{"AngMom", "[", 
    RowBox[{"b", ",", 
     RowBox[{"PosPnt", "[", 
      RowBox[{"0", ",", "p"}], "]"}]}], "]"}], ".", 
   RowBox[{"ground", "[", "3", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"C", "-", "L"}], ")"}], "2"], " ", "m", " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "4"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "5"]}]}]], "Output"]
}, Open  ]],

Cell["Linear momentum of whole machine along impending stance leg", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amb3", "=", 
  RowBox[{
   RowBox[{"LinMom", "[", 
    RowBox[{"{", 
     RowBox[{"b", ",", "c", ",", "p"}], "}"}], "]"}], ".", 
   RowBox[{"c", "[", "1", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "3"]}], "]"}], " ", 
   SubscriptBox["u", "1"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["q", "3"], "]"}], " ", 
   SubscriptBox["u", "4"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["q", "3"], "]"}], " ", 
   SubscriptBox["u", "5"]}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Foot height", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PosPnt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"C", "-", "R"}], ")"}], 
       RowBox[{"c", "[", "1", "]"}]}], " ", "-", " ", 
      RowBox[{"R", " ", 
       RowBox[{"ground", "[", "2", "]"}]}]}], ",", "c"}], "]"}], ".", 
   RowBox[{"ground", "[", "2", "]"}]}], " ", "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "R"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["q", "3"], "]"}]}], "+", 
  SubscriptBox["q", "5"]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KEa", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Mass", "[", "b", "]"}], " ", 
       RowBox[{
        RowBox[{"VelCOM", "[", "b", "]"}], ".", 
        RowBox[{"VelCOM", "[", "b", "]"}]}]}], "+", 
      RowBox[{
       RowBox[{"Mass", "[", "p", "]"}], " ", 
       RowBox[{
        RowBox[{"VelCOM", "[", "p", "]"}], ".", 
        RowBox[{"VelCOM", "[", "p", "]"}]}]}], "+", 
      RowBox[{
       RowBox[{"Mass", "[", "c", "]"}], 
       RowBox[{
        RowBox[{"VelCOM", "[", "c", "]"}], ".", 
        RowBox[{"VelCOM", "[", "c", "]"}]}]}]}], ")"}]}], " ", "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], "2"], " ", "m", " ", 
     SubsuperscriptBox["u", "1", "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], "2"], " ", "m", " ", 
     SubsuperscriptBox["u", "3", "2"]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
     SubscriptBox["u", "1"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubscriptBox["u", "4"]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubscriptBox["u", "5"]}]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
     SubscriptBox["u", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        SubscriptBox["u", "4"]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "3"], "]"}], " ", 
        SubscriptBox["u", "5"]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SubsuperscriptBox["u", "4", "2"], "+", 
       SubsuperscriptBox["u", "5", "2"]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PEa", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Mass", "[", "b", "]"}]}], " ", 
     RowBox[{
      RowBox[{"PosCOM", "[", "b", "]"}], ".", "grav"}]}], "-", 
    RowBox[{
     RowBox[{"Mass", "[", "c", "]"}], " ", 
     RowBox[{
      RowBox[{"PosCOM", "[", "c", "]"}], ".", "grav"}]}], "-", 
    RowBox[{
     RowBox[{"Mass", "[", "p", "]"}], " ", 
     RowBox[{
      RowBox[{"PosCOM", "[", "p", "]"}], ".", "grav"}]}]}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"g", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], ")"}]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Gamma]", "-", 
       FractionBox[
        SubscriptBox["q", "1"], "2"], "-", 
       FractionBox[
        SubscriptBox["q", "3"], "2"]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
     SubscriptBox["q", "4"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
     RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
     SubscriptBox["q", "5"]}]}], ")"}]}]], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Gamma]", "-", 
         RowBox[{"q", "[", "1", "]"}]}], "]"}]}], "\[Rule]", "sq1g"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"q", "[", "1", "]"}], "]"}], "\[Rule]", "s1"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"q", "[", "2", "]"}], "]"}], "\[Rule]", "s2"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"q", "[", "3", "]"}], "]"}], "\[Rule]", "s3"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"q", "[", "1", "]"}], "]"}], "\[Rule]", "c1"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"q", "[", "2", "]"}], "]"}], "\[Rule]", "c2"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"q", "[", "3", "]"}], "]"}], "\[Rule]", "c3"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], "-", 
        RowBox[{"q", "[", "2", "]"}]}], "]"}], "\[Rule]", "s12"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], "-", 
        RowBox[{"q", "[", "3", "]"}]}], "]"}], "\[Rule]", "s13"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q", "[", "2", "]"}], "-", 
        RowBox[{"q", "[", "3", "]"}]}], "]"}], "\[Rule]", "s23"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], "-", 
        RowBox[{"q", "[", "2", "]"}]}], "]"}], "\[Rule]", "c12"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], "-", 
        RowBox[{"q", "[", "3", "]"}]}], "]"}], "\[Rule]", "c13"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q", "[", "2", "]"}], "-", 
        RowBox[{"q", "[", "3", "]"}]}], "]"}], "\[Rule]", "c23"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Gamma]", "]"}], "\[Rule]", "sg"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Gamma]", "]"}], "\[Rule]", "cg"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], "+", 
        RowBox[{"q", "[", "2", "]"}]}], "]"}], "\[Rule]", "sp12"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], "+", 
        RowBox[{"q", "[", "3", "]"}]}], "]"}], "\[Rule]", "sp13"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q", "[", "2", "]"}], "+", 
        RowBox[{"q", "[", "3", "]"}]}], "]"}], "\[Rule]", "sp23"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], "+", 
        RowBox[{"q", "[", "2", "]"}]}], "]"}], "\[Rule]", "cp12"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], "+", 
        RowBox[{"q", "[", "3", "]"}]}], "]"}], "\[Rule]", "cp13"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q", "[", "2", "]"}], "+", 
        RowBox[{"q", "[", "3", "]"}]}], "]"}], "\[Rule]", "cp23"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], "-", "\[Gamma]"}], "]"}], "\[Rule]", 
      "sq1g"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q", "[", "3", "]"}], "-", "\[Gamma]"}], "]"}], "\[Rule]", 
      "sq3g"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], "-", "\[Gamma]"}], "]"}], "\[Rule]", 
      "cq1g"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q", "[", "3", "]"}], "-", "\[Gamma]"}], "]"}], "\[Rule]", 
      "cq3g"}], ",", 
     RowBox[{"\[Kappa]", "\[Rule]", "Khip"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", "beta"}], ",", 
     RowBox[{"K", "\[Rule]", "Kleg"}], ",", 
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], "\[Rule]", "u1"}], ",", 
     RowBox[{
      RowBox[{"u", "[", "2", "]"}], "\[Rule]", "u2"}], ",", 
     RowBox[{
      RowBox[{"u", "[", "3", "]"}], "\[Rule]", "u3"}], ",", 
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], "\[Rule]", "q1"}], ",", 
     RowBox[{
      RowBox[{"q", "[", "2", "]"}], "\[Rule]", "q2"}], ",", 
     RowBox[{
      RowBox[{"q", "[", "3", "]"}], "\[Rule]", "q3"}], ",", 
     RowBox[{
      RowBox[{"q", "[", "4", "]"}], "\[Rule]", "q4"}], ",", 
     RowBox[{
      RowBox[{"q", "[", "5", "]"}], "\[Rule]", "q5"}], ",", 
     RowBox[{
      RowBox[{"u", "[", "4", "]"}], "\[Rule]", "u4"}], ",", 
     RowBox[{
      RowBox[{"u", "[", "5", "]"}], "\[Rule]", "u5"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psub", " ", "=", " ", 
   RowBox[{
    RowBox[{"Power", "[", 
     RowBox[{"x_", ",", "2"}], "]"}], "->", 
    RowBox[{"HoldForm", "[", 
     RowBox[{"x", "*", "x"}], "]"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"massa2", "/.", "subs"}], "/.", "psub"}], "]"}]], "Input"],

Cell["\<\
List(List(beta,0,beta*c1,beta*s1),List(0,beta,beta*c3,beta*s3),List(beta*c1,\
beta*c3,0,0),List(beta*s1,beta*s3,0,0))\
\>", "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"othera2", "/.", "subs"}], "/.", "psub"}], "]"}]], "Input"],

Cell["\<\
List(beta*(-(Khip*q1) + Khip*q3 - Sin(q1 - \[Gamma])),beta*(Khip*q1 - Khip*q3 \
- Sin(q3 - \[Gamma])),
   sg + 2*beta*sg + beta*s1*(u1*u1) + beta*s3*(u3*u3),-((1 + 2*beta)*cg) - \
beta*c1*(u1*u1) - beta*c3*(u3*u3))\
\>", "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"mass2", "/.", "subs"}], "/.", "psub"}], "]"}]], "Input"],

Cell["\<\
List(List(1 + beta - 2*(1 + beta)*q2 + (1 + 2*beta)*(q2*q2),0,beta*c13*(-1 + \
q2)),
   List(0,1 + 2*beta,beta*s13),List(beta*c13*(-1 + q2),beta*s13,beta))\
\>", "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"other2", "/.", "subs"}], "/.", "psub"}], "/.", "subs"}], 
  "]"}]], "Input"],

Cell["\<\
List(-(beta*Khip*q1) + beta*Khip*q3 + sq1g + beta*sq1g + 2*u1*u2 + \
2*beta*u1*u2 + beta*s13*(u3*u3) + 
    q2*(-2*(1 + 2*beta)*u1*u2 - beta*s13*(u3*u3) - (1 + 2*beta)*Sin(q1 - \
\[Gamma])),
   cq1g + 2*beta*cq1g - (1 + beta)*(u1*u1) + q2*(-Kleg + (1 + \
2*beta)*(u1*u1)) + beta*c13*(u3*u3),
   beta*(Khip*(q1 - q3) - 2*c13*u1*u2 + (-1 + q2)*s13*(u1*u1) - Sin(q3 - \
\[Gamma])))\
\>", "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", "\n", "\t", 
  RowBox[{
   RowBox[{"StringForm", "[", 
    RowBox[{"\"\<MM[`1`] = `2`;\>\"", ",", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}]}], "+", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}], ",", 
     RowBox[{"CForm", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mass2", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i"}], "]"}], "]"}], "/.", "subs"}], "/.", 
       "psub"}], " ", "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox["\<\"MM[\\!\\(0\\)] = \\!\\(\\*StyleBox[\\\"1 + beta - \
2*(1 + beta)*q2 + (1 + 2*beta)*(q2*q2)\\\", Rule[ShowStringCharacters, True], \
Rule[NumberMarks, True]]\\);\"\>",
      StringForm["MM[`1`] = `2`;", 0, 
       CForm[1 + beta - 2 (1 + beta) q2 + (1 + 2 beta) HoldForm[q2 q2]]],
      Editable->False], ",", 
     InterpretationBox["\<\"MM[\\!\\(1\\)] = \\!\\(\\*StyleBox[\\\"0\\\", \
Rule[ShowStringCharacters, True], Rule[NumberMarks, True]]\\);\"\>",
      StringForm["MM[`1`] = `2`;", 1, 
       CForm[0]],
      Editable->False], ",", 
     InterpretationBox["\<\"MM[\\!\\(2\\)] = \
\\!\\(\\*StyleBox[\\\"beta*c13*(-1 + q2)\\\", Rule[ShowStringCharacters, \
True], Rule[NumberMarks, True]]\\);\"\>",
      StringForm["MM[`1`] = `2`;", 2, 
       CForm[beta c13 (-1 + q2)]],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox["\<\"MM[\\!\\(2\\)] = \\!\\(\\*StyleBox[\\\"0\\\", \
Rule[ShowStringCharacters, True], Rule[NumberMarks, True]]\\);\"\>",
      StringForm["MM[`1`] = `2`;", 2, 
       CForm[0]],
      Editable->False], ",", 
     InterpretationBox["\<\"MM[\\!\\(3\\)] = \\!\\(\\*StyleBox[\\\"1 + 2*beta\
\\\", Rule[ShowStringCharacters, True], Rule[NumberMarks, True]]\\);\"\>",
      StringForm["MM[`1`] = `2`;", 3, 
       CForm[1 + 2 beta]],
      Editable->False], ",", 
     InterpretationBox["\<\"MM[\\!\\(4\\)] = \\!\\(\\*StyleBox[\\\"beta*s13\\\
\", Rule[ShowStringCharacters, True], Rule[NumberMarks, True]]\\);\"\>",
      StringForm["MM[`1`] = `2`;", 4, 
       CForm[beta s13]],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox["\<\"MM[\\!\\(4\\)] = \
\\!\\(\\*StyleBox[\\\"beta*c13*(-1 + q2)\\\", Rule[ShowStringCharacters, \
True], Rule[NumberMarks, True]]\\);\"\>",
      StringForm["MM[`1`] = `2`;", 4, 
       CForm[beta c13 (-1 + q2)]],
      Editable->False], ",", 
     InterpretationBox["\<\"MM[\\!\\(5\\)] = \\!\\(\\*StyleBox[\\\"beta*s13\\\
\", Rule[ShowStringCharacters, True], Rule[NumberMarks, True]]\\);\"\>",
      StringForm["MM[`1`] = `2`;", 5, 
       CForm[beta s13]],
      Editable->False], ",", 
     InterpretationBox["\<\"MM[\\!\\(6\\)] = \\!\\(\\*StyleBox[\\\"beta\\\", \
Rule[ShowStringCharacters, True], Rule[NumberMarks, True]]\\);\"\>",
      StringForm["MM[`1`] = `2`;", 6, 
       CForm[beta]],
      Editable->False]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"udofs", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";", 
  RowBox[{"mommatrix", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ama1", ",", "ama2", ",", "ama3"}], "}"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u", "[", "#1", "]"}], "&"}], ")"}], "/@", "udofs"}]}], 
         "]"}], ",", 
        RowBox[{"u", "[", "#1", "]"}], ",", "1"}], "]"}], "&"}], ")"}], "/@", 
    "udofs"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["C", "2"], " ", "m"}], "+", 
      RowBox[{
       SuperscriptBox["L", "2"], " ", "m"}], "+", 
      RowBox[{
       SuperscriptBox["L", "2"], " ", "M"}], "-", 
      RowBox[{"2", " ", "C", " ", "m", " ", "R"}], "-", 
      RowBox[{"2", " ", "L", " ", "m", " ", "R"}], "-", 
      RowBox[{"2", " ", "L", " ", "M", " ", "R"}], "+", 
      RowBox[{"4", " ", "m", " ", 
       SuperscriptBox["R", "2"]}], "+", 
      RowBox[{"2", " ", "M", " ", 
       SuperscriptBox["R", "2"]}], "+", 
      RowBox[{"2", " ", "R", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"C", " ", "m"}], "+", 
         RowBox[{"L", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M"}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R"}]}], ")"}], 
       " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "1"], "]"}]}], "+", 
      RowBox[{"C", " ", "L", " ", "m", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["L", "2"], " ", "m", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], "]"}]}], "-", 
      RowBox[{"C", " ", "m", " ", "R", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], "]"}]}], "+", 
      RowBox[{"L", " ", "m", " ", "R", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], "]"}]}], "+", 
      RowBox[{"C", " ", "m", " ", "R", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "3"], "]"}]}], "-", 
      RowBox[{"L", " ", "m", " ", "R", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "3"], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"C", " ", "m"}], "+", 
            RowBox[{"L", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M"}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R"}]}], 
           ")"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["q", "1"], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["q", "1"], "-", 
            SubscriptBox["q", "3"]}], "]"}]}]}], ")"}], " ", 
       SubscriptBox["q", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", 
       SubsuperscriptBox["q", "2", "2"]}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"L", "-", "R"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "3"]}], "]"}]}], "+", 
        RowBox[{"R", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "3"], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "3"]}], "]"}], " ", 
         SubscriptBox["q", "2"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "m"}], "-", "M"}], ")"}], " ", "R", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "m"}], "+", "M"}], ")"}]}], " ", "R", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "1"], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"C", "-", "L"}], ")"}]}], " ", "m", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"2", " ", "m"}], "+", "M"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"C", "-", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"(", 
       RowBox[{"C", "-", "L", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"L", "-", "R"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "3"]}], "]"}]}], "+", 
        RowBox[{"R", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "3"], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "3"]}], "]"}], " ", 
         SubscriptBox["q", "2"]}]}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"C", "-", "L"}], ")"}], "2"], " ", "m"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "C"}], "+", "L"}], ")"}], " ", "m", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}]}], "}"}]}], "}"}]], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mommatrixs", "=", 
  RowBox[{
   RowBox[{"Cancel", "[", 
    RowBox[{
     RowBox[{"mommatrix", "/", "M"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "\[Rule]", "1"}], ",", 
       RowBox[{"C", "\[Rule]", "0"}], ",", 
       RowBox[{"R", "\[Rule]", "0"}], ",", 
       RowBox[{"m", "->", 
        RowBox[{"\[Beta]", " ", "M"}]}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", "\[Beta]", "-", 
      RowBox[{"\[Beta]", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "3"]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Beta]"}], ")"}]}], "+", 
         RowBox[{"\[Beta]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["q", "1"], "-", 
            SubscriptBox["q", "3"]}], "]"}]}]}], ")"}], " ", 
       SubscriptBox["q", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Beta]"}]}], ")"}], " ", 
       SubsuperscriptBox["q", "2", "2"]}]}], ",", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["q", "2"]}], ")"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}], ",", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}], ",", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "\[Beta]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "3"]}], "]"}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "3"]}], "]"}], " ", 
         SubscriptBox["q", "2"]}]}], ")"}]}], ",", "\[Beta]", ",", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}]}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell["\<\
This prints things out in column order (in other words, this is the wrong \
order for Matlab)\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"ToString", "[", "\n", "\t", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<MM[`1`] = `2`;\>\"", ",", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}]}], "+", 
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}]}], ",", 
       RowBox[{"CForm", "[", 
        RowBox[{"mommatrixs", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "]"}]}], "]"}], "]"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["\<\"MM[0] = 1 + \[Beta] - \[Beta]*Cos(qt(1)(t) - qt(3)(t)) + \
(-2*(1 + \[Beta]) + \[Beta]*Cos(qt(1)(t) - qt(3)(t)))*qt(2)(t) + (1 + 2*\
\[Beta])*Power(qt(2)(t),2);\"\>"], "Print"],

Cell[BoxData["\<\"MM[1] = \[Beta]*Sin(qt(1)(t) - qt(3)(t));\"\>"], "Print"],

Cell[BoxData["\<\"MM[2] = \[Beta]*(1 - Cos(qt(1)(t) - qt(3)(t)) + \
Cos(qt(1)(t) - qt(3)(t))*qt(2)(t));\"\>"], "Print"],

Cell[BoxData["\<\"MM[3] = \[Beta]*Cos(qt(1)(t) - qt(3)(t))*(-1 + qt(2)(t));\"\
\>"], "Print"],

Cell[BoxData["\<\"MM[4] = \[Beta]*Sin(qt(1)(t) - qt(3)(t));\"\>"], "Print"],

Cell[BoxData["\<\"MM[5] = \[Beta];\"\>"], "Print"],

Cell[BoxData["\<\"MM[6] = 0;\"\>"], "Print"],

Cell[BoxData["\<\"MM[7] = 1 + 2*\[Beta];\"\>"], "Print"],

Cell[BoxData["\<\"MM[8] = \[Beta]*Sin(qt(1)(t) - qt(3)(t));\"\>"], "Print"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"amb1s", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Cancel", "[", 
      RowBox[{"amb1", "/", "M"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "\[Rule]", "1"}], ",", 
       RowBox[{"C", "\[Rule]", "0"}], ",", 
       RowBox[{"R", "\[Rule]", "0"}], ",", 
       RowBox[{"m", "\[Rule]", 
        RowBox[{"\[Beta]", " ", "M"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amb2s", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Cancel", "[", 
      RowBox[{"amb2", "/", "M"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "\[Rule]", "1"}], ",", 
       RowBox[{"C", "\[Rule]", "0"}], ",", 
       RowBox[{"R", "\[Rule]", "0"}], ",", 
       RowBox[{"m", "\[Rule]", 
        RowBox[{"\[Beta]", " ", "M"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amb3s", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Cancel", "[", 
      RowBox[{"amb3", "/", "M"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "\[Rule]", "1"}], ",", 
       RowBox[{"C", "\[Rule]", "0"}], ",", 
       RowBox[{"R", "\[Rule]", "0"}], ",", 
       RowBox[{"m", "\[Rule]", 
        RowBox[{"\[Beta]", " ", "M"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"amb1s", "/.", "subs"}], "/.", "psub"}], "]"}]], "Input"],

Cell["\<\
(beta - beta*c13)*u1 - (-(beta*c1) + (1 + beta)*c3)*u4 - (-(beta*s1) + (1 + \
beta)*s3)*u5\
\>", "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"amb2s", "/.", "subs"}], "/.", "psub"}], "]"}]], "Input"],

Cell["beta*(u1 + c1*u4 + s1*u5)", "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"amb3s", "/.", "subs"}], "/.", "psub"}], "]"}]], "Input"],

Cell["-(beta*s13*u1) + (1 + 2*beta)*(s3*u4 - c3*u5)", "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"Cancel", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"KEs", "/", "M"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"L", "\[Rule]", "1"}], ",", 
        RowBox[{"C", "\[Rule]", "0"}], ",", 
        RowBox[{"R", "\[Rule]", "0"}], ",", 
        RowBox[{"m", "\[Rule]", 
         RowBox[{"\[Beta]", " ", "M"}]}]}], "}"}]}], "/.", "subs"}], "/.", 
    "psub"}], "]"}], "]"}]], "Input"],

Cell["\<\
(-2*beta*c13*u1*u3 + 2*beta*c13*q2*u1*u3 + 2*beta*s13*u2*u3 + u1*u1 + \
beta*(u1*u1) - 2*q2*(u1*u1) - 2*beta*q2*(u1*u1) + 
     q2*q2*(u1*u1) + 2*beta*(q2*q2)*(u1*u1) + u2*u2 + 2*beta*(u2*u2) + \
beta*(u3*u3))/2.\
\>", "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PEs", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "\[Rule]", "1"}], ",", 
       RowBox[{"C", "\[Rule]", "0"}], ",", 
       RowBox[{"R", "\[Rule]", "0"}], ",", 
       RowBox[{"m", "\[Rule]", 
        RowBox[{"\[Beta]", " ", "M"}]}]}], "}"}]}], "/.", "subs"}], "/.", 
   "psub"}], "]"}]], "Input"],

Cell["\<\
g*(cq1g*M + beta*cq1g*M - beta*cq3g*M - cq1g*(M + 2*beta*M)*q2)\
\>", "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"KEa", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "\[Rule]", "1"}], ",", 
       RowBox[{"C", "\[Rule]", "0"}], ",", 
       RowBox[{"R", "\[Rule]", "0"}], ",", 
       RowBox[{"m", "\[Rule]", 
        RowBox[{"\[Beta]", " ", "M"}]}]}], "}"}]}], "/.", "subs"}], "/.", 
   "psub"}], "]"}]], "Input"],

Cell["\<\
(2*beta*M*u1*(c1*u4 + s1*u5) + 2*beta*M*u3*(c3*u4 + s3*u5) + beta*M*(u1*u1) + \
beta*M*(u3*u3) + (M + 2*beta*M)*(u4*u4 + u5*u5))/2.\
\>", "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"Cancel", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PEa", "/", "M"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"L", "\[Rule]", "1"}], ",", 
        RowBox[{"C", "\[Rule]", "0"}], ",", 
        RowBox[{"R", "\[Rule]", "0"}], ",", 
        RowBox[{"m", "\[Rule]", 
         RowBox[{"\[Beta]", " ", "M"}]}]}], "}"}]}], "/.", "subs"}], "/.", 
    "psub"}], "]"}], "]"}]], "Input"],

Cell["\<\
g*(cg*q5 + 2*beta*cg*q5 - q4*sg - 2*beta*q4*sg - 2*beta*Cos((q1 - \
q3)/2.)*Cos(q1/2. + q3/2. - \[Gamma]))\
\>", "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical simulations", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parms", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0"}], ",", 
     RowBox[{"L", "\[Rule]", "1"}], ",", 
     RowBox[{"M", "\[Rule]", "1"}], ",", 
     RowBox[{"R", "\[Rule]", "0"}], ",", 
     RowBox[{"g", "\[Rule]", "1"}], ",", 
     RowBox[{"K", "\[Rule]", "10"}], ",", 
     RowBox[{"\[Kappa]", "\[Rule]", "3"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "0"}]}], "}"}]}], ";"}]], "Input",
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"initcond", "=", 
   RowBox[{"AtT0", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], "\[Equal]", "0.5548"}], ",", 
      RowBox[{
       RowBox[{"q", "[", "2", "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{"q", "[", "3", "]"}], "==", 
       RowBox[{"-", "0.5585"}]}], ",", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], "\[Equal]", 
       RowBox[{"-", "0.9151"}]}], ",", 
      RowBox[{
       RowBox[{"u", "[", "2", "]"}], "\[Equal]", "0.8491"}], ",", 
      RowBox[{
       RowBox[{"u", "[", "3", "]"}], "\[Equal]", "0.8997"}]}], "}"}], "]"}]}],
   ";"}]], "Input",
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"initconda", "=", 
   RowBox[{"AtT0", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], "\[Equal]", "0.5548"}], ",", 
      RowBox[{
       RowBox[{"q", "[", "3", "]"}], "==", 
       RowBox[{"-", "0.5585"}]}], ",", 
      RowBox[{
       RowBox[{"q", "[", "4", "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{"q", "[", "5", "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], "\[Equal]", 
       RowBox[{"-", "0.9151"}]}], ",", 
      RowBox[{
       RowBox[{"u", "[", "3", "]"}], "\[Equal]", "0.8997"}], ",", 
      RowBox[{
       RowBox[{"u", "[", "4", "]"}], "\[Equal]", ".5"}], ",", 
      RowBox[{
       RowBox[{"u", "[", "5", "]"}], "\[Equal]", ".3"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"eoma2", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"\[Beta]", "\[Rule]", "1"}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eoma2", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"\[Beta]", "\[Rule]", "1"}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eoma2", "[", 
   RowBox[{"[", "3", "]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"\[Beta]", "\[Rule]", "0"}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eoma2", "[", 
   RowBox[{"[", "4", "]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"\[Beta]", "\[Rule]", "0"}], "}"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eomaa", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"eoma2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"\[Beta]", "\[Rule]", "1"}]}], ",", 
    RowBox[{
     RowBox[{"eoma2", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"\[Beta]", "\[Rule]", "1"}]}], ",", 
    RowBox[{
     RowBox[{"eoma2", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", 
     RowBox[{"\[Beta]", "\[Rule]", "0"}]}], ",", 
    RowBox[{
     RowBox[{"eoma2", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "/.", 
     RowBox[{"\[Beta]", "\[Rule]", "0"}]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "==", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Gamma]", "-", 
        SubscriptBox["q", "1"]}], "]"}]}], "+", 
     RowBox[{"\[Kappa]", " ", 
      SubscriptBox["q", "1"]}], "-", 
     RowBox[{"\[Kappa]", " ", 
      SubscriptBox["q", "3"]}], "+", 
     SubsuperscriptBox["u", "1", "\[Prime]",
      MultilineFunction->None], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      SubsuperscriptBox["u", "4", "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      SubsuperscriptBox["u", "5", "\[Prime]",
       MultilineFunction->None]}]}]}], ",", 
   RowBox[{"0", "==", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Gamma]", "-", 
        SubscriptBox["q", "3"]}], "]"}]}], "-", 
     RowBox[{"\[Kappa]", " ", 
      SubscriptBox["q", "1"]}], "+", 
     RowBox[{"\[Kappa]", " ", 
      SubscriptBox["q", "3"]}], "+", 
     SubsuperscriptBox["u", "3", "\[Prime]",
      MultilineFunction->None], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "3"], "]"}], " ", 
      SubsuperscriptBox["u", "4", "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "3"], "]"}], " ", 
      SubsuperscriptBox["u", "5", "\[Prime]",
       MultilineFunction->None]}]}]}], ",", 
   RowBox[{
    RowBox[{"Sin", "[", "\[Gamma]", "]"}], "==", 
    SubsuperscriptBox["u", "4", "\[Prime]",
     MultilineFunction->None]}], ",", 
   RowBox[{"0", "==", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Gamma]", "]"}], "+", 
     SubsuperscriptBox["u", "5", "\[Prime]",
      MultilineFunction->None]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eoms", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"eom2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "\[Rule]", "1"}], ",", 
       RowBox[{"\[Beta]", "\[Rule]", "0"}]}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"eom2", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "\[Rule]", "1"}], ",", 
       RowBox[{"\[Beta]", "\[Rule]", "0"}]}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"eom2", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\[Beta]", "\[Rule]", "1"}], "}"}]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SubscriptBox["u", "1"], " ", 
        SubscriptBox["u", "2"]}]}], ")"}]}], "==", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["q", "2"]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", 
         SubscriptBox["q", "2"]}], "+", 
        SubsuperscriptBox["q", "2", "2"]}], ")"}], " ", 
      SubsuperscriptBox["u", "1", "\[Prime]",
       MultilineFunction->None]}]}]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Gamma]", "-", 
      SubscriptBox["q", "1"]}], "]"}], "==", 
    RowBox[{
     SubsuperscriptBox["u", "1", "2"], "+", 
     RowBox[{
      SubscriptBox["q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"K", "-", 
        SubsuperscriptBox["u", "1", "2"]}], ")"}]}], "+", 
     SubsuperscriptBox["u", "2", "\[Prime]",
      MultilineFunction->None]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "3"]}], "]"}], "+", 
     RowBox[{"\[Kappa]", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "2"]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      SubsuperscriptBox["u", "1", "\[Prime]",
       MultilineFunction->None]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "3"]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["q", "2"]}], ")"}]}], " ", 
         SubsuperscriptBox["u", "1", "2"]}], "+", 
        SubsuperscriptBox["u", "2", "\[Prime]",
         MultilineFunction->None]}], ")"}]}]}], "==", 
    SubsuperscriptBox["u", "3", "\[Prime]",
     MultilineFunction->None]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"trajectory", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"eoms", ",", "Kinematics", ",", "initcond"}], "]"}], "/.", 
      "parms"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"q", "[", "2", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}], ",", 
       RowBox[{"q", "[", "3", "]"}], ",", 
       RowBox[{"u", "[", "3", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0.", ",", "2"}], "}"}]}], "]"}]}], "]"}]], "Input",
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.05999999999994543`", " ", "Second"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["u", "1"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["q", "2"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["u", "2"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["q", "3"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["u", "3"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}]}], "}"}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"trajectorya", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"eomaa", ",", "Kinematics", ",", "initconda"}], "]"}], "/.", 
      "parms"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"q", "[", "3", "]"}], ",", 
       RowBox[{"u", "[", "3", "]"}], ",", 
       RowBox[{"q", "[", "4", "]"}], ",", 
       RowBox[{"u", "[", "4", "]"}], ",", 
       RowBox[{"q", "[", "5", "]"}], ",", 
       RowBox[{"u", "[", "5", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0.", ",", "2"}], "}"}]}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.06000000000040018`", " ", "Second"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["u", "1"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["q", "3"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["u", "3"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["q", "4"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["u", "4"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["q", "5"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["u", "5"], "\[Rule]", 
       RowBox[{
        TagBox[
         RowBox[{"InterpolatingFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "2.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
          "]"}],
         False,
         Editable->False], "[", "t", "]"}]}]}], "}"}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], ",", 
       RowBox[{"q", "[", "2", "]"}], ",", 
       RowBox[{"q", "[", "3", "]"}]}], "}"}], "/.", "trajectory"}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0.", ",", "2."}], "}"}]}], "]"}]], "Input"],

Cell[GraphicsData["PostScript", "\<\
%!
%%Creator: Mathematica
%%AspectRatio: .61803 
MathPictureStart
/Mabs {
Mgmatrix idtransform
Mtmatrix dtransform
} bind def
/Mabsadd { Mabs
3 -1 roll add
3 1 roll add
exch } bind def
%% Graphics
%%IncludeResource: font Courier
%%IncludeFont: Courier
/Courier findfont 10  scalefont  setfont
% Scaling calculations
0.0238095 0.47619 0.419372 0.245503 [
[.2619 .40687 -9 -9 ]
[.2619 .40687 9 0 ]
[.5 .40687 -3 -9 ]
[.5 .40687 3 0 ]
[.7381 .40687 -9 -9 ]
[.7381 .40687 9 0 ]
[.97619 .40687 -3 -9 ]
[.97619 .40687 3 0 ]
[.01131 .05112 -24 -4.5 ]
[.01131 .05112 0 4.5 ]
[.01131 .17387 -12 -4.5 ]
[.01131 .17387 0 4.5 ]
[.01131 .29662 -24 -4.5 ]
[.01131 .29662 0 4.5 ]
[.01131 .54212 -18 -4.5 ]
[.01131 .54212 0 4.5 ]
[ 0 0 0 0 ]
[ 1 .61803 0 0 ]
] MathScale
% Start of Graphics
1 setlinecap
1 setlinejoin
newpath
0 g
.25 Mabswid
[ ] 0 setdash
.2619 .41937 m
.2619 .42562 L
s
[(0.5)] .2619 .40687 0 1 Mshowa
.5 .41937 m
.5 .42562 L
s
[(1)] .5 .40687 0 1 Mshowa
.7381 .41937 m
.7381 .42562 L
s
[(1.5)] .7381 .40687 0 1 Mshowa
.97619 .41937 m
.97619 .42562 L
s
[(2)] .97619 .40687 0 1 Mshowa
.125 Mabswid
.07143 .41937 m
.07143 .42312 L
s
.11905 .41937 m
.11905 .42312 L
s
.16667 .41937 m
.16667 .42312 L
s
.21429 .41937 m
.21429 .42312 L
s
.30952 .41937 m
.30952 .42312 L
s
.35714 .41937 m
.35714 .42312 L
s
.40476 .41937 m
.40476 .42312 L
s
.45238 .41937 m
.45238 .42312 L
s
.54762 .41937 m
.54762 .42312 L
s
.59524 .41937 m
.59524 .42312 L
s
.64286 .41937 m
.64286 .42312 L
s
.69048 .41937 m
.69048 .42312 L
s
.78571 .41937 m
.78571 .42312 L
s
.83333 .41937 m
.83333 .42312 L
s
.88095 .41937 m
.88095 .42312 L
s
.92857 .41937 m
.92857 .42312 L
s
.25 Mabswid
0 .41937 m
1 .41937 L
s
.02381 .05112 m
.03006 .05112 L
s
[(-1.5)] .01131 .05112 1 0 Mshowa
.02381 .17387 m
.03006 .17387 L
s
[(-1)] .01131 .17387 1 0 Mshowa
.02381 .29662 m
.03006 .29662 L
s
[(-0.5)] .01131 .29662 1 0 Mshowa
.02381 .54212 m
.03006 .54212 L
s
[(0.5)] .01131 .54212 1 0 Mshowa
.125 Mabswid
.02381 .07567 m
.02756 .07567 L
s
.02381 .10022 m
.02756 .10022 L
s
.02381 .12477 m
.02756 .12477 L
s
.02381 .14932 m
.02756 .14932 L
s
.02381 .19842 m
.02756 .19842 L
s
.02381 .22297 m
.02756 .22297 L
s
.02381 .24752 m
.02756 .24752 L
s
.02381 .27207 m
.02756 .27207 L
s
.02381 .32117 m
.02756 .32117 L
s
.02381 .34572 m
.02756 .34572 L
s
.02381 .37027 m
.02756 .37027 L
s
.02381 .39482 m
.02756 .39482 L
s
.02381 .44392 m
.02756 .44392 L
s
.02381 .46847 m
.02756 .46847 L
s
.02381 .49302 m
.02756 .49302 L
s
.02381 .51757 m
.02756 .51757 L
s
.02381 .02657 m
.02756 .02657 L
s
.02381 .00202 m
.02756 .00202 L
s
.02381 .56667 m
.02756 .56667 L
s
.02381 .59122 m
.02756 .59122 L
s
.02381 .61577 m
.02756 .61577 L
s
.25 Mabswid
.02381 0 m
.02381 .61803 L
s
0 0 m
1 0 L
1 .61803 L
0 .61803 L
closepath
clip
newpath
.5 Mabswid
.02381 .55558 m
.06244 .53645 L
.10458 .51323 L
.14415 .48891 L
.18221 .46335 L
.22272 .4344 L
.26171 .40592 L
.30316 .37637 L
.34309 .34973 L
.3815 .32637 L
.42237 .30401 L
.46172 .28466 L
.49955 .26766 L
.53984 .25079 L
.57861 .23531 L
.61984 .21916 L
.65954 .20344 L
.69774 .18774 L
.73838 .16992 L
.77751 .15119 L
.81909 .12899 L
.85916 .10477 L
.89771 .07837 L
.93871 .04671 L
.97619 .01472 L
s
.02381 .41937 m
.06244 .43609 L
.10458 .45292 L
.14415 .46607 L
.16408 .47134 L
.18221 .47521 L
.20178 .47831 L
.20694 .47893 L
.21254 .47951 L
.2178 .47996 L
.22272 .48031 L
.22726 .48055 L
.2296 .48066 L
.23216 .48075 L
.2336 .48079 L
.23494 .48082 L
.23633 .48085 L
.23759 .48087 L
.23882 .48088 L
.23999 .48089 L
.24122 .4809 L
.24192 .4809 L
.24255 .4809 L
.24377 .48089 L
.24508 .48088 L
.24631 .48086 L
.24743 .48085 L
.25018 .48078 L
.25278 .4807 L
.25795 .48047 L
.26358 .48012 L
.27298 .47932 L
.28336 .4781 L
.30437 .47463 L
.32371 .47031 L
.34457 .46455 L
.38571 .45043 L
.42533 .43437 L
.46344 .41787 L
.504 .40047 L
.54305 .38511 L
.58454 .37143 L
.60535 .3659 L
.62453 .3617 L
.64321 .3585 L
.65275 .35722 L
.66299 .3561 L
.66824 .35564 L
.67322 .35526 L
.67807 .35496 L
Mistroke
.68257 .35474 L
.68681 .35458 L
.68918 .35451 L
.69133 .35446 L
.69369 .35441 L
.69503 .3544 L
.69625 .35439 L
.69733 .35438 L
.6985 .35437 L
.69973 .35437 L
.70088 .35438 L
.70215 .35438 L
.70279 .35439 L
.70349 .3544 L
.7059 .35443 L
.70726 .35445 L
.70872 .35449 L
.71136 .35456 L
.71653 .35475 L
.72127 .35498 L
.73032 .35558 L
.73984 .35642 L
.75962 .35881 L
.778 .36174 L
.8171 .36982 L
.85865 .3801 L
.89868 .39016 L
.9372 .39843 L
.95615 .40154 L
.97619 .40388 L
Mfstroke
.02381 .28226 m
.06244 .30291 L
.10458 .33166 L
.14415 .36411 L
.18221 .39919 L
.22272 .43881 L
.26171 .4768 L
.30316 .51433 L
.34309 .54549 L
.3815 .56948 L
.40095 .57917 L
.42237 .5879 L
.44268 .5943 L
.46172 .59869 L
.4721 .60046 L
.48196 .60173 L
.49082 .60255 L
.49583 .60288 L
.50049 .60311 L
.50313 .6032 L
.50556 .60326 L
.50684 .60328 L
.50823 .6033 L
.50894 .60331 L
.50969 .60331 L
.51041 .60332 L
.51106 .60332 L
.51233 .60332 L
.5135 .60331 L
.5148 .6033 L
.51545 .60329 L
.51617 .60328 L
.51867 .60322 L
.52101 .60315 L
.52568 .60296 L
.52997 .60272 L
.53962 .60194 L
.54942 .60085 L
.55854 .59958 L
.57924 .59577 L
.5997 .59085 L
.61829 .58546 L
.65827 .57117 L
.69674 .55424 L
.73765 .53298 L
.77706 .50928 L
.81494 .48327 L
.85528 .45165 L
.89411 .41692 L
.93539 .3748 L
Mistroke
.97515 .32879 L
.97619 .32751 L
Mfstroke
% End of Graphics
MathPictureEnd
\
\>"], "Graphics",
 ImageSize->{288, 177.938},
 ImageMargins->{{43, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 
  1}},ImageCache->GraphicsData["CompressedBitmap", "\<\
eJy1Wm1olWUYfj1n53iO+/JjOrfUnTnN2TQt52bzIye1DdNRyNKM4ZYfbOp0
zC3dbCgry8y+pEISS4t+FEQUERQRERQREVFEREFRhPQFFYXUn7X3ft9dz3te
r/s5Z9P24z33ue7rvu7nec77fG9je2/Hzq723s7t7anGnvbujs7tB1IN+3tG
oOgEx5mQchzn1ZTj2sMjpv+Qv3L34X8Zp32V+xEZHpXMCaBOFLD7TZ7R/8//
L8FiOv0fgsV1+kXUMxmu+EVCT+pKfxNskk7/i2C5Ov1PFKvAI010P2IuEIEr
B1aMSPxBMF8sSVySYEQygCFHiPo7wQp15UkEM5VgYpP95NHRUsjLHtHKk7C2
w2/wTtPLmCAYS/UrwXxZUwqpcFQr7S8EK/Ik2JvwM8Gm6/SfCDZDp19AoUsC
JAEuEHqJrvQjwUp1+g/IM1snfU8wC/07aKZ00rcEC9IlnpHKdc1vEDhPJ31N
MAv9K2gu0ElfgrRQJ30BUpVO+hykxeHG+AzWEj3+U4JZ6J9A83qd9DFI1Trp
I5BqdNKHIK3QSR+AVBdugvdhrdLj3wNpjU56F6S1OukdkNZ5JBliYhgSQ/S3
Qb/Jo08nJBb4FgIbMgQK6U1YTR493/3I0QY6lvENSKwfW1FfR+AGL7AIABv0
X4O3WW/mV9ynQLfqpJehtEknvQSllgBJol6EtUWPfwHxW3XScyC16qRzSNem
k85C6S6d9DRIO8N1Og1Xhx7/JOh7dNIpKHXppEdB6tZJDyPdAZ30EEh9OulB
kA6GK34cVr8efwykwzppCHUa1ElHoXRUJw1CaUgnDYB0LFyn/vTa8fi7QTqh
k3pBOqmTekB6JEAyv664HvNcZkmVQyzW78WxF5RTno6ytk1wmI1lZr3aAesJ
q3iuVSUGawesp/xIsuqN8BxJa1vE4W2DddpaZrYyti+4W4nXz5HtephtD7Yg
9ownxt4k1sItCDyrB+aBtAnWswG6AIUksBne87o6C7wFgc/rgZNBWk+8Zwhm
2RdPJdjNocbJetc8jWDrIPYM8U7UxczEXU+8rGQJXWwGwVYhwbkMYkKaSUg3
wHueeC2nAkyslmCsZJbTgxKCVaOMt7vWVNeqIzzLKUMpJJYRr7ztCReSlynp
WksJL09PMItg1yKprORkVVsB6xoSka8nmE2wKiSQfiSjnGxq4q41L0MCCSwj
pIUEa3SfAtUiFYst0GvA6FejICbBGiQoJRGFeoIUwaYiAZtY2Sgte7kYBkYp
yFxg7EyqCDy2xo/Daxl3ygnmnQ0pc3ksDMtHYAtJuoZIVRKvMkkWu5/CnKIG
ZT0YzkVzKfXKBaGGhCdQlkXEy2bWmahyHvGyBYDl99H7El9amJ6iLlWWaLU0
/VK0WTuzBYFlipxPsDxL6QPnB2S/KtB1WunZz56DnkN/t0sKEfwhAgdD2tom
iRw1wMxefhksszqTYSeW/tZZ3l2WnnX1OiTYTbwRJLWMYax7mjFsJay9Wvsn
MtSFDe6TCWYWBl3EO1NPoM5r5sBJrH2EZzl1rSIY6wYrkGA/8frntEX+V/dg
x3H/zNYs23N9hoW7qoN3mXSjLPTGVBbzio+z9JdT8/HGOmNoccsAF9EmBjbB
M0xWTVFtslhNMDYjsDHBWurhtOPq9HFw1LccVh/RmKPLmwVKuEu6rV6NGveB
Zzn4j4O+AHQzsh4kERYxM0VWkIo7/uJblA+R8LkB5YjXiUcttgRkE49ZOfcT
b4Ve9AIU3aRnXbwS3gHitdyGTEGCYuJli4F5iDhMvPP1VEUIZNte1i3L3Kf8
WvegfpV6gmKQCmHlE14pZI9oTWnZLQrEpoICgs1AxBDxBu+WzJWdlMycY7ED
h2nw3gtrkV5ueU1lKcCGjHx47yNei6xZYzvpR2v2RbykOk68wQuyLDYs0g/i
bBD1JsKRhzmWXpqhdVibFLjQ48RrEZuDjHOI9yS8y3QJtvUuI9gJggVlJc8s
WBWE/gC8lju+EpDM9vl+wrNImJ7Jlmusa9TqYtMhtph4j8Bbp0uY/sPOXQYJ
ZhFjHZTtVwaQdLUuZs4qlxMvm56CYoENL/ltxGsuHNbqpTAz3Eri7SGYRczs
edYQbzfB6nUxtlK7EQn2wfIvbMd+0ZEISaR7O+H1L3Yv/wbEbNEbiXcXvE3W
hNneiqyHtSMds99dWO6FRr3NxLsN3g2Zc2Sxbhap2yDaGkquX42IZe4wtgCz
XFBvJpi517BcWptLFlPUFp2+FaSNsDYH6Op9UBO8d+jqpo0aYN2p07eBVI82
styKt4O+GlabTt8OzVpYlpvyXSDJMC2vzSV35rthyXJKVheduuYeKJW5VhzD
BqfvB70YVq9OlyvyYhc6pJOGvWpdOX8Ebv//S8W+Av+96kz4D+nNjAg=\
\>"],ImageRangeCache->{{{0, 287}, {176.938, 0}} -> {-0.215729, -1.80421, \
0.00789457, 0.0153127}}],

Cell[BoxData[
 TagBox[
  RowBox[{"\[SkeletonIndicator]", "Graphics", "\[SkeletonIndicator]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"KEs", "+", "PEs", "+", 
        RowBox[{"4", "PEsp"}]}], "}"}], "/.", "parms"}], " ", "/.", " ", 
     "trajectory"}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0.", ",", "2."}], "}"}]}], "]"}]], "Input"],

Cell[GraphicsData["PostScript", "\<\
%!
%%Creator: Mathematica
%%AspectRatio: .61803 
MathPictureStart
/Mabs {
Mgmatrix idtransform
Mtmatrix dtransform
} bind def
/Mabsadd { Mabs
3 -1 roll add
3 1 roll add
exch } bind def
%% Graphics
%%IncludeResource: font Courier
%%IncludeFont: Courier
/Courier findfont 10  scalefont  setfont
% Scaling calculations
0.0238095 0.47619 -13.6669 8.39777 [
[.2619 .59682 -9 -9 ]
[.2619 .59682 9 0 ]
[.5 .59682 -3 -9 ]
[.5 .59682 3 0 ]
[.7381 .59682 -9 -9 ]
[.7381 .59682 9 0 ]
[.97619 .59682 -3 -9 ]
[.97619 .59682 3 0 ]
[.01131 .02147 -24 -4.5 ]
[.01131 .02147 0 4.5 ]
[.01131 .10545 -24 -4.5 ]
[.01131 .10545 0 4.5 ]
[.01131 .18943 -24 -4.5 ]
[.01131 .18943 0 4.5 ]
[.01131 .27341 -24 -4.5 ]
[.01131 .27341 0 4.5 ]
[.01131 .35738 -24 -4.5 ]
[.01131 .35738 0 4.5 ]
[.01131 .44136 -24 -4.5 ]
[.01131 .44136 0 4.5 ]
[.01131 .52534 -24 -4.5 ]
[.01131 .52534 0 4.5 ]
[ 0 0 0 0 ]
[ 1 .61803 0 0 ]
] MathScale
% Start of Graphics
1 setlinecap
1 setlinejoin
newpath
0 g
.25 Mabswid
[ ] 0 setdash
.2619 .60932 m
.2619 .61557 L
s
[(0.5)] .2619 .59682 0 1 Mshowa
.5 .60932 m
.5 .61557 L
s
[(1)] .5 .59682 0 1 Mshowa
.7381 .60932 m
.7381 .61557 L
s
[(1.5)] .7381 .59682 0 1 Mshowa
.97619 .60932 m
.97619 .61557 L
s
[(2)] .97619 .59682 0 1 Mshowa
.125 Mabswid
.07143 .60932 m
.07143 .61307 L
s
.11905 .60932 m
.11905 .61307 L
s
.16667 .60932 m
.16667 .61307 L
s
.21429 .60932 m
.21429 .61307 L
s
.30952 .60932 m
.30952 .61307 L
s
.35714 .60932 m
.35714 .61307 L
s
.40476 .60932 m
.40476 .61307 L
s
.45238 .60932 m
.45238 .61307 L
s
.54762 .60932 m
.54762 .61307 L
s
.59524 .60932 m
.59524 .61307 L
s
.64286 .60932 m
.64286 .61307 L
s
.69048 .60932 m
.69048 .61307 L
s
.78571 .60932 m
.78571 .61307 L
s
.83333 .60932 m
.83333 .61307 L
s
.88095 .60932 m
.88095 .61307 L
s
.92857 .60932 m
.92857 .61307 L
s
.25 Mabswid
0 .60932 m
1 .60932 L
s
.02381 .02147 m
.03006 .02147 L
s
[(1.63)] .01131 .02147 1 0 Mshowa
.02381 .10545 m
.03006 .10545 L
s
[(1.64)] .01131 .10545 1 0 Mshowa
.02381 .18943 m
.03006 .18943 L
s
[(1.65)] .01131 .18943 1 0 Mshowa
.02381 .27341 m
.03006 .27341 L
s
[(1.66)] .01131 .27341 1 0 Mshowa
.02381 .35738 m
.03006 .35738 L
s
[(1.67)] .01131 .35738 1 0 Mshowa
.02381 .44136 m
.03006 .44136 L
s
[(1.68)] .01131 .44136 1 0 Mshowa
.02381 .52534 m
.03006 .52534 L
s
[(1.69)] .01131 .52534 1 0 Mshowa
.125 Mabswid
.02381 .03827 m
.02756 .03827 L
s
.02381 .05506 m
.02756 .05506 L
s
.02381 .07186 m
.02756 .07186 L
s
.02381 .08866 m
.02756 .08866 L
s
.02381 .12225 m
.02756 .12225 L
s
.02381 .13904 m
.02756 .13904 L
s
.02381 .15584 m
.02756 .15584 L
s
.02381 .17263 m
.02756 .17263 L
s
.02381 .20622 m
.02756 .20622 L
s
.02381 .22302 m
.02756 .22302 L
s
.02381 .23982 m
.02756 .23982 L
s
.02381 .25661 m
.02756 .25661 L
s
.02381 .2902 m
.02756 .2902 L
s
.02381 .307 m
.02756 .307 L
s
.02381 .32379 m
.02756 .32379 L
s
.02381 .34059 m
.02756 .34059 L
s
.02381 .37418 m
.02756 .37418 L
s
.02381 .39098 m
.02756 .39098 L
s
.02381 .40777 m
.02756 .40777 L
s
.02381 .42457 m
.02756 .42457 L
s
.02381 .45816 m
.02756 .45816 L
s
.02381 .47495 m
.02756 .47495 L
s
.02381 .49175 m
.02756 .49175 L
s
.02381 .50854 m
.02756 .50854 L
s
.02381 .54214 m
.02756 .54214 L
s
.02381 .55893 m
.02756 .55893 L
s
.02381 .57573 m
.02756 .57573 L
s
.02381 .59252 m
.02756 .59252 L
s
.02381 .00468 m
.02756 .00468 L
s
.25 Mabswid
.02381 0 m
.02381 .61803 L
s
0 0 m
1 0 L
1 .61803 L
0 .61803 L
closepath
clip
newpath
.5 Mabswid
.02381 .01472 m
.02499 .01474 L
.02605 .01484 L
.02729 .01503 L
.02846 .01528 L
.03053 .01591 L
.03279 .01686 L
.03527 .01821 L
.0379 .01999 L
.04262 .0241 L
.05205 .03575 L
.06244 .05366 L
.0842 .10664 L
.10458 .17154 L
.14335 .31549 L
.16306 .38743 L
.18458 .4559 L
.19454 .48219 L
.20517 .50553 L
.21519 .52261 L
.21953 .5284 L
.22428 .53362 L
.22916 .53768 L
.23182 .53936 L
.23431 .54056 L
.2355 .54102 L
.23664 .54138 L
.23767 .54165 L
.23876 .54187 L
.23995 .54203 L
.24105 .54211 L
.24223 .54212 L
.24353 .54204 L
.24484 .54186 L
.2455 .54173 L
.24623 .54156 L
.2487 .54077 L
.25009 .54017 L
.25158 .53942 L
.25427 .53775 L
.25955 .53331 L
.26435 .52797 L
.27433 .513 L
.28354 .49482 L
.30433 .4402 L
.34374 .30224 L
.38162 .16273 L
.4027 .09757 L
.42196 .05229 L
.43149 .03603 L
Mistroke
.43652 .02923 L
.44188 .02338 L
.44453 .02104 L
.44703 .01917 L
.44946 .01766 L
.45169 .01655 L
.45382 .01573 L
.45489 .01541 L
.45606 .01513 L
.45724 .01492 L
.45851 .01478 L
.4597 .01472 L
.46079 .01473 L
.46197 .01482 L
.46308 .01497 L
.4643 .01521 L
.46561 .01556 L
.46828 .01654 L
.47073 .01777 L
.4752 .02084 L
.47991 .02518 L
.48984 .038 L
.50068 .05746 L
.52033 .1057 L
.5413 .17218 L
.58285 .32846 L
.60369 .40711 L
.62288 .47285 L
.6428 .52988 L
.6614 .56974 L
.67047 .58381 L
.67513 .58959 L
.6802 .59474 L
.68308 .59713 L
.68575 .59899 L
.68824 .60044 L
.691 .60169 L
.69219 .60212 L
.69346 .60251 L
.69457 .60279 L
.69578 .60302 L
.69707 .6032 L
.69777 .60326 L
.69843 .6033 L
.6996 .60332 L
.70086 .60327 L
.70209 .60314 L
.70278 .60304 L
.70344 .60293 L
.70476 .60263 L
Mistroke
.70617 .60223 L
.70874 .60126 L
.71108 .60012 L
.71677 .59631 L
.72218 .59138 L
.73181 .57953 L
.74232 .56238 L
.76201 .51991 L
.78299 .46303 L
.82459 .33274 L
.86468 .21287 L
.88307 .16675 L
.90325 .12484 L
.9232 .0928 L
.93422 .07904 L
.94427 .06867 L
.95968 .05659 L
.96816 .05171 L
.97619 .0481 L
Mfstroke
% End of Graphics
MathPictureEnd
\
\>"], "Graphics",
 ImageSize->{288, 177.938},
 ImageMargins->{{43, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 
  1}},ImageCache->GraphicsData["CompressedBitmap", "\<\
eJztnOlzFEUYxifZ3YQghyAg9y63cgmERE4TDkFB8KCQS4lrQJNCDRWwLMvP
XlWW/4THFyir/AuX3XemZnonv559e2baTarkwzD79Ew/79vn02/35Frz6czD
r5tPZ6ebjcvzzcczs9NPGpfm5ttQZSAIBhpBEPzbCDr3rfZtdJF/OzqX6EfO
+y3yX6UV59n+JdeKkT4YJ1cd3spIDyqt6Ea8kQcHY6ZK+GT7rhpjtRib69zV
One/h3lUgGxYrlUTizkWwlXIQVgfdfPL3W/OrJR9pdvbVOqX1sy7sV972CLQ
EHpnMSmFfVHckGVWen1BpbAHceG9BKm/hLkl7Wl5XBRJqdfgRaL/HLAVgP0c
kibdhUq9CdhKwH4yMkslkd2fAbYasB/t2ZK1U36yvQ/YGsB+6FylKIcNAgGo
SX2qzPb7OJcRu93UxIlgLWDfAZZBRb7cA+wVwL6NfVlRnGAdYE8Ay6AaAewO
YOsBmwdspUGV9GQFwQbAHgO2yu4LUd1WUs0BttqN6hZgrwL2DWAvF6faCNhX
gK0xqIyG2P3QTcA25SBIJdHYr6V6BNhaOxV5dQMwencWsLAzq2VQIn5oNixi
3Axg4UDgInBoUiKFQXPdR4BtBYwkkbulYlWtWwqsgtc/BGwbYKSP1vewyqhI
lQKiUvNkH80V6ecCi5lUjB8Ath2wB4CFAyvKuGRZoDXkfcDqgE0DFg67xhhH
IqgsghJ9Iem60U5FXl0DbAdgpEA3LVqq9wDbCdgUYJsNKmkMpDGvArYLMJLC
JgHO6/moSL1ucaO6Atju4lRUgO8qqT4BbKtBJTVEIp0I9gBGQtkkUPjyDmB7
AbsL2LZFQUUFeFlJRep8uxvVJcBeA4zUuUkljYGWUVoCEsp1uy9E9XZxKq1o
TMXOchr3OmAf243zE4sjYy8Cth8wWhE0nI21KlwpYFo6+7RPUb9k0gU/JmlE
Y6vF4TWtmQcAozVOFNW2xv6SklMYch6wg26G0LhA0Y9zJVGJzxSSIIJDgNHC
YqebL5OAHV5SVFSAE4C9ARip810GldQQRXLKIlD48hZgR4pTkVdnlVTXAdtd
nOooYLTS6BOVNAaKtZ0B7BhgtJTZY/eFqE4DNgoYrTSWPhUtavYaVFJDFEE8
BdjxHASpJKI6CdgYYLSo8URFK419IZVWn6bCmwrjTgA27macH326GbA3lRgt
pMo1VsqdGoDWRPv6qIdEza7iIqXmaFIRiUpmUquj1mlfUeWQqFSF1DepD9Nq
JDIkGeYo7F4WQYm+2JcxmC15RTMBzRi0AugTldQQhfi1BLQCOODmCykQkkKT
blTkFampPlNNAHawP1TSGOrwEC0YKDNaAWT4Qns2Wiry79CipaLVI7WxXlRS
Qw3rQ727JnXhw3Zf6v2lolgFjWgZVFrdSFKC5vIiZpK4DxuhiyjTHmejZkIB
L5r4aIIs0VIpe9qG82mfQNpTi1R4FNQkgUKS7YjduIInGT1ZSkJSsKrNEKpP
ivOTeiUxHhmSjHu0mUq7HKTiexEofNFSkYo/uiioqABpd41WuiSjPVFRvOOY
QSWNgXajyyJIJREV7ep6oqIdagr/kIwe7Q+V1BAVEZGW4AvZTS2QIoAkno8X
p6IQKkWoM6ioAGm08ERFEwtFnklGjxlU0hioa5ZFoBgF6oDR3gDp9IhKKySz
N1A9GecnAEnG0uqGNnRolTBeqrFSxjRT0hKZjgySbO9loqKK9/13JhWUjmQp
BWhon5OUeiiycnwiQ7VIXdvREMpCS0UHiElWm1TiH0leCvbSnju9e8LuCz1O
OxxLn4r24ug8CbXokwaV1BBVY1kEihZDW+d09olG31PFqegMGE3/GVTU5egc
hScqOlRDp/RIqp02qKQx0DxFB8PoxCGpWZNAMbjTyUQ6R0kS84ydiryio52e
qOicLx2qJTVrUkkNkfyj89dEQBLzrN0XUlh0Vp7OIjtSkVf0SQYd5iYNFobe
S9omJ+Poe6ApN+M8BDlpnUNfcPmzlJQ/LV/pK0b6cpcE2EQPq5Iq1ZUk2Uda
sgT7CkpUslRiuFLODyGVtNZkyOC+OT4av5FULn0ylkGaDGQi5OUrMfp4jxTI
OSOLVNIfxbP4EzBSDOe9ZvEXYPbzu0Zx/p3jxVQSZUEz8kV7FmOxPVW4S6qc
1h3L49RB27vSSYbs9GFMZ0FXWsYwRcFJbtMISrsklo5MseIFX9uP8btETfmR
3KXPkMlsmvIoUOte7iOxe7S1Yre51pVRlJkx0FFutXzWpR6lJkGie4SzpD9p
YKnZjNJMOlEyMI/HGKmy4TjVWsGpXBY0wGc2LyX1it1aepHKISOL5zEPbUhe
tb/4T+c61IGu2x9qhe5L+roIC9rqstOm1H9hgToTYf+/W/67GV2bjnATRidJ
6LmISn6U8IefgoEXSWKQKw==\
\>"],ImageRangeCache->{{{0, 287}, {176.938, 0}} -> {-0.215729, 1.62464, \
0.00789457, 0.000447656}}],

Cell[BoxData[
 TagBox[
  RowBox[{"\[SkeletonIndicator]", "Graphics", "\[SkeletonIndicator]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KEs", "/.", "parms"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", 
        SubscriptBox["q", "2"]}], "+", 
       SubsuperscriptBox["q", "2", "2"]}], ")"}], " ", 
     SubsuperscriptBox["u", "1", "2"]}], "+", 
    SubsuperscriptBox["u", "2", "2"]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], ",", 
       RowBox[{"q", "[", "3", "]"}], ",", 
       RowBox[{"q", "[", "4", "]"}], ",", 
       RowBox[{"q", "[", "5", "]"}]}], "}"}], "/.", "trajectorya"}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0.", ",", "2."}], "}"}]}], "]"}]], "Input"],

Cell[GraphicsData["PostScript", "\<\
%!
%%Creator: Mathematica
%%AspectRatio: .61803 
MathPictureStart
/Mabs {
Mgmatrix idtransform
Mtmatrix dtransform
} bind def
/Mabsadd { Mabs
3 -1 roll add
3 1 roll add
exch } bind def
%% Graphics
%%IncludeResource: font Courier
%%IncludeFont: Courier
/Courier findfont 10  scalefont  setfont
% Scaling calculations
0.0238095 0.47619 0.358067 0.245252 [
[.2619 .34557 -9 -9 ]
[.2619 .34557 9 0 ]
[.5 .34557 -3 -9 ]
[.5 .34557 3 0 ]
[.7381 .34557 -9 -9 ]
[.7381 .34557 9 0 ]
[.97619 .34557 -3 -9 ]
[.97619 .34557 3 0 ]
[.01131 .11282 -12 -4.5 ]
[.01131 .11282 0 4.5 ]
[.01131 .23544 -24 -4.5 ]
[.01131 .23544 0 4.5 ]
[.01131 .48069 -18 -4.5 ]
[.01131 .48069 0 4.5 ]
[.01131 .60332 -6 -4.5 ]
[.01131 .60332 0 4.5 ]
[ 0 0 0 0 ]
[ 1 .61803 0 0 ]
] MathScale
% Start of Graphics
1 setlinecap
1 setlinejoin
newpath
0 g
.25 Mabswid
[ ] 0 setdash
.2619 .35807 m
.2619 .36432 L
s
[(0.5)] .2619 .34557 0 1 Mshowa
.5 .35807 m
.5 .36432 L
s
[(1)] .5 .34557 0 1 Mshowa
.7381 .35807 m
.7381 .36432 L
s
[(1.5)] .7381 .34557 0 1 Mshowa
.97619 .35807 m
.97619 .36432 L
s
[(2)] .97619 .34557 0 1 Mshowa
.125 Mabswid
.07143 .35807 m
.07143 .36182 L
s
.11905 .35807 m
.11905 .36182 L
s
.16667 .35807 m
.16667 .36182 L
s
.21429 .35807 m
.21429 .36182 L
s
.30952 .35807 m
.30952 .36182 L
s
.35714 .35807 m
.35714 .36182 L
s
.40476 .35807 m
.40476 .36182 L
s
.45238 .35807 m
.45238 .36182 L
s
.54762 .35807 m
.54762 .36182 L
s
.59524 .35807 m
.59524 .36182 L
s
.64286 .35807 m
.64286 .36182 L
s
.69048 .35807 m
.69048 .36182 L
s
.78571 .35807 m
.78571 .36182 L
s
.83333 .35807 m
.83333 .36182 L
s
.88095 .35807 m
.88095 .36182 L
s
.92857 .35807 m
.92857 .36182 L
s
.25 Mabswid
0 .35807 m
1 .35807 L
s
.02381 .11282 m
.03006 .11282 L
s
[(-1)] .01131 .11282 1 0 Mshowa
.02381 .23544 m
.03006 .23544 L
s
[(-0.5)] .01131 .23544 1 0 Mshowa
.02381 .48069 m
.03006 .48069 L
s
[(0.5)] .01131 .48069 1 0 Mshowa
.02381 .60332 m
.03006 .60332 L
s
[(1)] .01131 .60332 1 0 Mshowa
.125 Mabswid
.02381 .13734 m
.02756 .13734 L
s
.02381 .16187 m
.02756 .16187 L
s
.02381 .18639 m
.02756 .18639 L
s
.02381 .21092 m
.02756 .21092 L
s
.02381 .25997 m
.02756 .25997 L
s
.02381 .28449 m
.02756 .28449 L
s
.02381 .30902 m
.02756 .30902 L
s
.02381 .33354 m
.02756 .33354 L
s
.02381 .38259 m
.02756 .38259 L
s
.02381 .40712 m
.02756 .40712 L
s
.02381 .43164 m
.02756 .43164 L
s
.02381 .45617 m
.02756 .45617 L
s
.02381 .50522 m
.02756 .50522 L
s
.02381 .52974 m
.02756 .52974 L
s
.02381 .55427 m
.02756 .55427 L
s
.02381 .57879 m
.02756 .57879 L
s
.02381 .08829 m
.02756 .08829 L
s
.02381 .06377 m
.02756 .06377 L
s
.02381 .03924 m
.02756 .03924 L
s
.02381 .01472 m
.02756 .01472 L
s
.25 Mabswid
.02381 0 m
.02381 .61803 L
s
0 0 m
1 0 L
1 .61803 L
0 .61803 L
closepath
clip
newpath
.5 Mabswid
.02381 .49413 m
.06244 .47336 L
.10458 .44553 L
.14415 .41561 L
.18221 .38454 L
.22272 .35034 L
.26171 .31767 L
.30316 .28469 L
.34309 .25597 L
.3815 .23231 L
.40095 .22213 L
.42237 .21246 L
.44292 .20482 L
.46172 .1993 L
.471 .19712 L
.48113 .19515 L
.48668 .19425 L
.49183 .19354 L
.49713 .19292 L
.502 .19246 L
.50708 .1921 L
.50975 .19195 L
.51257 .19182 L
.51376 .19178 L
.51503 .19174 L
.51612 .19171 L
.51732 .19169 L
.51804 .19168 L
.51872 .19167 L
.51936 .19166 L
.52004 .19166 L
.52122 .19166 L
.52253 .19166 L
.5237 .19167 L
.52494 .19168 L
.52599 .1917 L
.52714 .19173 L
.52972 .19181 L
.53212 .19191 L
.53648 .19216 L
.54113 .19251 L
.54646 .19303 L
.55138 .19361 L
.56248 .19532 L
.57227 .19726 L
.58263 .19974 L
.62052 .21253 L
.63997 .22124 L
.66086 .23208 L
.70214 .25753 L
Mistroke
.7419 .28619 L
.78014 .31648 L
.82084 .3503 L
.86002 .38304 L
.90166 .41653 L
.94177 .44613 L
.97619 .46844 L
Mfstroke
.02381 .22109 m
.06244 .24157 L
.10458 .26906 L
.14415 .29867 L
.18221 .32943 L
.22272 .36331 L
.26171 .39567 L
.30316 .42833 L
.34309 .45672 L
.3815 .48008 L
.40095 .49011 L
.42237 .49961 L
.44292 .50708 L
.46172 .51245 L
.471 .51456 L
.48113 .51645 L
.48668 .5173 L
.49183 .51798 L
.49713 .51855 L
.502 .51897 L
.50708 .5193 L
.50975 .51943 L
.51111 .51948 L
.51257 .51953 L
.51386 .51956 L
.51503 .51959 L
.5162 .51961 L
.51732 .51962 L
.51861 .51963 L
.51981 .51963 L
.52113 .51963 L
.52179 .51962 L
.52253 .51961 L
.5237 .51959 L
.52494 .51957 L
.52714 .5195 L
.52952 .51941 L
.53212 .51929 L
.53679 .51898 L
.54113 .51862 L
.55166 .51739 L
.56159 .5158 L
.58018 .5117 L
.60019 .50569 L
.61865 .49874 L
.65805 .47966 L
.69594 .4565 L
.73628 .42764 L
.7751 .39689 L
.81638 .36239 L
Mistroke
.85614 .3288 L
.89438 .29747 L
.93508 .26657 L
.97426 .24041 L
.97619 .23924 L
Mfstroke
.02381 .35807 m
.06244 .36802 L
.10458 .37887 L
.14415 .38906 L
.18221 .39886 L
.22272 .40929 L
.26171 .41933 L
.30316 .43 L
.34309 .44029 L
.3815 .45018 L
.42237 .4607 L
.46172 .47083 L
.49955 .48058 L
.53984 .49095 L
.57861 .50094 L
.61984 .51155 L
.65954 .52178 L
.69774 .53161 L
.73838 .54208 L
.77751 .55216 L
.81909 .56286 L
.85916 .57318 L
.89771 .58311 L
.93871 .59367 L
.97619 .60332 L
s
.02381 .35807 m
.04262 .36078 L
.06244 .36323 L
.08426 .36543 L
.10458 .36702 L
.12297 .36807 L
.13327 .3685 L
.14264 .36879 L
.14747 .3689 L
.15259 .369 L
.15697 .36905 L
.15945 .36908 L
.16066 .36908 L
.16178 .36909 L
.16306 .3691 L
.16374 .3691 L
.16446 .3691 L
.16515 .3691 L
.1658 .3691 L
.16701 .3691 L
.16821 .3691 L
.16931 .3691 L
.17052 .3691 L
.1718 .36909 L
.17308 .36908 L
.17445 .36907 L
.17693 .36905 L
.17988 .36901 L
.18257 .36897 L
.18737 .36887 L
.19248 .36874 L
.20165 .36844 L
.21152 .36802 L
.22241 .36742 L
.24176 .36605 L
.26261 .36413 L
.30375 .35894 L
.34338 .35222 L
.38149 .34415 L
.42205 .33383 L
.46109 .32223 L
.50259 .30808 L
.54257 .29269 L
.58104 .27625 L
.62196 .25701 L
.66136 .23676 L
.69925 .21572 L
.73959 .1916 L
.77841 .16673 L
.81969 .13849 L
Mistroke
.85945 .10956 L
.89769 .08011 L
.93839 .04704 L
.97619 .01472 L
Mfstroke
% End of Graphics
MathPictureEnd
\
\>"], "Graphics",
 ImageSize->{288, 177.938},
 ImageMargins->{{43, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 
  1}},ImageCache->GraphicsData["CompressedBitmap", "\<\
eJzNW1lvVVUUvvTe0olSKJTSQtvbAcrQVuZ5KIqUqWAAU8GJWsACKghIfCDG
GGOMiQ8Y9Tf4YGL0wQdjJAZjUKIkRInBCSOOcVbi9IA96xy+de7hW6v3Eh4k
6e3qt7611l777L3v2nsfevuPDO6+v//I3oH+bM+h/oODewcOZ9ccODQEpUek
UiOyqVTq5WwqkC8PidGH/GsOPqI/rlGeJL/Sl+Fz6C/5TF9HfVGg/pcwi20n
fxNspE3/i2AlNv1PgpXa9EvIosIm/UEwh/47wUYlO42RKm2fvxJstE3/hWBV
Nv1ngo2x6T8ii3E26QeCxeliz0jjbZ/fE6zGpn9HsAk2/Rs0q84mfU0wh/4V
wept+kWCTUp22peQGm1PXxDMoV8gWJNN/5xgWZv+KVrcGpJkIBQHQJrQPyFY
ZFhDVMzFxwRrG8aFNPA8pPaQLpMyEwCZPGN/RLD2wpp/Dq2YERqOB1BM6B8S
LDJkj+MDgs206WcRuytGEuAsoXfZns7AcLZNep9gDv09gs2x6afRhPk26V2C
OfR3CLYg2VWnIC22Pb1NMIf+Fnwus0knCebQ34TPlTbpBEirknmeIPRVtqfX
YbjaJj0UfNYFUCfROoaH4b0O0nRIPbbhgeBTZn1DIImyDYbrbMP9MGyD1AjD
DbbhXpA6YDgRWG+ym+9Fs+ZAGgftZjvOLpAWQRpDeI6Le2C4DNIoSFtihmK3
E6puSKWQtoV0BTJEYoueKO4AZbVLjqKEhWMmrkJrrobZgl9EsD6EXmu1s8+N
X2EFSnTDrZA2QNoe+UhfcRb8hEGLeLQyt6eKod1CtOugZR2xyfJnZl5GLFi3
lxCsF21Zn5uRSBshReW/jrDyQEpbT7g010VCuxZa7cZ1lhc+fcottwmsBwEq
iVbHu7MVqQBpDSTNYAykGxOhqLNKkG4iWg0wnmhXWP7iaxpbhlZAq91RC2lZ
wpa2W9NcTrQ3Q8tsF1n+OL3acpF4Bo2Et4BgY+1QutgvIAGaIc2D5GysWF06
h2Dy4AWaQrSzCOYEnUCwG9BaHd/TCa/LTCI2nvTrk9FXIZcO8Fh54ewY6wg2
g2D6vTebaFl+tXbQeoK1I0A3sppHeFPBczah2oFTiXY5AujAZoPBCdBAsBaC
6exmE7fZajoPyqZclmBLkF830TYRbLIdtAkZMMNFCLXachuzjT0X1ln10Kpb
XerNxnEVC6DLaAYBdN88F1KiEhGebJ5kv8/KGrYDriWYzEQpIZzzwlaChSdl
Rn1XnANHKlredCJvVjgtJJhR9bCE2RLMOsE5+9QNipEwi8tSmYFES/NMlNU0
rAur0USWgPNY2VJUwbNkcXWwyWorNqzqZrlpQTgS0ljCm2z2Ls2o3ezGkcmM
rvxmVbCsvQJVFZJPHvU1qzonRb2ZaGD8wZnf2ZJcBqMqjZUsjR5N7Eu1UGdt
Zs+vAbbOPNETAOZCB8geomUblnY71Mw8+3oqgu7P02KaHbSDYGyatyLoQfSI
bqCcE0FWJrG1pSn4lPX1aNQIttR22oG6HLMGOD+WsAy0zimk1JgCSYEos+0x
M8uwghWnleLZ2NOlojOQPBZGXVDYUiVPoNSa7mz8sRgM+z/ZhitGJvlkzVmZ
b3xnwRWVREyUKPJc5TGL9ByxZQcF0+1QZQglY6JG18hc3vPImS1wzhTXWwm2
HWAD51mrmRLeCSULs0A1oLMn9AzB2IyYEgtVBLeSCzsA0IPF40Q7mmBtdi4T
EYplwL5AnyYYa2arHXQyOpA9F1ZJPIWc9d7HCdCEAFpds3LySYKxTXjWDtWC
DmSGTxBsotVgb+dx1boggB55PA6JFV3OPSfbNMrElG8BNgAeJRjbwDbEgkrL
spCqkAGbD49YHSS2cbc0zVxMukigcrg4BqmNWBS4T69FLmzFephg7HDAuTHX
DmxELmzpPEowPQZxArAFsxlZ6Y72CCRWTxV4KqT1Xey7J/j1ICGz8so53OqE
7wPEUE/UnDcl2GSeBbf74IKdKVXbbtkiNDeBhV0y9LGbkOcTLK8z0YWQ0khj
J7FQnuOWneouJpgUCVKR7iDaJQRzXuHxT61LkdU28PSo3HHLljg1HAW3mwmv
m2DxyweNbd4SaN2ynmj1GqLAOw2tUfQ4v8fqtgJvZcRZNQJ0A9NbJ8et1vq9
RFuN7lhKtOz+KapvC78uZbXHJljo0dp8YP6dZQF3prqn3ApJli+ZK13AtrsB
870k7SO8eqQ3Dbzb3Wj+JSnbt90Gi0ZEawF25/DR8thyqCstMcSZHhbfHbo0
bztF6odWD2D0Vq0/dMGG8wDoaqhnegO24Z5cQ63BY2v/MO9FtIGu53CDMUMB
7gNJ6FLW7bO9PwDDVkgpcpU+aLuQsxMZyTrKSiDtsg3lrZYSPKKyQKpCo++y
DaWgK88daTts+gvokr5kb70I+622/Uuwv8UmvQJPG23SqyCttUmvgeS82PMG
On2lTToJT0uTiZ+CaqFtfxqkuTbpDHpnlk06C08dNukcSM5u/DzCXbWP/gyq
Ftv+AoI4u6SLIDm7g2+DTxmqzh3vT/AU3Zr7b37+hhSilwPyfWHyEuKUDWMo
XfUPpJLC4lwOG3jNNv57nHEm6824XuTr8P8EUiP+A2pG3t8=\
\>"],ImageRangeCache->{{{0, 287}, {176.938, 0}} -> {-0.215729, -1.55159, \
0.00789457, 0.0153284}}],

Cell[BoxData[
 TagBox[
  RowBox[{"\[SkeletonIndicator]", "Graphics", "\[SkeletonIndicator]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"KEa", "+", "PEa", "+", "PEsp"}], "}"}], "/.", 
       RowBox[{
        RowBox[{"q", "[", "2", "]"}], "\[Rule]", "0"}]}], "/.", "parms"}], 
     " ", "/.", " ", "trajectorya"}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0.", ",", "2."}], "}"}]}], "]"}]], "Input"],

Cell[GraphicsData["PostScript", "\<\
%!
%%Creator: Mathematica
%%AspectRatio: .61803 
MathPictureStart
/Mabs {
Mgmatrix idtransform
Mtmatrix dtransform
} bind def
/Mabsadd { Mabs
3 -1 roll add
3 1 roll add
exch } bind def
%% Graphics
%%IncludeResource: font Courier
%%IncludeFont: Courier
/Courier findfont 10  scalefont  setfont
% Scaling calculations
0.0238095 0.47619 -7.72528e+013 4.54429e+014 [
[.2619 .04688 -9 -9 ]
[.2619 .04688 9 0 ]
[.5 .04688 -3 -9 ]
[.5 .04688 3 0 ]
[.7381 .04688 -9 -9 ]
[.7381 .04688 9 0 ]
[.97619 .04688 -3 -9 ]
[.97619 .04688 3 0 ]
[.01131 .15625 -24 -4.5 ]
[.01131 .15625 0 4.5 ]
[.01131 .25 -24 -4.5 ]
[.01131 .25 0 4.5 ]
[.01131 .34375 -24 -4.5 ]
[.01131 .34375 0 4.5 ]
[.01131 .42188 -24 -4.5 ]
[.01131 .42188 0 4.5 ]
[.01131 .53125 -24 -4.5 ]
[.01131 .53125 0 4.5 ]
[.01131 .625 -24 -4.5 ]
[.01131 .625 0 4.5 ]
[ 0 0 0 0 ]
[ 1 .625 0 0 ]
] MathScale
% Start of Graphics
1 setlinecap
1 setlinejoin
newpath
0 g
.25 Mabswid
[ ] 0 setdash
.2619 .0625 m
.2619 .0625 L
s
[(0.5)] .2619 .04688 0 1 Mshowa
.5 .0625 m
.5 .0625 L
s
[(1)] .5 .04688 0 1 Mshowa
.7381 .0625 m
.7381 .0625 L
s
[(1.5)] .7381 .04688 0 1 Mshowa
.97619 .0625 m
.97619 .0625 L
s
[(2)] .97619 .04688 0 1 Mshowa
.125 Mabswid
.07143 .0625 m
.07143 .0625 L
s
.11905 .0625 m
.11905 .0625 L
s
.16667 .0625 m
.16667 .0625 L
s
.21429 .0625 m
.21429 .0625 L
s
.30952 .0625 m
.30952 .0625 L
s
.35714 .0625 m
.35714 .0625 L
s
.40476 .0625 m
.40476 .0625 L
s
.45238 .0625 m
.45238 .0625 L
s
.54762 .0625 m
.54762 .0625 L
s
.59524 .0625 m
.59524 .0625 L
s
.64286 .0625 m
.64286 .0625 L
s
.69048 .0625 m
.69048 .0625 L
s
.78571 .0625 m
.78571 .0625 L
s
.83333 .0625 m
.83333 .0625 L
s
.88095 .0625 m
.88095 .0625 L
s
.92857 .0625 m
.92857 .0625 L
s
.25 Mabswid
0 .0625 m
1 .0625 L
s
.02381 .15625 m
.03006 .15625 L
s
[(0.17)] .01131 .15625 1 0 Mshowa
.02381 .25 m
.03006 .25 L
s
[(0.17)] .01131 .25 1 0 Mshowa
.02381 .34375 m
.03006 .34375 L
s
[(0.17)] .01131 .34375 1 0 Mshowa
.02381 .42188 m
.03006 .42188 L
s
[(0.17)] .01131 .42188 1 0 Mshowa
.02381 .53125 m
.03006 .53125 L
s
[(0.17)] .01131 .53125 1 0 Mshowa
.02381 .625 m
.03006 .625 L
s
[(0.17)] .01131 .625 1 0 Mshowa
.125 Mabswid
.02381 .09375 m
.02756 .09375 L
s
.02381 .09375 m
.02756 .09375 L
s
.02381 .125 m
.02756 .125 L
s
.02381 .14063 m
.02756 .14063 L
s
.02381 .1875 m
.02756 .1875 L
s
.02381 .20313 m
.02756 .20313 L
s
.02381 .23438 m
.02756 .23438 L
s
.02381 .23438 m
.02756 .23438 L
s
.02381 .28125 m
.02756 .28125 L
s
.02381 .29688 m
.02756 .29688 L
s
.02381 .3125 m
.02756 .3125 L
s
.02381 .32813 m
.02756 .32813 L
s
.02381 .35938 m
.02756 .35938 L
s
.02381 .375 m
.02756 .375 L
s
.02381 .40625 m
.02756 .40625 L
s
.02381 .42188 m
.02756 .42188 L
s
.02381 .45313 m
.02756 .45313 L
s
.02381 .46875 m
.02756 .46875 L
s
.02381 .48438 m
.02756 .48438 L
s
.02381 .5 m
.02756 .5 L
s
.02381 .54688 m
.02756 .54688 L
s
.02381 .5625 m
.02756 .5625 L
s
.02381 .59375 m
.02756 .59375 L
s
.02381 .60938 m
.02756 .60938 L
s
.02381 .03125 m
.02756 .03125 L
s
.02381 .01563 m
.02756 .01563 L
s
.25 Mabswid
.02381 0 m
.02381 .625 L
s
0 0 m
1 0 L
1 .625 L
0 .625 L
closepath
clip
newpath
.5 Mabswid
.02499 .625 m
.02499 .35938 L
.02605 .35938 L
.02721 .34375 L
.02846 .35938 L
.02961 .35938 L
.03068 .34375 L
.0317 .35938 L
.03279 .34375 L
.03395 .34375 L
.0352 .34375 L
.03638 .34375 L
.03746 .35938 L
.03873 .35938 L
.03944 .34375 L
.04011 .34375 L
.04262 .34375 L
.06244 .34375 L
.10458 .34375 L
.14371 .34375 L
.18529 .34375 L
.22536 .34375 L
.26391 .34375 L
.27334 .34375 L
.27464 .34375 L
.27538 .34375 L
.27606 .35938 L
.27731 .34375 L
.27794 .34375 L
.27863 .34375 L
.27983 .34375 L
.28112 .34375 L
.28234 .34375 L
.28346 .35938 L
.2841 .35938 L
.28479 .34375 L
.28604 .35938 L
.2868 .35938 L
.28752 .35938 L
.28886 .35938 L
.29455 .35938 L
.29952 .35938 L
.30023 .34375 L
.30089 .34375 L
.30157 .34375 L
.30233 .35938 L
.30357 .34375 L
.30427 .34375 L
.30491 .34375 L
.30619 .35938 L
Mistroke
.30735 .35938 L
.30994 .35938 L
.3146 .35938 L
.32517 .35938 L
.3444 .35938 L
.3456 .34375 L
.34674 .35938 L
.34806 .34375 L
.34926 .34375 L
.35161 .34375 L
.35378 .34375 L
.35488 .34375 L
.35605 .35938 L
.35722 .34375 L
.35851 .35938 L
.35979 .34375 L
.36052 .34375 L
.36118 .34375 L
.3624 .35938 L
.36368 .35938 L
.36498 .35938 L
.3662 .34375 L
.36687 .34375 L
.3676 .34375 L
.36887 .35938 L
.36962 .35938 L
.3704 .34375 L
.37107 .34375 L
.37181 .35938 L
.37249 .35938 L
.37322 .34375 L
.37454 .34375 L
.38452 .34375 L
.39468 .34375 L
.40003 .34375 L
.40297 .34375 L
.40573 .34375 L
.40812 .34375 L
.40877 .34375 L
.40946 .34375 L
.4107 .32813 L
.41135 .34375 L
.41205 .32813 L
.41331 .34375 L
.41408 .32813 L
.41481 .34375 L
.41547 .35938 L
.41618 .32813 L
.41734 .34375 L
.41862 .34375 L
Mistroke
.41926 .32813 L
.41996 .3125 L
.42121 .32813 L
.42245 .32813 L
.42363 .3125 L
.42469 .3125 L
.42585 .3125 L
.4284 .3125 L
.43117 .3125 L
.43244 .29688 L
.43307 .3125 L
.43378 .3125 L
.43502 .29688 L
.43618 .32813 L
.43739 .34375 L
.43854 .3125 L
.43957 .3125 L
.44069 .29688 L
.44191 .3125 L
.44321 .3125 L
.44431 .34375 L
.44553 .29688 L
.44617 .34375 L
.44686 .32813 L
.44758 .32813 L
.44825 .32813 L
.45074 .32813 L
.45148 .32813 L
.45217 .32813 L
.45346 .3125 L
.45418 .3125 L
.45485 .3125 L
.45558 .34375 L
.45636 .3125 L
.45757 .32813 L
.45871 .32813 L
.46129 .32813 L
.46269 .32813 L
.46402 .32813 L
.46521 .32813 L
.46651 .29688 L
.46716 .3125 L
.46785 .29688 L
.46908 .29688 L
.4704 .32813 L
.47115 .29688 L
.47185 .3125 L
.47312 .3125 L
.47427 .3125 L
.47687 .3125 L
Mistroke
.48624 .3125 L
.48753 .29688 L
.48875 .29688 L
.49002 .3125 L
.49069 .29688 L
.49141 .3125 L
.49219 .29688 L
.49294 .29688 L
.49433 .29688 L
.49562 .29688 L
.49635 .28125 L
.49703 .28125 L
.49767 .28125 L
.49836 .29688 L
.49962 .28125 L
.50084 .29688 L
.50197 .29688 L
.50723 .29688 L
.50838 .29688 L
.50964 .28125 L
.51083 .29688 L
.51192 .28125 L
.5132 .28125 L
.51385 .28125 L
.51456 .29688 L
.5158 .28125 L
.51696 .29688 L
.51807 .29688 L
.51924 .28125 L
.52024 .28125 L
.52133 .29688 L
.52251 .28125 L
.52377 .28125 L
.52605 .28125 L
.52734 .29688 L
.528 .28125 L
.52872 .28125 L
.52949 .29688 L
.53022 .29688 L
.53161 .29688 L
.53415 .29688 L
.53488 .29688 L
.53557 .29688 L
.53687 .26563 L
.53805 .26563 L
.53931 .29688 L
.5405 .26563 L
.54157 .29688 L
.54284 .29688 L
.54422 .29688 L
Mistroke
.54551 .29688 L
.54671 .26563 L
.54797 .26563 L
.54917 .26563 L
.55025 .29688 L
.55142 .29688 L
.55269 .26563 L
.55333 .26563 L
.55404 .29688 L
.55529 .29688 L
.55646 .26563 L
.55757 .26563 L
.55875 .26563 L
.55975 .29688 L
.56084 .29688 L
.56202 .26563 L
.56329 .26563 L
.56556 .26563 L
.58623 .26563 L
.58747 .26563 L
.58865 .23438 L
.5893 .29688 L
.59 .26563 L
.59124 .23438 L
.59242 .21875 L
.59367 .23438 L
.59476 .26563 L
.59592 .29688 L
.59712 .26563 L
.59824 .23438 L
.59889 .23438 L
.59958 .23438 L
.60081 .26563 L
.60145 .26563 L
.60213 .26563 L
.60337 .21875 L
.60412 .26563 L
.60484 .26563 L
.60548 .21875 L
.60617 .23438 L
.60687 .29688 L
.60752 .23438 L
.60824 .21875 L
.60901 .26563 L
.60982 .26563 L
.61058 .21875 L
.61127 .26563 L
.61202 .23438 L
.61273 .26563 L
.61337 .23438 L
Mistroke
.61412 .26563 L
.61482 .26563 L
.61607 .23438 L
.61676 .23438 L
.61742 .21875 L
.61867 .23438 L
.61938 .23438 L
.62004 .26563 L
.62073 .26563 L
.62138 .23438 L
.62206 .26563 L
.62281 .26563 L
.62777 .26563 L
.63256 .26563 L
.63388 .23438 L
.63461 .23438 L
.63529 .26563 L
.63654 .23438 L
.63785 .23438 L
.64297 .23438 L
.64437 .23438 L
.64514 .26563 L
.64586 .23438 L
.64654 .21875 L
.64728 .26563 L
.64856 .21875 L
.64976 .23438 L
.65088 .21875 L
.6521 .23438 L
.65342 .23438 L
.65408 .23438 L
.6548 .21875 L
.65611 .21875 L
.65857 .21875 L
.66779 .21875 L
.68751 .21875 L
.69319 .21875 L
.69852 .21875 L
.70332 .21875 L
.70463 .21875 L
.70535 .21875 L
.70602 .21875 L
.7072 .26563 L
.7085 .26563 L
.70976 .26563 L
.7104 .21875 L
.71111 .21875 L
.71352 .21875 L
.71898 .21875 L
.7289 .21875 L
Mistroke
.73003 .21875 L
.73126 .15625 L
.73243 .15625 L
.73351 .15625 L
.73477 .21875 L
.73547 .21875 L
.73611 .15625 L
.73733 .15625 L
.73848 .21875 L
.73957 .21875 L
.74073 .21875 L
.74171 .21875 L
.7428 .15625 L
.74396 .21875 L
.74521 .21875 L
.74639 .15625 L
.74747 .15625 L
.76814 .15625 L
.77724 .15625 L
.78729 .15625 L
.79189 .15625 L
.79431 .15625 L
.79563 .15625 L
.79686 .15625 L
.79794 .10938 L
.7991 .21875 L
.80038 .15625 L
.80155 .21875 L
.80261 .0625 L
.80376 .10938 L
.80485 .21875 L
.80585 .10938 L
.80699 .15625 L
.80821 .15625 L
.80927 .10938 L
.81042 .15625 L
.81111 .15625 L
.81176 .10938 L
.81304 .10938 L
.81544 .10938 L
.82559 .10938 L
.82806 .10938 L
.83068 .10938 L
.83204 .10938 L
.83282 .10938 L
.83354 .15625 L
.83481 .10938 L
.83552 .10938 L
.83617 .15625 L
.83745 .10938 L
Mistroke
.83863 .01563 L
.83992 .10938 L
.84057 .0625 L
.84129 .15625 L
.84249 .10938 L
.84379 .10938 L
.84501 .15625 L
.84613 .0625 L
.84722 .15625 L
.84838 .10938 L
.84947 .10938 L
.85047 .0625 L
.85164 .0625 L
.85291 .15625 L
.8541 .10938 L
.85521 .0625 L
.85635 .0625 L
.85741 .0625 L
.85859 .15625 L
.85984 .15625 L
.86116 .0625 L
.86241 .15625 L
.86353 .15625 L
.86475 .0625 L
.8654 .15625 L
.86609 .15625 L
.86732 .15625 L
.86864 .0625 L
.86939 .15625 L
.87009 .0625 L
.87136 .0625 L
.87251 .15625 L
.87315 .0625 L
.87385 .0625 L
.87511 .15625 L
.87623 .0625 L
.87747 .0625 L
.87998 .0625 L
.88448 .0625 L
.90547 .0625 L
.94576 .0625 L
.97619 .0625 L
Mfstroke
% End of Graphics
MathPictureEnd
\
\>"], "Graphics",
 ImageSize->{288, 177.938},
 ImageMargins->{{43, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 
  1}},ImageCache->GraphicsData["CompressedBitmap", "\<\
eJztWr1y00AQlvVnxSQwGRKaMINCRx9DKsrQAO/gMYEYhoEJqYCWGQoYiqTi
LSjhEUhoeR3jW8mr0+mTfbJOihTk4rza2/v2u729vZOTJ6OTo8PXo5PJeBQ+
Oh69PZqM34UHb45nKqdnWb3QsqwfoSXk6UyMG/rsiiZ+APIOfTlTtp89UevU
2G+L7vssuUCiXk9IQ5ZsYLcF/N0RrStUfj6pPWpdWSfkAKsfAASk6+PhN/NY
wuFF+F4DpkNNsgOg2wS6EOiKR3ZNfNOa7WvyC3gEWuVdoPMkVjYnTw4XDQa5
rBRd/vpmXC8I3JBp08o46V2yD3qR35DtFmTTX6C799+Zb8WPlrVBFRSOvwA6
WkSKseXMIeipL9oFpbYD68BSBepPc/i0BuxctNtCdXeJEVVfOhTW6zWnaV1c
KgXF/LdoPTb3QdwdOIvzFQaW843ueQ5DOMAB0hV0GlnJCGSC7kgNZkCx+iWk
W1X4dYHOBrqfPPMNIVHnnoY3L6Wf9yEPBb0mKTVgiSLicprpg6EUv8rmSVJ1
jGsyPwM6R9nH02n8wnO7GljaGusczqfNhnU4CBlYUpyxpJTC5KcFPx9CYXG6
HAz1XlexzZx0K7K5AaAexwbmD8NmkkxSY1ADDd3j81TRCbw+88sAlOBX7sA1
yrP4EW3UPdrmn5iIkg4DoFtLJ5ApV2Tmg5miSb64Ug4I7CMwim60ruxFiJ6h
mXzIdZmemN9Sf+9Fqx6kEU5aJ76CVjklsFekcOWBXAeTsoL2sKnJvtRiQNLn
qlEmovV0BpKCZhXAdZp9+kucPU+7iNa7L+OwPA/t15ag0chDIbmMoWSJB1L5
Sz6hZ0xDPd3yUu5b1Gnm2riy+wpuh2OO6yVwOUjnBP1xaLtaLrk3QVrBh8Cv
wg8dtBQ/5O27Br+CN0GJZ6ZA2eWpalwGK2aws3A1NldFVLqmEVFz/TZ3uzV6
bXp/4aiYqbAyYgVF0zR8JkoVvNpqcy73Ziq7Kf5iKY9uZ/622GszWTUzFl0F
S+u6CgZGd7umYf0tWYuughioINQGGlD61UKGXFwZyDKCj+Ql/xwsy1bvH3TR
lv0=\
\>"],ImageRangeCache->{{{0, 287}, {176.938, 0}} -> {-0.215729, 0.17, \
0.00789457, 8.27261}}],

Cell[BoxData[
 TagBox[
  RowBox[{"\[SkeletonIndicator]", "Graphics", "\[SkeletonIndicator]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dt", "[", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], "/", 
        RowBox[{"y", "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], ",", "t"}], 
   "]"}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"y", "[", "t", "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "-", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "3"], " ", 
    RowBox[{
     SuperscriptBox["y", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "-", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], " ", 
    RowBox[{"y", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["x", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["y", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"y", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x", "[", "t", "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"y", "[", "t", "]"}], "2"]}], ")"}], "2"]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dt", "[", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", "t", "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"y", "[", "t", "]"}], "^", "2"}]}], "]"}], ",", "t"}], "]"}],
     ",", "t"}], "]"}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"y", "[", "t", "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["x", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["y", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"y", "[", "t", "]"}], "3"], " ", 
    RowBox[{
     SuperscriptBox["y", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "+", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], " ", 
    RowBox[{"y", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x", "[", "t", "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"y", "[", "t", "]"}], "2"]}], ")"}], 
   RowBox[{"3", "/", "2"}]]]], "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Art's Simple Walker with Hip Spring and Foot Curve", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NewModel", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"f", ",", "ground", ",", "Hinge", ",", 
    RowBox[{"Axis", "\[Rule]", 
     RowBox[{"ground", "[", "3", "]"}]}], ",", 
    RowBox[{"QOffset", "->", 
     RowBox[{
      RowBox[{"-", "Pi"}], "/", "2"}]}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "R"}], " ", 
      RowBox[{"ground", "[", "2", "]"}]}]}], ",", 
    RowBox[{"Mass", "\[Rule]", "m"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AccCOM", "[", "f", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "R"}], " ", 
    RowBox[{
     RowBox[{"u", "[", "1", "]"}], "'"}], " ", 
    RowBox[{"ground", "[", "1", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"a", ",", "f", ",", "Fixed", ",", 
    RowBox[{"BodyToJnt", "->", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"L", "-", "R"}], ")"}]}], 
      RowBox[{"a", "[", "1", "]"}]}]}], ",", 
    RowBox[{"InbToJnt", "->", "0"}], ",", 
    RowBox[{"Inertia", "->", "0"}], ",", 
    RowBox[{"Mass", "->", "M"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"b", ",", " ", "a", ",", " ", "Hinge", ",", 
    RowBox[{"Axis", "->", 
     RowBox[{"-", 
      RowBox[{"ground", "[", "3", "]"}]}]}], ",", 
    RowBox[{"QOffset", "->", " ", 
     RowBox[{"-", "Pi"}]}], ",", 
    RowBox[{"BodyToJnt", "->", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], 
      RowBox[{"b", "[", "1", "]"}]}]}], ",", 
    RowBox[{"InbToJnt", "->", "0"}], ",", 
    RowBox[{"Inertia", "->", "0"}], ",", 
    RowBox[{"Mass", "->", "m"}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"f", ",", 
    RowBox[{"m", " ", "grav"}], ",", "0"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"a", ",", 
    RowBox[{"M", " ", "grav"}], ",", "0"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"b", ",", 
    RowBox[{"m", " ", "grav"}], ",", "0"}], "]"}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"a", ",", 
    RowBox[{
     RowBox[{"-", "K"}], " ", 
     RowBox[{"q", "[", "2", "]"}], " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"b", ",", 
    RowBox[{"K", " ", 
     RowBox[{"q", "[", "2", "]"}], " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"grav", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
     RowBox[{"ground", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Gamma]", "]"}], 
     RowBox[{"ground", "[", "1", "]"}]}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eom", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"EOM", "[", "]"}], " ", "/.", 
    RowBox[{"m", "->", 
     RowBox[{"\[Beta]", " ", "M"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"M", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "R"}], " ", "\[Beta]", " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "R"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
       RowBox[{"\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "R"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", "\[Beta]", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", "\[Beta]", " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          SubscriptBox["q", "2"], "2"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          FractionBox[
           SubscriptBox["q", "2"], "2"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", "R", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "1"], "]"}]}], "+", 
          RowBox[{"\[Beta]", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}]}], ")"}], " ", 
        SubsuperscriptBox["u", "1", "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "R"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
        SubscriptBox["u", "1"], " ", 
        SubscriptBox["u", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "R"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
        SubsuperscriptBox["u", "2", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"L", "-", "R"}], ")"}], "2"]}], "-", 
          SuperscriptBox["R", "2"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"L", "-", "R"}], ")"}], "2"], " ", "\[Beta]"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["R", "2"], " ", "\[Beta]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"L", "-", "R"}], ")"}], " ", "R", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "+", 
          RowBox[{"2", " ", "R", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", "\[Beta]", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"L", "-", "R"}], ")"}], "2"], " ", "\[Beta]", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         SubscriptBox["u", "1"], "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "R"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"Cos", "[", 
              SubscriptBox["q", "2"], "]"}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         SubscriptBox["u", "2"], "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"K", " ", 
     SubscriptBox["q", "2"]}], "\[Equal]", 
    RowBox[{"M", " ", 
     RowBox[{"(", 
      RowBox[{"L", "-", "R"}], ")"}], " ", "\[Beta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Gamma]", "-", 
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}], "]"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubsuperscriptBox["u", "1", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "R"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"Cos", "[", 
              SubscriptBox["q", "2"], "]"}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         SubscriptBox["u", "1"], "\[Prime]",
         MultilineFunction->None]}], "-", 
       RowBox[{"L", " ", 
        SuperscriptBox[
         SubscriptBox["u", "2"], "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{"R", " ", 
        SuperscriptBox[
         SubscriptBox["u", "2"], "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eom2", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"#", "/", "M"}], ",", " ", "Equal"}], "]"}], "&"}], ",", 
    "eom"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "R"}], " ", "\[Beta]", " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "R"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "R"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", "\[Beta]", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}], " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", "\[Beta]", " ", 
      RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        SubscriptBox["q", "2"], "2"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        FractionBox[
         SubscriptBox["q", "2"], "2"]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", "R", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["q", "1"], "]"}]}], "+", 
        RowBox[{"\[Beta]", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "2"]}], "]"}]}]}], ")"}], " ", 
      SubsuperscriptBox["u", "1", "2"]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", "\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "R"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "2"]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"L", "-", "R"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", "\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "R"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "2"]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"L", "-", "R"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
      SubsuperscriptBox["u", "2", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"L", "-", "R"}], ")"}], "2"]}], "-", 
        SuperscriptBox["R", "2"], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"L", "-", "R"}], ")"}], "2"], " ", "\[Beta]"}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["R", "2"], " ", "\[Beta]"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"L", "-", "R"}], ")"}], " ", "R", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Beta]"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "1"], "]"}]}], "+", 
        RowBox[{"2", " ", "R", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", "\[Beta]", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "2"]}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"L", "-", "R"}], ")"}], "2"], " ", "\[Beta]", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
      SuperscriptBox[
       SubscriptBox["u", "1"], "\[Prime]",
       MultilineFunction->None]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", "\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"R", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "2"]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"L", "-", "R"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "2"], "]"}]}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox[
       SubscriptBox["u", "2"], "\[Prime]",
       MultilineFunction->None]}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"K", " ", 
      SubscriptBox["q", "2"]}], "M"], "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"L", "-", "R"}], ")"}], " ", "\[Beta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Gamma]", "-", 
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}], "]"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubsuperscriptBox["u", "1", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "R"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"Cos", "[", 
              SubscriptBox["q", "2"], "]"}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         SubscriptBox["u", "1"], "\[Prime]",
         MultilineFunction->None]}], "-", 
       RowBox[{"L", " ", 
        SuperscriptBox[
         SubscriptBox["u", "2"], "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{"R", " ", 
        SuperscriptBox[
         SubscriptBox["u", "2"], "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell["First line of Andy's equations of motion", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqn1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"eom2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "\[Rule]", "1"}], ",", 
       RowBox[{"\[Beta]", "->", "0"}]}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"M", "\[NotEqual]", "0"}], " ", "&&", " ", 
     RowBox[{"\[Beta]", "\[NotEqual]", "0"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"R", " ", 
    RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Gamma]", "-", 
     SubscriptBox["q", "1"]}], "]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "R", " ", 
    RowBox[{"Sin", "[", 
     SubscriptBox["q", "1"], "]"}], " ", 
    SubsuperscriptBox["u", "1", "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "R"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["R", "2"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "R", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
    SuperscriptBox[
     SubscriptBox["u", "1"], "\[Prime]",
     MultilineFunction->None]}]}], "\[Equal]", 
  RowBox[{"R", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Gamma]", "-", 
     SubscriptBox["q", "1"]}], "]"}]}]}]], "Output"]
}, Open  ]],

Cell["Second line", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqn2", "=", 
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"eom2", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/", "\[Beta]"}], ",", "Equal"}], 
    "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"L", "\[Rule]", "1"}], ",", 
     RowBox[{
      RowBox[{"K", "/", 
       RowBox[{"(", 
        RowBox[{"M", " ", "\[Beta]"}], ")"}]}], "\[Rule]", "k"}]}], 
    "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"k", " ", 
   SubscriptBox["q", "2"]}], "\[Equal]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "R"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"\[Gamma]", "-", 
       SubscriptBox["q", "1"], "+", 
       SubscriptBox["q", "2"]}], "]"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "R"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "2"], "]"}], " ", 
      SubsuperscriptBox["u", "1", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"R", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "2"]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "R"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "2"], "]"}]}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox[
       SubscriptBox["u", "1"], "\[Prime]",
       MultilineFunction->None]}], "-", 
     SuperscriptBox[
      SubscriptBox["u", "2"], "\[Prime]",
      MultilineFunction->None], "+", 
     RowBox[{"R", " ", 
      SuperscriptBox[
       SubscriptBox["u", "2"], "\[Prime]",
       MultilineFunction->None]}]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell["\<\
Demonstrate that both of them boil down to Andy's equations when R = 0\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"eqn1", "/.", 
   RowBox[{"R", "\[Rule]", "0"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"\[Gamma]", "-", 
     SubscriptBox["q", "1"]}], "]"}], "+", 
   SuperscriptBox[
    SubscriptBox["u", "1"], "\[Prime]",
    MultilineFunction->None]}], "\[Equal]", "0"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"eqn2", "/.", 
   RowBox[{"R", "\[Rule]", "0"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"k", " ", 
    SubscriptBox["q", "2"]}], "+", 
   RowBox[{
    RowBox[{"Sin", "[", 
     SubscriptBox["q", "2"], "]"}], " ", 
    SubsuperscriptBox["u", "1", "2"]}], "+", 
   SuperscriptBox[
    SubscriptBox["u", "2"], "\[Prime]",
    MultilineFunction->None]}], "\[Equal]", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"\[Gamma]", "-", 
     SubscriptBox["q", "1"], "+", 
     SubscriptBox["q", "2"]}], "]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "2"], "]"}]}], ")"}], " ", 
    SuperscriptBox[
     SubscriptBox["u", "1"], "\[Prime]",
     MultilineFunction->None]}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"\[Gamma]", "-", 
      RowBox[{"q", "[", "1", "]"}], "+", 
      RowBox[{"q", "[", "2", "]"}]}], "]"}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"q", "[", "2", "]"}], "]"}], 
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], "'"}]}]}], "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "1", "]"}], "'"}], "\[Rule]", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], "-", "\[Gamma]"}], "]"}]}]}], " ", 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cos", "[", 
   RowBox[{"\[Gamma]", "-", 
    SubscriptBox["q", "1"]}], "]"}], " ", 
  RowBox[{"Sin", "[", 
   SubscriptBox["q", "2"], "]"}]}]], "Output"]
}, Open  ]],

Cell["Now add an impulse", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linmom", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Mass", "[", "a", "]"}], 
     RowBox[{"VelCOM", "[", "a", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Mass", "[", "b", "]"}], 
     RowBox[{"VelCOM", "[", "b", "]"}]}]}], " ", "/.", 
   RowBox[{"{", 
    RowBox[{"m", "->", 
     RowBox[{"\[Beta]", " ", "M"}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"M", " ", 
       SubscriptBox["u", "1"]}], "+", 
      RowBox[{"M", " ", "\[Beta]", " ", 
       SubscriptBox["u", "1"]}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M", " ", "\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["u", "1"], "-", 
        SubscriptBox["u", "2"]}], ")"}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["b", "_"], "2"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linmomafter", " ", "=", " ", 
  RowBox[{"linmom", " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], "->", 
      RowBox[{"ua", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"u", "[", "2", "]"}], "->", 
      RowBox[{"ua", "[", "2", "]"}]}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"M", " ", 
       RowBox[{"ua", "[", "1", "]"}]}], "+", 
      RowBox[{"M", " ", "\[Beta]", " ", 
       RowBox[{"ua", "[", "1", "]"}]}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "2"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M", " ", "\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ua", "[", "1", "]"}], "-", 
        RowBox[{"ua", "[", "2", "]"}]}], ")"}]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["b", "_"], "2"]}],
   HoldForm]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"linmomafter", "-", "linmom"}], "==", 
  RowBox[{"imp", " ", 
   RowBox[{"a", "[", "1", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"M", " ", 
        RowBox[{"ua", "[", "1", "]"}]}], "+", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"ua", "[", "1", "]"}]}], "-", 
       RowBox[{"M", " ", 
        SubscriptBox["u", "1"]}], "-", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        SubscriptBox["u", "1"]}]}], ")"}], " ", 
     SubscriptBox[
      UnderscriptBox["a", "_"], "2"]}],
    HoldForm], "+", 
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ua", "[", "1", "]"}], "-", 
          RowBox[{"ua", "[", "2", "]"}]}], ")"}]}], "-", 
       RowBox[{"M", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["u", "1"], "-", 
          SubscriptBox["u", "2"]}], ")"}]}]}], ")"}], " ", 
     SubscriptBox[
      UnderscriptBox["b", "_"], "2"]}],
    HoldForm]}], "==", 
  TagBox[
   RowBox[{"imp", " ", 
    SubscriptBox[
     UnderscriptBox["a", "_"], "1"]}],
   HoldForm]}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Art's Simple Walker (Hybrid dynamical system) with Springy Ankle\
\>", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NewModel", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"foot1", ",", "ground", ",", "Slider", ",", 
    RowBox[{"TAxis", "\[Rule]", 
     RowBox[{"ground", "[", "1", "]"}]}], ",", 
    RowBox[{"Qdof", "\[Rule]", "3"}], ",", 
    RowBox[{"Udof", "\[Rule]", "3"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"foot2", ",", "foot1", ",", "Slider", ",", 
    RowBox[{"TAxis", "\[Rule]", 
     RowBox[{"ground", "[", "2", "]"}]}], ",", 
    RowBox[{"Qdof", "\[Rule]", "4"}], ",", 
    RowBox[{"Udof", "\[Rule]", "4"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"sta", ",", " ", "foot2", ",", " ", "Hinge", ",", " ", 
    RowBox[{"Axis", "->", 
     RowBox[{"ground", "[", "3", "]"}]}], ",", 
    RowBox[{"Mass", "->", "M"}], ",", 
    RowBox[{"Inertia", "->", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
    RowBox[{"InbToJnt", "->", "0"}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "L"}], " ", 
      RowBox[{"sta", "[", "2", "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"pelv", ",", "sta", ",", "Fixed", ",", 
    RowBox[{"Axis", "\[Rule]", 
     RowBox[{"ground", "[", "3", "]"}]}], ",", 
    RowBox[{"Mass", "\[Rule]", "0"}], ",", 
    RowBox[{"InbToJnt", "\[Rule]", "0"}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", "0"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"swi", ",", "pelv", ",", "Hinge", ",", 
    RowBox[{"Axis", "\[Rule]", 
     RowBox[{"ground", "[", "3", "]"}]}], ",", 
    RowBox[{"RelativeTo", "\[Rule]", "ground"}], ",", 
    RowBox[{"Mass", "\[Rule]", "m"}], ",", 
    RowBox[{"Inertia", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
    RowBox[{"InbToJnt", "\[Rule]", "0"}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", 
     RowBox[{"L", " ", 
      RowBox[{"swi", "[", "2", "]"}]}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"sta", ",", 
    RowBox[{
     RowBox[{"Mass", "[", "sta", "]"}], " ", "grav"}], ",", "0"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"pelv", ",", 
    RowBox[{
     RowBox[{"Mass", "[", "pelv", "]"}], " ", "grav"}], ",", " ", "0"}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"swi", ",", 
    RowBox[{
     RowBox[{"Mass", "[", "swi", "]"}], " ", "grav"}], ",", "0"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"sta", ",", 
    RowBox[{
     RowBox[{"Rx", " ", 
      RowBox[{"ground", "[", "1", "]"}]}], "+", 
     RowBox[{"Ry", " ", 
      RowBox[{"ground", "[", "2", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"-", "L"}], " ", 
     RowBox[{"sta", "[", "2", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"swi", ",", 
    RowBox[{
     RowBox[{"Cx", " ", 
      RowBox[{"ground", "[", "1", "]"}]}], "+", 
     RowBox[{"Cy", " ", 
      RowBox[{"ground", "[", "2", "]"}]}]}], ",", "0"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"sta", ",", 
    RowBox[{"T1", " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"swi", ",", 
    RowBox[{"T2", " ", 
     RowBox[{"ground", "[", "3", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"sta", ",", " ", 
    RowBox[{
     RowBox[{"-", "Kp"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], "-", 
       RowBox[{"q", "[", "2", "]"}]}], ")"}], " ", 
     RowBox[{"sta", "[", "3", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"swi", ",", " ", 
    RowBox[{"Kp", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], "-", 
       RowBox[{"q", "[", "2", "]"}]}], ")"}], " ", 
     RowBox[{"swi", "[", "3", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"grav", "=", 
   RowBox[{"g", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "gamma", "]"}]}], " ", 
       RowBox[{"ground", "[", "2", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "gamma", "]"}], " ", 
       RowBox[{"ground", "[", "1", "]"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{"eom", " ", "=", " ", 
  RowBox[{
   RowBox[{"EOM", "[", "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{"m", "\[Rule]", 
     RowBox[{"\[Beta]", " ", "M"}]}], "}"}]}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eom2", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"#", "/", "M"}], ",", " ", "Equal"}], "]"}], "&"}], ",", 
    "eom"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", "M"], 
     RowBox[{"(", 
      RowBox[{"T1", "-", 
       RowBox[{"L", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"Cx", "+", 
          RowBox[{"g", " ", "M", " ", "\[Beta]", " ", 
           RowBox[{"Sin", "[", "gamma", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"L", " ", "Rx"}], "-", 
          RowBox[{"L", " ", 
           RowBox[{"(", 
            RowBox[{"Rx", "+", 
             RowBox[{"g", " ", "M", " ", 
              RowBox[{"Sin", "[", "gamma", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"L", " ", "Ry", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}], "-", 
       RowBox[{"L", " ", 
        RowBox[{"(", 
         RowBox[{"Ry", "-", 
          RowBox[{"g", " ", "M", " ", 
           RowBox[{"Cos", "[", "gamma", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}], "-", 
       RowBox[{"L", " ", 
        RowBox[{"(", 
         RowBox[{"Cy", "-", 
          RowBox[{"g", " ", "M", " ", "\[Beta]", " ", 
           RowBox[{"Cos", "[", "gamma", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}], "-", 
       RowBox[{"Kp", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["L", "2"], " ", "M", " ", "\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}], " ", 
        SubsuperscriptBox["u", "2", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["L", "2"]}], " ", "M"}], "-", 
          RowBox[{
           SuperscriptBox["L", "2"], " ", "M", " ", "\[Beta]"}]}], ")"}], " ", 
        SuperscriptBox[
         SubscriptBox["u", "1"], "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{
        SuperscriptBox["L", "2"], " ", "M", " ", "\[Beta]", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}], " ", 
        SuperscriptBox[
         SubscriptBox["u", "2"], "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"L", " ", "M"}], "+", 
          RowBox[{"L", " ", "M", " ", "\[Beta]"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SuperscriptBox[
         SubscriptBox["u", "3"], "\[Prime]",
         MultilineFunction->None]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"L", " ", "M"}], "+", 
          RowBox[{"L", " ", "M", " ", "\[Beta]"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SuperscriptBox[
         SubscriptBox["u", "4"], "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", "M"], 
     RowBox[{"(", 
      RowBox[{"T2", "+", 
       RowBox[{"L", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"Cx", "+", 
          RowBox[{"g", " ", "M", " ", "\[Beta]", " ", 
           RowBox[{"Sin", "[", "gamma", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"L", " ", 
        RowBox[{"(", 
         RowBox[{"Cy", "-", 
          RowBox[{"g", " ", "M", " ", "\[Beta]", " ", 
           RowBox[{"Cos", "[", "gamma", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "2"], "]"}]}], "+", 
       RowBox[{"Kp", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["L", "2"], " ", "M", " ", "\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}], " ", 
        SubsuperscriptBox["u", "1", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["L", "2"], " ", "M", " ", "\[Beta]", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}], " ", 
        SuperscriptBox[
         SubscriptBox["u", "1"], "\[Prime]",
         MultilineFunction->None]}], "-", 
       RowBox[{
        SuperscriptBox["L", "2"], " ", "M", " ", "\[Beta]", " ", 
        SuperscriptBox[
         SubscriptBox["u", "2"], "\[Prime]",
         MultilineFunction->None]}], "-", 
       RowBox[{"L", " ", "M", " ", "\[Beta]", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SuperscriptBox[
         SubscriptBox["u", "3"], "\[Prime]",
         MultilineFunction->None]}], "-", 
       RowBox[{"L", " ", "M", " ", "\[Beta]", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SuperscriptBox[
         SubscriptBox["u", "4"], "\[Prime]",
         MultilineFunction->None]}]}], ")"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"Cx", "+", "Rx", "+", 
      RowBox[{"g", " ", "M", " ", 
       RowBox[{"Sin", "[", "gamma", "]"}]}], "+", 
      RowBox[{"g", " ", "M", " ", "\[Beta]", " ", 
       RowBox[{"Sin", "[", "gamma", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "L"}], " ", "M"}], "-", 
         RowBox[{"L", " ", "M", " ", "\[Beta]"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "1"], "]"}], " ", 
       SubsuperscriptBox["u", "1", "2"]}], "+", 
      RowBox[{"L", " ", "M", " ", "\[Beta]", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "2"], "]"}], " ", 
       SubsuperscriptBox["u", "2", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", " ", "M"}], "+", 
         RowBox[{"L", " ", "M", " ", "\[Beta]"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "1"], "]"}], " ", 
       SuperscriptBox[
        SubscriptBox["u", "1"], "\[Prime]",
        MultilineFunction->None]}], "-", 
      RowBox[{"L", " ", "M", " ", "\[Beta]", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "2"], "]"}], " ", 
       SuperscriptBox[
        SubscriptBox["u", "2"], "\[Prime]",
        MultilineFunction->None]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "M"}], "-", 
         RowBox[{"M", " ", "\[Beta]"}]}], ")"}], " ", 
       SuperscriptBox[
        SubscriptBox["u", "3"], "\[Prime]",
        MultilineFunction->None]}]}], "M"], "\[Equal]", "0"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"Cy", "+", "Ry", "-", 
      RowBox[{"g", " ", "M", " ", 
       RowBox[{"Cos", "[", "gamma", "]"}]}], "-", 
      RowBox[{"g", " ", "M", " ", "\[Beta]", " ", 
       RowBox[{"Cos", "[", "gamma", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", " ", "M"}], "+", 
         RowBox[{"L", " ", "M", " ", "\[Beta]"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "1"], "]"}], " ", 
       SubsuperscriptBox["u", "1", "2"]}], "-", 
      RowBox[{"L", " ", "M", " ", "\[Beta]", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "2"], "]"}], " ", 
       SubsuperscriptBox["u", "2", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", " ", "M"}], "+", 
         RowBox[{"L", " ", "M", " ", "\[Beta]"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "1"], "]"}], " ", 
       SuperscriptBox[
        SubscriptBox["u", "1"], "\[Prime]",
        MultilineFunction->None]}], "-", 
      RowBox[{"L", " ", "M", " ", "\[Beta]", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "2"], "]"}], " ", 
       SuperscriptBox[
        SubscriptBox["u", "2"], "\[Prime]",
        MultilineFunction->None]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "M"}], "-", 
         RowBox[{"M", " ", "\[Beta]"}]}], ")"}], " ", 
       SuperscriptBox[
        SubscriptBox["u", "4"], "\[Prime]",
        MultilineFunction->None]}]}], "M"], "\[Equal]", "0"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell["First line of equations of motion", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqn1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"eom2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\[Beta]", "\[Rule]", "0"}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"M", "\[NotEqual]", "0"}], " ", "&&", " ", 
     RowBox[{"\[Beta]", "\[NotEqual]", "0"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Kp", " ", 
    SubscriptBox["q", "1"]}], "+", 
   RowBox[{"L", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cx", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "1"], "]"}]}], "+", 
      RowBox[{"g", " ", "M", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"gamma", "-", 
         SubscriptBox["q", "1"]}], "]"}]}], "+", 
      RowBox[{"Cy", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "1"], "]"}]}], "+", 
      RowBox[{"L", " ", "M", " ", 
       SuperscriptBox[
        SubscriptBox["u", "1"], "\[Prime]",
        MultilineFunction->None]}]}], ")"}]}]}], "\[Equal]", 
  RowBox[{"T1", "+", 
   RowBox[{"Kp", " ", 
    SubscriptBox["q", "2"]}], "+", 
   RowBox[{"L", " ", "M", " ", 
    RowBox[{"Cos", "[", 
     SubscriptBox["q", "1"], "]"}], " ", 
    SuperscriptBox[
     SubscriptBox["u", "3"], "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"L", " ", "M", " ", 
    RowBox[{"Sin", "[", 
     SubscriptBox["q", "1"], "]"}], " ", 
    SuperscriptBox[
     SubscriptBox["u", "4"], "\[Prime]",
     MultilineFunction->None]}]}]}]], "Output"]
}, Open  ]],

Cell["Second line", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqn2", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eom2", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", "\[Beta]"}], ",", "Equal"}], 
      "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"T2", "\[Rule]", "0"}], ",", 
       RowBox[{"Cx", "\[Rule]", 
        RowBox[{
         RowBox[{"-", "Cee"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"q", "[", "2", "]"}], "]"}]}]}], ",", 
       RowBox[{"Cy", "\[Rule]", 
        RowBox[{"Cee", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"q", "[", "2", "]"}], "]"}]}]}], ",", 
       RowBox[{"Kp", "\[Rule]", 
        RowBox[{"k", " ", 
         RowBox[{"(", 
          RowBox[{"M", " ", "\[Beta]"}], ")"}]}]}]}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"M", "\[NotEqual]", "0"}], " ", "&&", " ", 
     RowBox[{"\[Beta]", "\[NotEqual]", "0"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"k", " ", 
   SubscriptBox["q", "1"]}], "\[Equal]", 
  RowBox[{
   RowBox[{"k", " ", 
    SubscriptBox["q", "2"]}], "+", 
   RowBox[{"L", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "g"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"gamma", "-", 
         SubscriptBox["q", "2"]}], "]"}]}], "+", 
      RowBox[{"L", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "2"]}], "]"}], " ", 
       SubsuperscriptBox["u", "1", "2"]}], "-", 
      RowBox[{"L", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "2"]}], "]"}], " ", 
       SuperscriptBox[
        SubscriptBox["u", "1"], "\[Prime]",
        MultilineFunction->None]}], "+", 
      RowBox[{"L", " ", 
       SuperscriptBox[
        SubscriptBox["u", "2"], "\[Prime]",
        MultilineFunction->None]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "2"], "]"}], " ", 
       SuperscriptBox[
        SubscriptBox["u", "3"], "\[Prime]",
        MultilineFunction->None]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "2"], "]"}], " ", 
       SuperscriptBox[
        SubscriptBox["u", "4"], "\[Prime]",
        MultilineFunction->None]}]}], ")"}]}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqn3", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"eom2", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", 
     RowBox[{"\[Beta]", "\[Rule]", "0"}]}], ",", 
    RowBox[{"M", "\[NotEqual]", " ", "0"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cx", "+", "Rx", "+", 
   RowBox[{"g", " ", "M", " ", 
    RowBox[{"Sin", "[", "gamma", "]"}]}], "+", 
   RowBox[{"L", " ", "M", " ", 
    RowBox[{"Cos", "[", 
     SubscriptBox["q", "1"], "]"}], " ", 
    SuperscriptBox[
     SubscriptBox["u", "1"], "\[Prime]",
     MultilineFunction->None]}]}], "\[Equal]", 
  RowBox[{"M", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"L", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}], " ", 
      SubsuperscriptBox["u", "1", "2"]}], "+", 
     SuperscriptBox[
      SubscriptBox["u", "3"], "\[Prime]",
      MultilineFunction->None]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqn4", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"eom2", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "/.", 
     RowBox[{"\[Beta]", "\[Rule]", "0"}]}], ",", 
    RowBox[{"M", "\[NotEqual]", "0"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"g", " ", 
      RowBox[{"Cos", "[", "gamma", "]"}]}], "+", 
     SuperscriptBox[
      SubscriptBox["u", "4"], "\[Prime]",
      MultilineFunction->None]}], ")"}]}], "\[Equal]", 
  RowBox[{"Cy", "+", "Ry", "+", 
   RowBox[{"L", " ", "M", " ", 
    RowBox[{"Cos", "[", 
     SubscriptBox["q", "1"], "]"}], " ", 
    SubsuperscriptBox["u", "1", "2"]}], "+", 
   RowBox[{"L", " ", "M", " ", 
    RowBox[{"Sin", "[", 
     SubscriptBox["q", "1"], "]"}], " ", 
    SuperscriptBox[
     SubscriptBox["u", "1"], "\[Prime]",
     MultilineFunction->None]}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"MM", ",", "rhs"}], "}"}], "=", 
  RowBox[{
   RowBox[{"MassMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"eqn1", ",", "eqn2", ",", "eqn3", ",", "eqn4"}], "}"}], "]"}], "/.", 
   RowBox[{"L", "\[Rule]", "1"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "M"}], ",", "0", ",", 
       RowBox[{"M", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}], ",", 
       RowBox[{"M", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}]}], ",", "1", ",", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "2"], "]"}], ",", 
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "2"], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "M"}], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}], ",", "0", ",", "M", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}], ",", "0", ",", "0", ",", 
       RowBox[{"-", "M"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "T1"}], "+", 
      RowBox[{"Cx", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "1"], "]"}]}], "+", 
      RowBox[{"g", " ", "M", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"gamma", "-", 
         SubscriptBox["q", "1"]}], "]"}]}], "+", 
      RowBox[{"Cy", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "1"], "]"}]}], "+", 
      RowBox[{"Kp", " ", 
       SubscriptBox["q", "1"]}], "-", 
      RowBox[{"Kp", " ", 
       SubscriptBox["q", "2"]}]}], ",", 
     RowBox[{
      RowBox[{"g", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"gamma", "-", 
         SubscriptBox["q", "2"]}], "]"}]}], "+", 
      RowBox[{"k", " ", 
       SubscriptBox["q", "1"]}], "-", 
      RowBox[{"k", " ", 
       SubscriptBox["q", "2"]}], "-", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "-", 
         SubscriptBox["q", "2"]}], "]"}], " ", 
       SubsuperscriptBox["u", "1", "2"]}]}], ",", 
     RowBox[{"Cx", "+", "Rx", "+", 
      RowBox[{"g", " ", "M", " ", 
       RowBox[{"Sin", "[", "gamma", "]"}]}], "-", 
      RowBox[{"M", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "1"], "]"}], " ", 
       SubsuperscriptBox["u", "1", "2"]}]}], ",", 
     RowBox[{
      RowBox[{"-", "Cy"}], "-", "Ry", "+", 
      RowBox[{"g", " ", "M", " ", 
       RowBox[{"Cos", "[", "gamma", "]"}]}], "-", 
      RowBox[{"M", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "1"], "]"}], " ", 
       SubsuperscriptBox["u", "1", "2"]}]}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["MM"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "M"}], ",", "0", ",", 
     RowBox[{"M", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}], ",", 
     RowBox[{"M", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}], ",", "1", ",", 
     RowBox[{"Cos", "[", 
      SubscriptBox["q", "2"], "]"}], ",", 
     RowBox[{"Sin", "[", 
      SubscriptBox["q", "2"], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "M"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}], ",", "0", ",", "M", ",", "0"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"M", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}], ",", "0", ",", "0", ",", 
     RowBox[{"-", "M"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Angular Momentum Calculations, Push-off impulse and heelstrike impact (with \
intermediate energetics)\
\>", "Section"],

Cell["\<\
In order to properly account for the energetics of push-off and heel-strike, \
we explicitly compute the state of the system between the two (the \
intermediate state) as if the system is in the air. The system does not \
actually have an aerial phase, but it does nonetheless require states that \
allow it to go aerial in order to properly describe the system before \
heelstrike.\
\>", "Text"],

Cell[CellGroupData[{

Cell["Find intermediate state of system about center of mass", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r0", "=", 
   RowBox[{"PosCOM", "[", 
    RowBox[{"{", 
     RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"whole", " ", "system", " ", "COM"}], " ", "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"impulse", "=", 
   RowBox[{
    RowBox[{"Ix", " ", 
     RowBox[{"ground", "[", "1", "]"}]}], " ", "+", " ", 
    RowBox[{"Iy", " ", 
     RowBox[{"ground", "[", "2", "]"}]}]}]}], ";", 
  RowBox[{"impact", "=", 
   RowBox[{
    RowBox[{"cx", " ", 
     RowBox[{"ground", "[", "1", "]"}]}], "+", 
    RowBox[{"cy", " ", 
     RowBox[{"ground", "[", "2", "]"}]}]}]}], ";"}]], "Input"],

Cell["\<\
Angular momentum of whole system about COM, intermediate state, in terms of \
old (pre-push-off impulse) u's\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amsciold", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AngMom", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"f", ",", "a", ",", "b"}], "}"}], ",", "r0"}], "]"}], "+", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"-", "r0"}], ",", "impulse"}], "]"}]}], ")"}], ".", 
       RowBox[{"ground", "[", "3", "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "+", 
          RowBox[{"2", "m"}]}], ")"}], "\[Rule]", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Ix", ",", "Iy", ",", 
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ix", " ", 
   RowBox[{"(", 
    RowBox[{"R", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", "+", "M"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"Iy", " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", "+", "M"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"2", " ", "m", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"L", "-", "R"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"m", "+", "M", "+", 
     RowBox[{"m", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{"m", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"L", "-", "R"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"m", "+", "M", "+", 
     RowBox[{"m", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "2"]}]}]], "Output"]
}, Open  ]],

Cell["\<\
Angular momentum of whole system about COM, intermediate state\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amsciint", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"AngMom", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f", ",", "a", ",", "b"}], "}"}], ",", "r0"}], "]"}], ".", 
       RowBox[{"ground", "[", "3", "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "+", 
          RowBox[{"2", "m"}]}], ")"}], "\[Rule]", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"m", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{"m", "+", "M", "+", 
    RowBox[{"m", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     SubscriptBox["u", "1"]}], "-", 
    SubscriptBox["u", "2"]}], ")"}]}]], "Output"]
}, Open  ]],

Cell["\<\
Angular momentum of whole system about COM, intermediate state, in terms of \
new (post heelstrike) u's\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amscinew", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AngMom", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"f", ",", "a", ",", "b"}], "}"}], ",", "r0"}], "]"}], "-", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"-", "r0"}], ",", "impact"}], "]"}]}], ")"}], ".", 
       RowBox[{"ground", "[", "3", "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "+", 
          RowBox[{"2", "m"}]}], ")"}], "\[Rule]", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"cx", ",", "cy", ",", 
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cx", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "R"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", "+", "M"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"cy", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", "+", "M"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"2", " ", "m", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"L", "-", "R"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"m", "+", "M", "+", 
     RowBox[{"m", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{"m", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"L", "-", "R"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"m", "+", "M", "+", 
     RowBox[{"m", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "2"]}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find intermediate state of trailing leg about hip ", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amthiold", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"AngMom", "[", 
      RowBox[{"f", ",", 
       RowBox[{"PosCOM", "[", "a", "]"}]}], "]"}], "+", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"PosCOM", "[", "a", "]"}]}], ",", "impulse"}], "]"}]}], ")"}],
    ".", 
   RowBox[{"ground", "[", "3", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "Ix"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "R"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"Iy", " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["q", "1"], "]"}]}], "+", 
  RowBox[{"m", " ", "R", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "1"]}]}]], "Output"]
}, Open  ]],

Cell["\<\
In terms of intermediate u's, where u[1] is the trailing leg, u[2] is the \
leading leg, and we also introduce the velocity of the bottom of the trailing \
leg, u[3] ground[1]+u[4] ground[2]. Thus there are horizontal and vertical \
components to the velocity of the foot, that will also contribute to the \
angular momentum. Below is the angular momentum of the trailing (stance) leg \
about the hip, plus the contribution of the translational velocity: position \
of the trailing leg COM with respect to the hip, crossed with mass of the leg \
times the additional translational velocity term.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amthiint", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AngMom", "[", 
         RowBox[{"f", ",", 
          RowBox[{"PosCOM", "[", "f", "]"}]}], "]"}], "+", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PosCOM", "[", "f", "]"}], "-", 
           RowBox[{"PosCOM", "[", "a", "]"}]}], ",", 
          RowBox[{"m", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"u", "[", "3", "]"}], " ", 
              RowBox[{"ground", "[", "1", "]"}]}], "+", 
             RowBox[{
              RowBox[{"u", "[", "4", "]"}], 
              RowBox[{"ground", "[", "2", "]"}]}]}], ")"}]}]}], "]"}]}], 
       ")"}], ".", 
      RowBox[{"ground", "[", "3", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"m", " ", 
  RowBox[{"(", 
   RowBox[{"L", "-", "R"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["q", "1"], "]"}], " ", 
     SubscriptBox["u", "3"]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      SubscriptBox["q", "1"], "]"}], " ", 
     SubscriptBox["u", "4"]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amthinew", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"AngMom", "[", 
        RowBox[{"b", ",", 
         RowBox[{"PosCOM", "[", "a", "]"}]}], "]"}], ")"}], ".", 
      RowBox[{"ground", "[", "3", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"m", " ", 
  RowBox[{"(", 
   RowBox[{"L", "-", "R"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"R", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Cos", "[", 
           SubscriptBox["q", "2"], "]"}]}], ")"}]}]}], ")"}], " ", 
     SubscriptBox["u", "1"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
     SubscriptBox["u", "2"]}]}], ")"}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find intermediate state of leading leg about hip", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amlhiold", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AngMom", "[", 
       RowBox[{"b", ",", 
        RowBox[{"PosCOM", "[", "a", "]"}]}], "]"}], ".", 
      RowBox[{"ground", "[", "3", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"C", "-", "L"}], ")"}], " ", "M", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}], "+", 
     RowBox[{"R", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "1"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Il", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"C", "-", "L"}], ")"}], "2"], " ", "M"}]}], ")"}], " ", 
   SubscriptBox["u", "2"]}]}]], "Output"]
}, Open  ]],

Cell["In terms of intermediate u's", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amlhiint", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AngMom", "[", 
         RowBox[{"b", ",", 
          RowBox[{"PosCOM", "[", "a", "]"}]}], "]"}], "+", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PosCOM", "[", "f", "]"}], "-", 
           RowBox[{"PosCOM", "[", "a", "]"}]}], ",", 
          RowBox[{"m", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"u", "[", "3", "]"}], 
              RowBox[{"ground", "[", "1", "]"}]}], "+", 
             RowBox[{
              RowBox[{"u", "[", "4", "]"}], 
              RowBox[{"ground", "[", "2", "]"}]}]}], ")"}]}]}], "]"}]}], 
       ")"}], ".", 
      RowBox[{"ground", "[", "3", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"m", " ", 
  RowBox[{"(", 
   RowBox[{"L", "-", "R"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"R", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Cos", "[", 
           SubscriptBox["q", "2"], "]"}]}], ")"}]}]}], ")"}], " ", 
     SubscriptBox["u", "1"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
     SubscriptBox["u", "2"]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["q", "1"], "]"}], " ", 
     SubscriptBox["u", "3"]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      SubscriptBox["q", "1"], "]"}], " ", 
     SubscriptBox["u", "4"]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell["In terms of new u's", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amlhinew", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AngMom", "[", 
         RowBox[{"f", ",", 
          RowBox[{"PosCOM", "[", "a", "]"}]}], "]"}], "-", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"PosCOM", "[", "a", "]"}]}], ",", "impact"}], "]"}]}], 
       ")"}], ".", 
      RowBox[{"ground", "[", "3", "]"}]}], " ", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cx", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "R"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}]}], ")"}]}], "-", 
  RowBox[{"cy", " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["q", "1"], "]"}]}], "+", 
  RowBox[{"m", " ", "R", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "1"]}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Find linear momentum of system at intermediate state, in terms of old u's\
\>", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lmioldx", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"LinMom", "[", 
       RowBox[{"{", 
        RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}], ")"}], "+", 
     "impulse"}], ")"}], ".", 
   RowBox[{"ground", "[", "1", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Ix", "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R", " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"m", "+", "M"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "1"]}], "+", 
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "2"]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["u", "1"], "-", 
     SubscriptBox["u", "2"]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lmioldy", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"LinMom", "[", 
       RowBox[{"{", 
        RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}], ")"}], "+", 
     "impulse"}], ")"}], ".", 
   RowBox[{"ground", "[", "2", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Iy", "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"m", "+", "M"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "1"]}], "+", 
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "2"]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["u", "1"], "-", 
     SubscriptBox["u", "2"]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell["\<\
In terms of intermediate u's, again introducing u[3] ground[1] + u[4] \
ground[2] as the velocity of the bottom of the foot\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lmiintx", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", "3", "]"}], 
         RowBox[{"ground", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"u", "[", "4", "]"}], 
         RowBox[{"ground", "[", "2", "]"}]}], "+", 
        RowBox[{"LinMom", "[", 
         RowBox[{"{", 
          RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}]}], ")"}], ".", 
      RowBox[{"ground", "[", "1", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], "m"}], "-", "M"}], ")"}], "\[Rule]", 
    RowBox[{"-", "1"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "R"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "m"}], "-", "M"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "2"]}], "]"}], " ", 
   SubscriptBox["u", "2"]}], "+", 
  SubscriptBox["u", "3"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lmiinty", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", "3", "]"}], 
         RowBox[{"ground", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"u", "[", "4", "]"}], 
         RowBox[{"ground", "[", "2", "]"}]}], "+", 
        RowBox[{"LinMom", "[", 
         RowBox[{"{", 
          RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}]}], ")"}], ".", 
      RowBox[{"ground", "[", "2", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "m"}], "+", "M"}], ")"}], "\[Rule]", "1"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "m"}], "-", "M"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "2"]}], "]"}], " ", 
   SubscriptBox["u", "2"]}], "+", 
  SubscriptBox["u", "4"]}]], "Output"]
}, Open  ]],

Cell["In terms of new u's", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lminewx", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"LinMom", "[", 
        RowBox[{"{", 
         RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}], ")"}], "-", 
      "impact"}], ")"}], ".", 
    RowBox[{"ground", "[", "1", "]"}]}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "m"}], "+", "M"}], ")"}], "\[Rule]", "1"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "cx"}], "-", 
  RowBox[{"R", " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"m", "+", "M"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "1"]}], "+", 
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "2"]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["u", "1"], "-", 
     SubscriptBox["u", "2"]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lminewy", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"LinMom", "[", 
        RowBox[{"{", 
         RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}], ")"}], "-", 
      "impact"}], ")"}], ".", 
    RowBox[{"ground", "[", "2", "]"}]}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "m"}], "+", "M"}], ")"}], "\[Rule]", "1"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "cy"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"m", "+", "M"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "1"]}], "+", 
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "2"]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["u", "1"], "-", 
     SubscriptBox["u", "2"]}], ")"}]}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Energies, in terms of intermediate u's (if you want old or new u's, just \
delete the u[3] and u[4] terms)\
\>", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vfoot", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "3", "]"}], 
     RowBox[{"ground", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"u", "[", "4", "]"}], 
     RowBox[{"ground", "[", "2", "]"}]}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KEsta", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Mass", "[", "f", "]"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VelCOM", "[", "f", "]"}], "+", "vfoot"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VelCOM", "[", "f", "]"}], "+", "vfoot"}], ")"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}], ",", 
       RowBox[{"u", "[", "3", "]"}], ",", 
       RowBox[{"u", "[", "4", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "m", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["R", "2"], " ", 
     SubsuperscriptBox["u", "1", "2"]}], "-", 
    RowBox[{"2", " ", "R", " ", 
     SubscriptBox["u", "1"], " ", 
     SubscriptBox["u", "3"]}], "+", 
    SubsuperscriptBox["u", "3", "2"], "+", 
    SubsuperscriptBox["u", "4", "2"]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KEswi", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Mass", "[", "b", "]"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VelCOM", "[", "b", "]"}], "+", "vfoot"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VelCOM", "[", "b", "]"}], "+", "vfoot"}], ")"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}], ",", 
       RowBox[{"u", "[", "3", "]"}], ",", 
       RowBox[{"u", "[", "4", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "m", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["L", "2"]}], "-", 
       RowBox[{"4", " ", "L", " ", "R"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["R", "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", "R", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", "R", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["L", "2"], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}]}], "-", 
       RowBox[{"4", " ", "L", " ", "R", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["R", "2"], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
     SubsuperscriptBox["u", "1", "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], "2"], " ", 
     SubsuperscriptBox["u", "2", "2"]}], "+", 
    SubsuperscriptBox["u", "3", "2"], "+", 
    SubsuperscriptBox["u", "4", "2"], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"L", "-", "R"}], ")"}], " ", 
     SubscriptBox["u", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}], " ", 
        SubscriptBox["u", "3"]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}], " ", 
        SubscriptBox["u", "4"]}]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     SubscriptBox["u", "1"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "R"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"Cos", "[", 
              SubscriptBox["q", "2"], "]"}]}], ")"}]}]}], ")"}], " ", 
        SubscriptBox["u", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"R", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "R"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "R"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}]}], ")"}], " ", 
        SubscriptBox["u", "3"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          SubscriptBox["q", "2"], "2"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          FractionBox[
           SubscriptBox["q", "2"], "2"]}], "]"}], " ", 
        SubscriptBox["u", "4"]}]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KEpelv", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Mass", "[", "a", "]"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VelCOM", "[", "a", "]"}], "+", "vfoot"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VelCOM", "[", "a", "]"}], "+", "vfoot"}], ")"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}], ",", 
       RowBox[{"u", "[", "3", "]"}], ",", 
       RowBox[{"u", "[", "4", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "M", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["L", "2"], "-", 
       RowBox[{"2", " ", "L", " ", "R"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["R", "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", "R", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
     SubsuperscriptBox["u", "1", "2"]}], "+", 
    SubsuperscriptBox["u", "3", "2"], "+", 
    SubsuperscriptBox["u", "4", "2"], "+", 
    RowBox[{"2", " ", 
     SubscriptBox["u", "1"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "R"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
        SubscriptBox["u", "3"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubscriptBox["u", "4"]}]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Angular Momentum Calculations, Push-off impulse and heelstrike impact (with \
intermediate energetics) + landing on a bump\
\>", "Section",
 CellChangeTimes->{{3.638493740712288*^9, 3.638493745213344*^9}}],

Cell["\<\
In order to properly account for the energetics of push-off and heel-strike, \
we explicitly compute the state of the system between the two (the \
intermediate state) as if the system is in the air. The system does not \
actually have an aerial phase, but it does nonetheless require states that \
allow it to go aerial in order to properly describe the system before \
heelstrike.\
\>", "Text"],

Cell[CellGroupData[{

Cell["Find intermediate state of system about center of mass", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r0", "=", 
   RowBox[{"PosCOM", "[", 
    RowBox[{"{", 
     RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"whole", " ", "system", " ", "COM"}], " ", "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"impulse", "=", 
   RowBox[{
    RowBox[{"Ix", " ", 
     RowBox[{"ground", "[", "1", "]"}]}], " ", "+", " ", 
    RowBox[{"Iy", " ", 
     RowBox[{"ground", "[", "2", "]"}]}]}]}], ";", 
  RowBox[{"impact", "=", 
   RowBox[{
    RowBox[{"cx", " ", 
     RowBox[{"ground", "[", "1", "]"}]}], "+", 
    RowBox[{"cy", " ", 
     RowBox[{"ground", "[", "2", "]"}]}]}]}], ";"}]], "Input"],

Cell["\<\
Angular momentum of whole system about COM, intermediate state, in terms of \
old (pre-push-off impulse) u's\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amsciold", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AngMom", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"f", ",", "a", ",", "b"}], "}"}], ",", "r0"}], "]"}], "+", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"-", "r0"}], ",", "impulse"}], "]"}]}], ")"}], ".", 
       RowBox[{"ground", "[", "3", "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "+", 
          RowBox[{"2", "m"}]}], ")"}], "\[Rule]", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Ix", ",", "Iy", ",", 
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ix", " ", 
   RowBox[{"(", 
    RowBox[{"R", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", "+", "M"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"Iy", " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", "+", "M"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"2", " ", "m", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"L", "-", "R"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"m", "+", "M", "+", 
     RowBox[{"m", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{"m", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"L", "-", "R"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"m", "+", "M", "+", 
     RowBox[{"m", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "2"]}]}]], "Output"]
}, Open  ]],

Cell["\<\
Angular momentum of whole system about COM, intermediate state\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amsciint", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"AngMom", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f", ",", "a", ",", "b"}], "}"}], ",", "r0"}], "]"}], ".", 
       RowBox[{"ground", "[", "3", "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "+", 
          RowBox[{"2", "m"}]}], ")"}], "\[Rule]", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"m", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{"m", "+", "M", "+", 
    RowBox[{"m", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     SubscriptBox["u", "1"]}], "-", 
    SubscriptBox["u", "2"]}], ")"}]}]], "Output"]
}, Open  ]],

Cell["\<\
Angular momentum of whole system about COM, intermediate state, in terms of \
new (post heelstrike) u's\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amscinew", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AngMom", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"f", ",", "a", ",", "b"}], "}"}], ",", "r0"}], "]"}], "-", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"-", "r0"}], ",", "impact"}], "]"}]}], ")"}], ".", 
       RowBox[{"ground", "[", "3", "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "+", 
          RowBox[{"2", "m"}]}], ")"}], "\[Rule]", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"cx", ",", "cy", ",", 
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cx", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "R"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", "+", "M"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"cy", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", "+", "M"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"2", " ", "m", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"L", "-", "R"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"m", "+", "M", "+", 
     RowBox[{"m", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{"m", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"L", "-", "R"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"m", "+", "M", "+", 
     RowBox[{"m", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "2"]}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find intermediate state of trailing leg about hip ", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amthiold", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"AngMom", "[", 
      RowBox[{"f", ",", 
       RowBox[{"PosCOM", "[", "a", "]"}]}], "]"}], "+", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"PosCOM", "[", "a", "]"}]}], ",", "impulse"}], "]"}]}], ")"}],
    ".", 
   RowBox[{"ground", "[", "3", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "Ix"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "R"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"Iy", " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["q", "1"], "]"}]}], "+", 
  RowBox[{"m", " ", "R", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "1"]}]}]], "Output"]
}, Open  ]],

Cell["\<\
In terms of intermediate u's, where u[1] is the trailing leg, u[2] is the \
leading leg, and we also introduce the velocity of the bottom of the trailing \
leg, u[3] ground[1]+u[4] ground[2]. Thus there are horizontal and vertical \
components to the velocity of the foot, that will also contribute to the \
angular momentum. Below is the angular momentum of the trailing (stance) leg \
about the hip, plus the contribution of the translational velocity: position \
of the trailing leg COM with respect to the hip, crossed with mass of the leg \
times the additional translational velocity term.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amthiint", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AngMom", "[", 
         RowBox[{"f", ",", 
          RowBox[{"PosCOM", "[", "f", "]"}]}], "]"}], "+", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PosCOM", "[", "f", "]"}], "-", 
           RowBox[{"PosCOM", "[", "a", "]"}]}], ",", 
          RowBox[{"m", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"u", "[", "3", "]"}], " ", 
              RowBox[{"ground", "[", "1", "]"}]}], "+", 
             RowBox[{
              RowBox[{"u", "[", "4", "]"}], 
              RowBox[{"ground", "[", "2", "]"}]}]}], ")"}]}]}], "]"}]}], 
       ")"}], ".", 
      RowBox[{"ground", "[", "3", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"m", " ", 
  RowBox[{"(", 
   RowBox[{"L", "-", "R"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["q", "1"], "]"}], " ", 
     SubscriptBox["u", "3"]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      SubscriptBox["q", "1"], "]"}], " ", 
     SubscriptBox["u", "4"]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amthinew", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"AngMom", "[", 
        RowBox[{"b", ",", 
         RowBox[{"PosCOM", "[", "a", "]"}]}], "]"}], ")"}], ".", 
      RowBox[{"ground", "[", "3", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"m", " ", 
  RowBox[{"(", 
   RowBox[{"L", "-", "R"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"R", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Cos", "[", 
           SubscriptBox["q", "2"], "]"}]}], ")"}]}]}], ")"}], " ", 
     SubscriptBox["u", "1"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
     SubscriptBox["u", "2"]}]}], ")"}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find intermediate state of leading leg about hip", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amlhiold", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AngMom", "[", 
       RowBox[{"b", ",", 
        RowBox[{"PosCOM", "[", "a", "]"}]}], "]"}], ".", 
      RowBox[{"ground", "[", "3", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"C", "-", "L"}], ")"}], " ", "M", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}], "+", 
     RowBox[{"R", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "1"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Il", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"C", "-", "L"}], ")"}], "2"], " ", "M"}]}], ")"}], " ", 
   SubscriptBox["u", "2"]}]}]], "Output"]
}, Open  ]],

Cell["In terms of intermediate u's", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amlhiint", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AngMom", "[", 
         RowBox[{"b", ",", 
          RowBox[{"PosCOM", "[", "a", "]"}]}], "]"}], "+", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PosCOM", "[", "f", "]"}], "-", 
           RowBox[{"PosCOM", "[", "a", "]"}]}], ",", 
          RowBox[{"m", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"u", "[", "3", "]"}], 
              RowBox[{"ground", "[", "1", "]"}]}], "+", 
             RowBox[{
              RowBox[{"u", "[", "4", "]"}], 
              RowBox[{"ground", "[", "2", "]"}]}]}], ")"}]}]}], "]"}]}], 
       ")"}], ".", 
      RowBox[{"ground", "[", "3", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"m", " ", 
  RowBox[{"(", 
   RowBox[{"L", "-", "R"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"R", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Cos", "[", 
           SubscriptBox["q", "2"], "]"}]}], ")"}]}]}], ")"}], " ", 
     SubscriptBox["u", "1"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
     SubscriptBox["u", "2"]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["q", "1"], "]"}], " ", 
     SubscriptBox["u", "3"]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      SubscriptBox["q", "1"], "]"}], " ", 
     SubscriptBox["u", "4"]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell["In terms of new u's", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amlhinew", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AngMom", "[", 
         RowBox[{"f", ",", 
          RowBox[{"PosCOM", "[", "a", "]"}]}], "]"}], "-", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"PosCOM", "[", "a", "]"}]}], ",", "impact"}], "]"}]}], 
       ")"}], ".", 
      RowBox[{"ground", "[", "3", "]"}]}], " ", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cx", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "R"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}]}], ")"}]}], "-", 
  RowBox[{"cy", " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["q", "1"], "]"}]}], "+", 
  RowBox[{"m", " ", "R", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "1"]}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Find linear momentum of system at intermediate state, in terms of old u's\
\>", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lmioldx", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"LinMom", "[", 
       RowBox[{"{", 
        RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}], ")"}], "+", 
     "impulse"}], ")"}], ".", 
   RowBox[{"ground", "[", "1", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Ix", "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "m"}], "+", "M"}], ")"}], " ", "R", " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"m", "+", "M"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "1"]}], "+", 
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "2"]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["u", "1"], "-", 
     SubscriptBox["u", "2"]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lmioldy", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"LinMom", "[", 
       RowBox[{"{", 
        RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}], ")"}], "+", 
     "impulse"}], ")"}], ".", 
   RowBox[{"ground", "[", "2", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Iy", "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"m", "+", "M"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "1"]}], "+", 
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "2"]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["u", "1"], "-", 
     SubscriptBox["u", "2"]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell["\<\
In terms of intermediate u's, again introducing u[3] ground[1] + u[4] \
ground[2] as the velocity of the bottom of the foot\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lmiintx", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", "3", "]"}], 
         RowBox[{"ground", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"u", "[", "4", "]"}], 
         RowBox[{"ground", "[", "2", "]"}]}], "+", 
        RowBox[{"LinMom", "[", 
         RowBox[{"{", 
          RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}]}], ")"}], ".", 
      RowBox[{"ground", "[", "1", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], "m"}], "-", "M"}], ")"}], "\[Rule]", 
    RowBox[{"-", "1"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "R"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "m"}], "-", "M"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "2"]}], "]"}], " ", 
   SubscriptBox["u", "2"]}], "+", 
  SubscriptBox["u", "3"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lmiinty", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", "3", "]"}], 
         RowBox[{"ground", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"u", "[", "4", "]"}], 
         RowBox[{"ground", "[", "2", "]"}]}], "+", 
        RowBox[{"LinMom", "[", 
         RowBox[{"{", 
          RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}]}], ")"}], ".", 
      RowBox[{"ground", "[", "2", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}]}], "}"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "m"}], "+", "M"}], ")"}], "\[Rule]", "1"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "m"}], "-", "M"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["q", "1"], "]"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "1"], "-", 
        SubscriptBox["q", "2"]}], "]"}]}]}], ")"}], " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "2"]}], "]"}], " ", 
   SubscriptBox["u", "2"]}], "+", 
  SubscriptBox["u", "4"]}]], "Output"]
}, Open  ]],

Cell["In terms of new u's", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lminewx", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"LinMom", "[", 
        RowBox[{"{", 
         RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}], ")"}], "-", 
      "impact"}], ")"}], ".", 
    RowBox[{"ground", "[", "1", "]"}]}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "m"}], "+", "M"}], ")"}], "\[Rule]", "1"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "cx"}], "-", 
  RowBox[{"R", " ", 
   SubscriptBox["u", "1"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"m", "+", "M"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "1"]}], "+", 
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "2"]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["u", "1"], "-", 
     SubscriptBox["u", "2"]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lminewy", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"LinMom", "[", 
        RowBox[{"{", 
         RowBox[{"f", ",", "a", ",", "b"}], "}"}], "]"}], ")"}], "-", 
      "impact"}], ")"}], ".", 
    RowBox[{"ground", "[", "2", "]"}]}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "m"}], "+", "M"}], ")"}], "\[Rule]", "1"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "cy"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"m", "+", "M"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"L", "-", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["q", "1"], "]"}], " ", 
   SubscriptBox["u", "1"]}], "+", 
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     SubscriptBox["q", "1"], "-", 
     SubscriptBox["q", "2"]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["u", "1"], "-", 
     SubscriptBox["u", "2"]}], ")"}]}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Energies, in terms of intermediate u's (if you want old or new u's, just \
delete the u[3] and u[4] terms)\
\>", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vfoot", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "3", "]"}], 
     RowBox[{"ground", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"u", "[", "4", "]"}], 
     RowBox[{"ground", "[", "2", "]"}]}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KEsta", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Mass", "[", "f", "]"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VelCOM", "[", "f", "]"}], "+", "vfoot"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VelCOM", "[", "f", "]"}], "+", "vfoot"}], ")"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}], ",", 
       RowBox[{"u", "[", "3", "]"}], ",", 
       RowBox[{"u", "[", "4", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "m", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["R", "2"], " ", 
     SubsuperscriptBox["u", "1", "2"]}], "-", 
    RowBox[{"2", " ", "R", " ", 
     SubscriptBox["u", "1"], " ", 
     SubscriptBox["u", "3"]}], "+", 
    SubsuperscriptBox["u", "3", "2"], "+", 
    SubsuperscriptBox["u", "4", "2"]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KEswi", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Mass", "[", "b", "]"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VelCOM", "[", "b", "]"}], "+", "vfoot"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VelCOM", "[", "b", "]"}], "+", "vfoot"}], ")"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}], ",", 
       RowBox[{"u", "[", "3", "]"}], ",", 
       RowBox[{"u", "[", "4", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "m", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["L", "2"]}], "-", 
       RowBox[{"4", " ", "L", " ", "R"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["R", "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", "R", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", "R", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["L", "2"], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}]}], "-", 
       RowBox[{"4", " ", "L", " ", "R", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["R", "2"], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
     SubsuperscriptBox["u", "1", "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"L", "-", "R"}], ")"}], "2"], " ", 
     SubsuperscriptBox["u", "2", "2"]}], "+", 
    SubsuperscriptBox["u", "3", "2"], "+", 
    SubsuperscriptBox["u", "4", "2"], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"L", "-", "R"}], ")"}], " ", 
     SubscriptBox["u", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}], " ", 
        SubscriptBox["u", "3"]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}], " ", 
        SubscriptBox["u", "4"]}]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     SubscriptBox["u", "1"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "R"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"Cos", "[", 
              SubscriptBox["q", "2"], "]"}]}], ")"}]}]}], ")"}], " ", 
        SubscriptBox["u", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"R", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "R"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "R"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}]}], ")"}], " ", 
        SubscriptBox["u", "3"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          SubscriptBox["q", "2"], "2"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          FractionBox[
           SubscriptBox["q", "2"], "2"]}], "]"}], " ", 
        SubscriptBox["u", "4"]}]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KEpelv", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Mass", "[", "a", "]"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VelCOM", "[", "a", "]"}], "+", "vfoot"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VelCOM", "[", "a", "]"}], "+", "vfoot"}], ")"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "1", "]"}], ",", 
       RowBox[{"u", "[", "2", "]"}], ",", 
       RowBox[{"u", "[", "3", "]"}], ",", 
       RowBox[{"u", "[", "4", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "M", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["L", "2"], "-", 
       RowBox[{"2", " ", "L", " ", "R"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["R", "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"L", "-", "R"}], ")"}], " ", "R", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
     SubsuperscriptBox["u", "1", "2"]}], "+", 
    SubsuperscriptBox["u", "3", "2"], "+", 
    SubsuperscriptBox["u", "4", "2"], "+", 
    RowBox[{"2", " ", 
     SubscriptBox["u", "1"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "R"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
        SubscriptBox["u", "3"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "L"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        SubscriptBox["u", "4"]}]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1112, 793},
WindowMargins->{{152, Automatic}, {27, Automatic}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 116, 3, 28, "Input"],
Cell[677, 25, 101, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[803, 31, 54, 0, 64, "Section"],
Cell[860, 33, 968, 27, 63, "Input"],
Cell[1831, 62, 264, 8, 46, "Input"],
Cell[2098, 72, 413, 13, 46, "Input"],
Cell[2514, 87, 313, 10, 28, "Input"],
Cell[CellGroupData[{
Cell[2852, 101, 201, 6, 28, "Input"],
Cell[3056, 109, 2546, 70, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5639, 184, 233, 8, 28, "Input"],
Cell[5875, 194, 2462, 69, 80, "Output"]
}, Open  ]],
Cell[8352, 266, 56, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[8433, 270, 159, 5, 28, "Input"],
Cell[8595, 277, 253, 8, 31, "Output"]
}, Open  ]],
Cell[8863, 288, 27, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[8915, 292, 218, 7, 28, "Input"],
Cell[9136, 301, 768, 24, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9941, 330, 591, 20, 28, "Input"],
Cell[10535, 352, 209, 7, 28, "Output"]
}, Open  ]],
Cell[10759, 362, 34, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[10818, 366, 379, 12, 28, "Input"],
Cell[11200, 380, 601, 23, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11838, 408, 336, 10, 28, "Input"],
Cell[12177, 420, 629, 23, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12843, 448, 142, 4, 28, "Input"],
Cell[12988, 454, 1119, 39, 32, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[14156, 499, 71, 0, 50, "Section"],
Cell[14230, 501, 1249, 35, 90, "Input"],
Cell[CellGroupData[{
Cell[15504, 540, 59, 1, 30, "Input"],
Cell[15566, 543, 196, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15799, 556, 59, 1, 30, "Input"],
Cell[15861, 559, 453, 19, 30, "Output"]
}, Open  ]],
Cell[16329, 581, 264, 8, 50, "Input"],
Cell[16596, 591, 350, 11, 30, "Input"],
Cell[16949, 604, 459, 13, 50, "Input"],
Cell[17411, 619, 313, 10, 30, "Input"],
Cell[CellGroupData[{
Cell[17749, 633, 201, 6, 30, "Input"],
Cell[17953, 641, 7217, 209, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25207, 855, 317, 10, 30, "Input"],
Cell[25527, 867, 7374, 212, 148, "Output"]
}, Open  ]],
Cell[32916, 1082, 56, 0, 33, "Text"],
Cell[CellGroupData[{
Cell[32997, 1086, 962, 29, 31, "Input"],
Cell[33962, 1117, 610, 20, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34609, 1142, 1088, 33, 31, "Input"],
Cell[35700, 1177, 390, 13, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36127, 1195, 1046, 32, 31, "Input"],
Cell[37176, 1229, 1370, 37, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38583, 1271, 160, 5, 30, "Input"],
Cell[38746, 1278, 1251, 35, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40034, 1318, 115, 3, 30, "Input"],
Cell[40152, 1323, 296, 13, 30, "Output"]
}, Open  ]],
Cell[40463, 1339, 27, 0, 33, "Text"],
Cell[CellGroupData[{
Cell[40515, 1343, 218, 7, 30, "Input"],
Cell[40736, 1352, 768, 24, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41541, 1381, 591, 20, 30, "Input"],
Cell[42135, 1403, 209, 7, 29, "Output"]
}, Open  ]],
Cell[42359, 1413, 34, 0, 33, "Text"],
Cell[CellGroupData[{
Cell[42418, 1417, 379, 12, 30, "Input"],
Cell[42800, 1431, 601, 23, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43438, 1459, 336, 10, 30, "Input"],
Cell[43777, 1471, 629, 23, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44443, 1499, 142, 4, 30, "Input"],
Cell[44588, 1505, 1119, 39, 30, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[45756, 1550, 103, 2, 50, "Section"],
Cell[45862, 1554, 14708, 186, 230, "Input",
 Evaluatable->False],
Cell[60573, 1742, 1576, 42, 170, "Input"],
Cell[62152, 1786, 139, 4, 30, "Input"],
Cell[62294, 1792, 719, 23, 50, "Input"],
Cell[63016, 1817, 459, 13, 50, "Input"],
Cell[CellGroupData[{
Cell[63500, 1834, 35, 0, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[63560, 1838, 1125, 37, 50, "Input"],
Cell[64688, 1877, 967, 34, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65692, 1916, 301, 9, 30, "Input"],
Cell[65996, 1927, 644, 21, 29, "Output"]
}, Open  ]],
Cell[66655, 1951, 50, 1, 30, "Input"],
Cell[66708, 1954, 313, 10, 30, "Input"],
Cell[67024, 1966, 201, 6, 30, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[67274, 1978, 67, 0, 50, "Section"],
Cell[CellGroupData[{
Cell[67366, 1982, 54, 0, 38, "Subsection"],
Cell[67423, 1984, 14708, 186, 230, "Input",
 Evaluatable->False],
Cell[82134, 2172, 2196, 64, 150, "Input"],
Cell[84333, 2238, 407, 13, 70, "Input"],
Cell[84743, 2253, 449, 14, 30, "Input"],
Cell[85195, 2269, 643, 19, 50, "Input"],
Cell[85841, 2290, 373, 12, 30, "Input"],
Cell[86217, 2304, 188, 6, 30, "Input"],
Cell[CellGroupData[{
Cell[86430, 2314, 112, 3, 30, "Input"],
Cell[86545, 2319, 11592, 338, 240, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98174, 2662, 57, 0, 29, "Subsubsection"],
Cell[98234, 2664, 538, 16, 30, "Input"],
Cell[CellGroupData[{
Cell[98797, 2684, 281, 9, 30, "Input"],
Cell[99081, 2695, 5973, 178, 130, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105103, 2879, 49, 0, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[105177, 2883, 463, 14, 30, "Input"],
Cell[105643, 2899, 1498, 49, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107178, 2953, 465, 14, 30, "Input"],
Cell[107646, 2969, 3430, 106, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111113, 3080, 63, 1, 30, "Input"],
Cell[111179, 3083, 1461, 47, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112677, 3135, 64, 1, 30, "Input"],
Cell[112744, 3138, 4594, 123, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117375, 3266, 123, 3, 30, "Input"],
Cell[117501, 3271, 316, 11, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117854, 3287, 90, 2, 30, "Input"],
Cell[117947, 3291, 938, 32, 29, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[118934, 3329, 61, 0, 43, "Subsubsection"],
Cell[118998, 3331, 63, 0, 33, "Text"],
Cell[CellGroupData[{
Cell[119086, 3335, 167, 5, 30, "Input"],
Cell[119256, 3342, 1043, 42, 43, "Output"]
}, Open  ]],
Cell[120314, 3387, 60, 0, 33, "Text"],
Cell[CellGroupData[{
Cell[120399, 3391, 222, 7, 30, "Input"],
Cell[120624, 3400, 645, 26, 43, "Output"]
}, Open  ]],
Cell[121284, 3429, 87, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[121396, 3435, 146, 4, 30, "Input"],
Cell[121545, 3441, 1307, 46, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122889, 3492, 191, 6, 30, "Input"],
Cell[123083, 3500, 683, 26, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123803, 3531, 156, 4, 30, "Input"],
Cell[123962, 3537, 812, 30, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124811, 3572, 191, 6, 30, "Input"],
Cell[125005, 3580, 471, 19, 32, "Output"]
}, Open  ]],
Cell[125491, 3602, 89, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[125605, 3608, 582, 18, 30, "Input"],
Cell[126190, 3628, 4254, 132, 86, "Output"]
}, Open  ]],
Cell[130459, 3763, 62, 0, 33, "Text"],
Cell[CellGroupData[{
Cell[130546, 3767, 245, 7, 30, "Input"],
Cell[130794, 3776, 1032, 35, 29, "Output"]
}, Open  ]],
Cell[131841, 3814, 100, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[131966, 3820, 265, 8, 30, "Input"],
Cell[132234, 3830, 641, 23, 29, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[132924, 3859, 31, 0, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[132980, 3863, 703, 22, 30, "Input"],
Cell[133686, 3887, 3609, 107, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137332, 3999, 517, 17, 30, "Input"],
Cell[137852, 4018, 1471, 44, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139360, 4067, 349, 10, 30, "Input"],
Cell[139712, 4079, 836, 28, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140585, 4112, 347, 10, 30, "Input"],
Cell[140935, 4124, 1105, 42, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142077, 4171, 347, 10, 30, "Input"],
Cell[142427, 4183, 552, 24, 30, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[143040, 4214, 54, 0, 30, "Subsection"],
Cell[143097, 4216, 14708, 186, 230, "Input",
 Evaluatable->False],
Cell[157808, 4404, 1725, 45, 110, "Input"],
Cell[159536, 4451, 407, 13, 70, "Input"],
Cell[159946, 4466, 643, 19, 50, "Input"],
Cell[160592, 4487, 373, 12, 30, "Input"],
Cell[CellGroupData[{
Cell[160990, 4503, 113, 3, 30, "Input"],
Cell[161106, 4508, 4821, 143, 86, "Output"]
}, Open  ]],
Cell[165942, 4654, 166, 5, 30, "Input"],
Cell[CellGroupData[{
Cell[166133, 4663, 63, 1, 30, "Input"],
Cell[166199, 4666, 2796, 88, 93, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169032, 4759, 64, 1, 30, "Input"],
Cell[169099, 4762, 2941, 83, 95, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[172077, 4850, 57, 0, 43, "Subsubsection"],
Cell[172137, 4852, 540, 16, 30, "Input"],
Cell[CellGroupData[{
Cell[172702, 4872, 283, 9, 30, "Input"],
Cell[172988, 4883, 3830, 112, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176855, 5000, 31, 0, 30, "Input"],
Cell[176889, 5002, 3830, 112, 67, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[180768, 5120, 49, 0, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[180842, 5124, 465, 14, 30, "Input"],
Cell[181310, 5140, 1128, 35, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182475, 5180, 467, 14, 30, "Input"],
Cell[182945, 5196, 1627, 49, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184609, 5250, 141, 3, 30, "Input"],
Cell[184753, 5255, 3189, 92, 81, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[187991, 5353, 62, 0, 43, "Subsubsection"],
Cell[188056, 5355, 87, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[188168, 5361, 873, 27, 30, "Input"],
Cell[189044, 5390, 2264, 78, 48, "Output"]
}, Open  ]],
Cell[191323, 5471, 58, 0, 33, "Text"],
Cell[CellGroupData[{
Cell[191406, 5475, 231, 7, 30, "Input"],
Cell[191640, 5484, 532, 18, 29, "Output"]
}, Open  ]],
Cell[192187, 5505, 75, 0, 33, "Text"],
Cell[CellGroupData[{
Cell[192287, 5509, 199, 6, 30, "Input"],
Cell[192489, 5517, 653, 23, 29, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[193191, 5546, 36, 0, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[193252, 5550, 391, 12, 30, "Input"],
Cell[193646, 5564, 248, 9, 29, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[193943, 5579, 31, 0, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[193999, 5583, 703, 22, 30, "Input"],
Cell[194705, 5607, 1541, 50, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[196283, 5662, 517, 17, 30, "Input"],
Cell[196803, 5681, 963, 31, 42, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[197827, 5719, 28, 0, 47, "Subsection"],
Cell[197858, 5721, 4715, 135, 130, "Input"],
Cell[202576, 5858, 229, 7, 30, "Input"],
Cell[CellGroupData[{
Cell[202830, 5869, 118, 3, 30, "Input"],
Cell[202951, 5874, 143, 3, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203131, 5882, 119, 3, 30, "Input"],
Cell[203253, 5887, 240, 5, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203530, 5897, 117, 3, 30, "Input"],
Cell[203650, 5902, 181, 4, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203868, 5911, 150, 5, 30, "Input"],
Cell[204021, 5918, 404, 9, 94, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204462, 5932, 690, 21, 50, "Input"],
Cell[205155, 5955, 2488, 56, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207680, 6016, 659, 21, 30, "Input"],
Cell[208342, 6039, 5969, 183, 124, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[214348, 6227, 426, 13, 27, "Input"],
Cell[214777, 6242, 2233, 71, 48, "Output"]
}, Open  ]],
Cell[217025, 6316, 117, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[217167, 6323, 714, 21, 50, "Input"],
Cell[CellGroupData[{
Cell[217906, 6348, 194, 2, 25, "Print"],
Cell[218103, 6352, 75, 0, 25, "Print"],
Cell[218181, 6354, 119, 1, 25, "Print"],
Cell[218303, 6357, 93, 1, 25, "Print"],
Cell[218399, 6360, 75, 0, 25, "Print"],
Cell[218477, 6362, 50, 0, 25, "Print"],
Cell[218530, 6364, 44, 0, 25, "Print"],
Cell[218577, 6366, 56, 0, 25, "Print"],
Cell[218636, 6368, 75, 0, 25, "Print"]
}, Open  ]]
}, Open  ]],
Cell[218738, 6372, 1330, 42, 70, "Input"],
Cell[CellGroupData[{
Cell[220093, 6418, 117, 3, 30, "Input"],
Cell[220213, 6423, 116, 3, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220366, 6431, 117, 3, 30, "Input"],
Cell[220486, 6436, 43, 0, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220566, 6441, 117, 3, 30, "Input"],
Cell[220686, 6446, 63, 0, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220786, 6451, 460, 14, 30, "Input"],
Cell[221249, 6467, 238, 5, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221524, 6477, 389, 12, 30, "Input"],
Cell[221916, 6491, 89, 2, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222042, 6498, 389, 12, 30, "Input"],
Cell[222434, 6512, 157, 3, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222628, 6520, 460, 14, 30, "Input"],
Cell[223091, 6536, 132, 3, 43, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[223272, 6545, 43, 0, 47, "Subsection"],
Cell[223318, 6547, 476, 13, 30, "Input"],
Cell[223797, 6562, 692, 21, 30, "Input"],
Cell[224492, 6585, 844, 25, 30, "Input"],
Cell[225339, 6612, 165, 5, 30, "Input"],
Cell[225507, 6619, 165, 5, 30, "Input"],
Cell[225675, 6626, 165, 5, 30, "Input"],
Cell[225843, 6633, 165, 5, 30, "Input"],
Cell[CellGroupData[{
Cell[226033, 6642, 624, 19, 30, "Input"],
Cell[226660, 6663, 1837, 55, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[228534, 6723, 689, 22, 30, "Input"],
Cell[229226, 6747, 2890, 93, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[232153, 6845, 671, 19, 30, "Input"],
Cell[232827, 6866, 2405, 79, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235269, 6950, 735, 20, 30, "Input"],
Cell[236007, 6972, 3147, 103, 86, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239191, 7080, 378, 12, 30, "Input"],
Cell[239572, 7094, 8069, 417, 186, 5386, 371, "GraphicsData", "PostScript", \
"Graphics"],
Cell[247644, 7513, 134, 4, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247815, 7522, 360, 11, 30, "Input"],
Cell[248178, 7535, 8106, 420, 186, 5393, 373, "GraphicsData", "PostScript", \
"Graphics"],
Cell[256287, 7957, 134, 4, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[256458, 7966, 56, 1, 30, "Input"],
Cell[256517, 7969, 368, 12, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[256922, 7986, 422, 13, 30, "Input"],
Cell[257347, 8001, 8819, 454, 186, 5900, 404, "GraphicsData", "PostScript", \
"Graphics"],
Cell[266169, 8457, 134, 4, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266340, 8466, 435, 13, 30, "Input"],
Cell[266778, 8481, 10799, 661, 186, 9455, 636, "GraphicsData", "PostScript", \
"Graphics"],
Cell[277580, 9144, 134, 4, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[277751, 9153, 304, 10, 30, "Input"],
Cell[278058, 9165, 2240, 70, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[280335, 9240, 363, 12, 30, "Input"],
Cell[280701, 9254, 1947, 62, 48, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[282709, 9323, 69, 0, 50, "Section"],
Cell[282781, 9325, 1741, 51, 110, "Input"],
Cell[284525, 9378, 407, 13, 70, "Input"],
Cell[284935, 9393, 413, 13, 50, "Input"],
Cell[285351, 9408, 313, 10, 30, "Input"],
Cell[CellGroupData[{
Cell[285689, 9422, 201, 6, 30, "Input"],
Cell[285893, 9430, 7353, 212, 153, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[293283, 9647, 233, 8, 30, "Input"],
Cell[293519, 9657, 6991, 211, 156, "Output"]
}, Open  ]],
Cell[300525, 9871, 56, 0, 33, "Text"],
Cell[CellGroupData[{
Cell[300606, 9875, 434, 13, 30, "Input"],
Cell[301043, 9890, 1028, 33, 29, "Output"]
}, Open  ]],
Cell[302086, 9926, 27, 0, 33, "Text"],
Cell[CellGroupData[{
Cell[302138, 9930, 447, 16, 30, "Input"],
Cell[302588, 9948, 1340, 43, 29, "Output"]
}, Open  ]],
Cell[303943, 9994, 94, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[304062, 10000, 118, 3, 30, "Input"],
Cell[304183, 10005, 253, 8, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[304473, 10018, 118, 3, 30, "Input"],
Cell[304594, 10023, 708, 24, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305339, 10052, 572, 19, 30, "Input"],
Cell[305914, 10073, 188, 6, 29, "Output"]
}, Open  ]],
Cell[306117, 10082, 34, 0, 33, "Text"],
Cell[CellGroupData[{
Cell[306176, 10086, 379, 12, 30, "Input"],
Cell[306558, 10100, 601, 23, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307196, 10128, 336, 10, 30, "Input"],
Cell[307535, 10140, 629, 23, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[308201, 10168, 142, 4, 30, "Input"],
Cell[308346, 10174, 1119, 39, 30, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[309514, 10219, 91, 2, 50, "Section"],
Cell[309608, 10223, 4545, 137, 350, "Input"],
Cell[CellGroupData[{
Cell[314178, 10364, 233, 8, 30, "Input"],
Cell[314414, 10374, 8553, 239, 252, "Output"]
}, Open  ]],
Cell[322982, 10616, 49, 0, 33, "Text"],
Cell[CellGroupData[{
Cell[323056, 10620, 377, 11, 30, "Input"],
Cell[323436, 10633, 1145, 36, 29, "Output"]
}, Open  ]],
Cell[324596, 10672, 27, 0, 33, "Text"],
Cell[CellGroupData[{
Cell[324648, 10676, 968, 29, 30, "Input"],
Cell[325619, 10707, 1386, 44, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[327042, 10756, 276, 8, 30, "Input"],
Cell[327321, 10766, 657, 20, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328015, 10791, 271, 8, 30, "Input"],
Cell[328289, 10801, 653, 20, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328979, 10826, 274, 8, 30, "Input"],
Cell[329256, 10836, 2750, 85, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[332043, 10926, 28, 0, 30, "Input"],
Cell[332074, 10928, 1042, 35, 29, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[333165, 10969, 129, 3, 85, "Section"],
Cell[333297, 10974, 406, 7, 68, "Text"],
Cell[CellGroupData[{
Cell[333728, 10985, 79, 0, 35, "Subsubsection"],
Cell[333810, 10987, 253, 7, 28, "Input"],
Cell[334066, 10996, 417, 13, 28, "Input"],
Cell[334486, 11011, 132, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[334643, 11018, 838, 26, 28, "Input"],
Cell[335484, 11046, 1573, 53, 48, "Output"]
}, Open  ]],
Cell[337072, 11102, 86, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[337183, 11108, 647, 21, 28, "Input"],
Cell[337833, 11131, 405, 14, 32, "Output"]
}, Open  ]],
Cell[338253, 11148, 127, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[338405, 11155, 837, 26, 28, "Input"],
Cell[339245, 11183, 1639, 56, 48, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[340933, 11245, 75, 0, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[341033, 11249, 397, 13, 28, "Input"],
Cell[341433, 11264, 678, 24, 28, "Output"]
}, Open  ]],
Cell[342126, 11291, 619, 9, 87, "Text"],
Cell[CellGroupData[{
Cell[342770, 11304, 1013, 31, 46, "Input"],
Cell[343786, 11337, 372, 13, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[344195, 11355, 467, 15, 28, "Input"],
Cell[344665, 11372, 752, 26, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[345466, 11404, 73, 0, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[345564, 11408, 437, 14, 28, "Input"],
Cell[346004, 11424, 707, 25, 35, "Output"]
}, Open  ]],
Cell[346726, 11452, 44, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[346795, 11456, 1008, 31, 46, "Input"],
Cell[347806, 11489, 990, 34, 28, "Output"]
}, Open  ]],
Cell[348811, 11526, 35, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[348871, 11530, 652, 21, 28, "Input"],
Cell[349526, 11553, 659, 23, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[350234, 11582, 106, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[350365, 11588, 303, 10, 28, "Input"],
Cell[350671, 11600, 739, 26, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[351447, 11631, 303, 10, 28, "Input"],
Cell[351753, 11643, 598, 21, 28, "Output"]
}, Open  ]],
Cell[352366, 11667, 147, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[352538, 11674, 840, 27, 28, "Input"],
Cell[353381, 11703, 914, 32, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[354332, 11740, 797, 25, 28, "Input"],
Cell[355132, 11767, 883, 31, 28, "Output"]
}, Open  ]],
Cell[356030, 11801, 35, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[356090, 11805, 438, 15, 28, "Input"],
Cell[356531, 11822, 672, 24, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[357240, 11851, 438, 15, 28, "Input"],
Cell[357681, 11868, 616, 22, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[358346, 11896, 139, 3, 35, "Subsubsection"],
Cell[358488, 11901, 279, 9, 28, "Input"],
Cell[CellGroupData[{
Cell[358792, 11914, 749, 24, 28, "Input"],
Cell[359544, 11940, 398, 12, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[359979, 11957, 749, 24, 28, "Input"],
Cell[360731, 11983, 3662, 111, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364430, 12099, 750, 24, 28, "Input"],
Cell[365183, 12125, 1312, 41, 47, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[366556, 12173, 215, 4, 85, "Section"],
Cell[366774, 12179, 406, 7, 68, "Text"],
Cell[CellGroupData[{
Cell[367205, 12190, 79, 0, 35, "Subsubsection"],
Cell[367287, 12192, 253, 7, 28, "Input"],
Cell[367543, 12201, 417, 13, 28, "Input"],
Cell[367963, 12216, 132, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[368120, 12223, 838, 26, 28, "Input"],
Cell[368961, 12251, 1573, 53, 48, "Output"]
}, Open  ]],
Cell[370549, 12307, 86, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[370660, 12313, 647, 21, 28, "Input"],
Cell[371310, 12336, 405, 14, 32, "Output"]
}, Open  ]],
Cell[371730, 12353, 127, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[371882, 12360, 837, 26, 28, "Input"],
Cell[372722, 12388, 1639, 56, 48, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[374410, 12450, 75, 0, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[374510, 12454, 397, 13, 28, "Input"],
Cell[374910, 12469, 678, 24, 28, "Output"]
}, Open  ]],
Cell[375603, 12496, 619, 9, 87, "Text"],
Cell[CellGroupData[{
Cell[376247, 12509, 1013, 31, 46, "Input"],
Cell[377263, 12542, 372, 13, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[377672, 12560, 467, 15, 28, "Input"],
Cell[378142, 12577, 752, 26, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[378943, 12609, 73, 0, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[379041, 12613, 437, 14, 28, "Input"],
Cell[379481, 12629, 707, 25, 35, "Output"]
}, Open  ]],
Cell[380203, 12657, 44, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[380272, 12661, 1008, 31, 46, "Input"],
Cell[381283, 12694, 990, 34, 28, "Output"]
}, Open  ]],
Cell[382288, 12731, 35, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[382348, 12735, 652, 21, 28, "Input"],
Cell[383003, 12758, 659, 23, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[383711, 12787, 106, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[383842, 12793, 303, 10, 28, "Input"],
Cell[384148, 12805, 739, 26, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[384924, 12836, 303, 10, 28, "Input"],
Cell[385230, 12848, 598, 21, 28, "Output"]
}, Open  ]],
Cell[385843, 12872, 147, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[386015, 12879, 840, 27, 28, "Input"],
Cell[386858, 12908, 914, 32, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[387809, 12945, 797, 25, 28, "Input"],
Cell[388609, 12972, 883, 31, 28, "Output"]
}, Open  ]],
Cell[389507, 13006, 35, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[389567, 13010, 438, 15, 28, "Input"],
Cell[390008, 13027, 672, 24, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[390717, 13056, 438, 15, 28, "Input"],
Cell[391158, 13073, 616, 22, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[391823, 13101, 139, 3, 35, "Subsubsection"],
Cell[391965, 13106, 279, 9, 28, "Input"],
Cell[CellGroupData[{
Cell[392269, 13119, 749, 24, 28, "Input"],
Cell[393021, 13145, 398, 12, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[393456, 13162, 749, 24, 28, "Input"],
Cell[394208, 13188, 3662, 111, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[397907, 13304, 750, 24, 28, "Input"],
Cell[398660, 13330, 1312, 41, 47, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

